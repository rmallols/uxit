/* Minified js files! 2014-01-23 */
COMPONENTS.controller("ErrorCtrl",["$scope","$routeParams","i18nService",function(a,b,c){"use strict";a.errorTitle=c(b.title,b.targetId),a.showPortalHomeButton="true"===b.showPortalHomeButton,a.goToPortalHome=function(){location.href=b.portalId}}]),COMPONENTS.controller("LoginCtrl",["$scope","$routeParams","globalMsgService",function(a,b,c){"use strict";a.error=b.error,b.error&&c.show("Invalid credentials")}]),COMPONENTS.controller("PortalCtrl",["$scope","portalService","roleService","sessionService",function(a,b,c,d){"use strict";a.isAdmin=function(){return c.hasAdminRole(d.getUserSession())},b.initializeResources()}]),function(){"use strict";COMPONENTS.directive("addAppPanel",["$rootScope","availableAppsService","undeployService","constantsService","addAppService","statsService","keyboardService",function(a,b,c,d,e,f,g){return{restrict:"E",transclude:!0,templateUrl:"addAppPanel.html",replace:!0,link:function(e,h){function i(){g.register(["tab","down"],m,function(){j=j<e.availableApps.model.length-1?j+1:0,e.$apply()}),g.register(["shift+tab","up"],m,function(){j=j>0?j-1:e.availableApps.model.length-1,e.$apply()}),g.register("enter",m,function(){e.showExpandedView(e.availableApps.model[j])})}var j=0,k="collapsed",l="expanded",m="addAppPanel";e.showExpandedView=function(a){function b(){var a={cond:{targetId:e.highlight._id}};f.loadStats(d.collections.comments,a,function(a){e.highlight.stats=a})}e.onAddedComment=function(){b()},e.highlight=a,e.highlight.collection=d.collections.availableApps,e.isExpandedViewVisible=!0,h.attr("state",l),b()},e.hideExpandedView=function(){e.highlight=null,e.isExpandedViewVisible=!1,h.attr("state",k)},e.toggleExpandedView=function(a){e.highlight&&e.highlight.id===a.id?e.hideExpandedView():e.showExpandedView(a)},e.getBlockStyleClass=function(a){return h.attr("state")===l&&e.highlight&&a===e.highlight.id?"highlight":""},e.getAppClasses=function(a){return a===j?"hoverState":""},e.undeploy=function(){c.undeploy(e.highlight),e.hideExpandedView(),b.loadAvailableApps(function(a){e.availableApps=a})},e.onAvailableAppDeployed=function(){b.loadAvailableApps(function(a){e.availableApps=a})},e.collection=d.collections.comments,e.availableApps=b.getAvailableApps(),e.availableApps||a.$on("availableAppsLoaded",function(){e.availableApps=b.getAvailableApps()}),i()}}}])}(),function(){"use strict";COMPONENTS.directive("adminPanel",["$rootScope","$location","portalService","addAppService","mediaService","sessionService","keyboardService","$timeout",function(a,b,c,d,e,f,g,h){return{restrict:"E",transclude:!0,templateUrl:"adminPanel.html",replace:!0,scope:{},link:function(i,j){function k(a){a!==t?m(a):(n(),o())}function l(){n(),d.toggleAddAppPanel(),d.isAddAppPanelActive()?g.register("esc",v,function(){d.hideAddAppPanel(),o(),i.$apply()}):o()}function m(a){t=a,j.removeClass("hide").addClass("show"),d.isAddAppPanelActive()&&d.hideAddAppPanel(),b.search({}),p()}function n(){t=null,j.removeClass("show").addClass("hide"),q()}function o(){h(function(){i.activeTab.current=-1},0)}function p(){g.register("ctrl+a",v,function(){i.activeTab.current=0,l(),i.$apply()}),g.register("ctrl+enter",v,function(){i.onSave(),i.$apply()}),g.register("esc",v,function(){i.onCancel(),i.$apply()})}function q(){g.unregister("ctrl+a",v),g.unregister("ctrl+enter",v),g.unregister("esc",v)}function r(){i.panels=[],s("addApp","addIcon",l),s("editGeneral","settingsIcon",k),s("editStyles","stylesIcon",k),s("editContentList","contentIcon hideEditedMark",k),s("editUserList","userIcon hideEditedMark",k),s("editMediaList","mediaIcon hideEditedMark",k),s("editPages","pageIcon",k),s("editTagList","tagsIcon hideEditedMark",k),s("editNotifications","notificationsIcon",k),s("stats","statsIcon",k),s("editCurrentUser","currentUser",k,u)}function s(a,b,c,d){var e="adminPanel.",f=e+a,g=f+".desc",h={model:i.portal};i.panels.push({title:f,description:g,src:a,ngClass:b,ngStyleFn:d,onTabClicked:c,bindings:h})}var t,u,v="adminPanel",w=f.getUserSession();i.activeTab={current:"-1"},u=function(){var a;return w?(a=e.getDownloadUrl(w.media),{backgroundImage:'url("'+a+'")'}):null},a.$on("portalLoaded",function(){i.portal=c.getPortal(),r()}),o(),i.onCancel=function(){n(),o()},i.onSave=function(){c.updatePortal(!0,function(){n(),o()})}}}}])}(),COMPONENTS.directive("createContent",["tagService",function(a){"use strict";return{restrict:"A",replace:!0,templateUrl:"editContent.html",scope:{content:"=model"},link:function(b){b.availableTags=a.getTags()}}}]),COMPONENTS.directive("createMedia",["tagService",function(a){"use strict";return{restrict:"A",replace:!0,templateUrl:"createMedia.html",scope:{media:"=model"},link:function(b){b.multipleFilesUploaded=!1,b.media=[],b.availableTags=a.getTags(),b.onUpload=function(a){b.multipleFilesUploaded=a.length>1,b.media=a},b.getMultipleFilesUploadedNames=function(){var a="";return b.multipleFilesUploaded&&b.media.forEach(function(b){a+=b.name+", "}),a}}}}]),function(){"use strict";function a(){return{restrict:"A",replace:!1,templateUrl:"editTag.html",scope:{tag:"=model"}}}var b=[a];COMPONENTS.directive("createTag",b),COMPONENTS.directive("createTags",b)}(),function(){"use strict";function a(a,b,c,d){return{restrict:"A",replace:!0,templateUrl:"editUser.html",scope:{user:"=",onLayer:"="},link:function(e){function f(){e.user.role=1,e.user.language=e.languages[0].code}e.availableTags=c.getTags(),e.roles=b.getRoles(),e.languages=d.getLanguages(),e.defaultAvatarUrl=a.getDefaultAvatarUrl(),e.languages=$.extend(!0,[],d.getLanguages()),e.languages.unshift({code:"",text:d("editUser.language.inheritBrowser")}),f()}}}var b=["mediaService","roleService","tagService","i18nService",a];COMPONENTS.directive("createUser",b),COMPONENTS.directive("createUsers",b)}(),function(){"use strict";COMPONENTS.directive("edit",["$compile","validationService","keyboardService","stringService","objectService",function(a,b,c,d,e){return{restrict:"E",transclude:!0,templateUrl:"edit.html",replace:!0,scope:{panels:"=",activeTab:"=",limitLayerHeight:"@",onSave:"&",onChange:"&",onCancel:"&"},link:function(f,g,h){function i(){var a=0;f.panels.forEach(function(b){b.onLayer.save(function(){a+=1,a===f.panels.length&&f.onSave()})})}function j(){z.forEach(function(a){a.$dirty=!1,a.$pristine=!0})}function k(){f.panels.forEach(function(a){a.type=a.src+(a.view?d.capitalize(a.view):"")})}function l(){f.panels.forEach(function(a,b){x[b]={},$.extend(!0,x[b],a.bindings)})}function m(){var a=$(" > .actions",g);setTimeout(function(){a.length&&a.offset().top<0&&a.css("top",0)},0)}function n(){f.panels.forEach(function(a,b){a.bindings=x[b]})}function o(){f.panels.forEach(function(a){z.push(f[a.type])})}function p(){c.register("left",w,function(){var a=f.activeTab.current>0?f.activeTab.current-1:f.panels.length-1;f.clickTab(a),f.$apply()}),c.register("right",w,function(){var a=f.activeTab.current<f.panels.length-1?f.activeTab.current+1:0;f.clickTab(a),f.$apply()})}function q(){var a="scrolling";g.addClass(a),setTimeout(function(){g.removeClass(a)},window.speed)}function r(b){var c,d;b.onLayer||(b.onLayer={}),b.onLayer.save=function(a){a()},c=s(b,y),d=a(c)(f),b.active&&(f.activePanel=b),A.append(d),y+=1}function s(a,b){var c,e;return e=t(a,b),a.appBridge?(c="app-bridge",u(e,a,b)):(c=d.toSnakeCase(a.type),v(e,a,b)),e.attr(c,""),e.wrap('<li class="layer" ng-form name="'+a.type+'"></li>'),e.parent()}function t(a,b){return $('<div id="'+a.type+f.$id+'" on-layer="panels['+b+'].onLayer" on-cancel="onCancel()" on-change="onChange()" ux-show="isLayerShown('+b+')" persist="true" ng-style="getLayerHeight()" config="panels['+b+'].config"></div>')}function u(a,b,c){a.attr("src",b.src),a.attr("view",b.view),a.attr("bindings","panels["+c+"].bindings")}function v(a,b,c){var f,g,h;b.bindings&&(f=e.getRootKeys(b.bindings),f.forEach(function(b){g=d.toSnakeCase(b),h="panels["+c+"].bindings."+b,a.attr(g,h)}))}var w="edit"+(h.type?"-"+h.type:""),x=[],y=0,z=[],A=$("> .content.level1 > ul",g);f.showIfMultipleTabs=function(){return f.panels.length>1},f.getLayerHeight=function(){return f.limitLayerHeight?{height:.5*$(window).height()}:null},f.cancel=function(){n(),f.onCancel&&f.onCancel(),o(),j()},f.save=function(){o(),b.isFormValid(z)&&f.onSave?(i(),l(),j()):b.setFocusOnFirstError(g)},f.clickTab=function(a){f.activeTab.current=a,f.panels[a].onTabClicked&&f.panels[a].onTabClicked(a),A.css("margin-left","-"+100*a+"%"),q()},f.getTabClasses=function(a,b){return b===f.activeTab.current?"active "+a.ngClass:a.ngClass},f.isLayerShown=function(a){return a===f.activeTab.current},f.isEditedMarkVisible=function(a){return f.activeTab.current>=0&&a.$dirty},f.getEditedMarkColor=function(a){return a.$valid?"valid":"invalid"},k(),l(),m(),f.$watch("panels",function(){f.tabHeight=100/f.panels.length,f.panels[0].active=!0,angular.forEach(f.panels,function(a){r(a)})}),p()}}}])}(),COMPONENTS.directive("editAppGeneral",["i18nService",function(){"use strict";return{restrict:"A",replace:!0,templateUrl:"editAppGeneral.html",scope:{model:"=",onLayer:"="}}}]),COMPONENTS.directive("editAppStyles",[function(){"use strict";return{restrict:"A",replace:!0,templateUrl:"editAppStyles.html",scope:{model:"=",onLayer:"="}}}]),function(){"use strict";COMPONENTS.directive("editBox",["$timeout","editBoxUtilsService","pageService","keyboardService",function(a,b,c,d){return{restrict:"E",transclude:!0,templateUrl:"editBox.html",replace:!0,scope:{model:"=",internalData:"=",panels:"=",target:"=",arrowPos:"=",onSave:"&",onChange:"&",onCancel:"&",onClose:"&"},link:function(e,f){function g(){d.register("ctrl+enter",l,function(){e.save(),e.$apply()}),d.register("esc",l,function(){e.cancel(),e.$apply()})}function h(){d.unregister("esc",l),d.unregister("left","edit"),d.unregister("right","edit")}function i(){b.hideEditBox(e.target.id),h()}var j,k={top:"top",right:"right",bottom:"bottom",left:"left"},l="editBox",m=c.getMainScrollingElm(),n=parseInt(m.css("margin-left"),10),o=$(" > .arrow",f).width()/2;a(function(){j=$(".actions",f).outerHeight()}),e.activeTab={current:0},e.getStyles=function(){var a=e.target.coordinates.top+e.target.coordinates.height/2+j,b=e.arrowPos===k.left?e.target.coordinates.width+e.target.coordinates.left-n+o:-(f.width()+o)+e.target.coordinates.left-n;return{top:a,left:b>0?b:0}},e.change=function(){e.onChange&&e.onChange()},e.save=function(){i(),e.onSave&&e.onSave(e.model,e.$id),e.onClose&&e.onClose()},e.cancel=function(){i(),e.onCancel&&e.onCancel(),e.onClose&&e.onClose()},g()}}}])}(),COMPONENTS.directive("editContent",["contentService","tagService",function(a,b){"use strict";return{restrict:"A",replace:!1,templateUrl:"editContent.html",scope:{content:"=model",onLayer:"="},link:function(c){c.availableTags=b.getTags(),c.onLayer.save=function(b){a.updateContent(c.content,function(){b()})}}}}]),COMPONENTS.directive("editContentList",[function(){"use strict";return{restrict:"A",replace:!1,templateUrl:"editContentList.html",scope:{},controller:["$scope",function(a){a.config={editable:!0,selectable:!0,multiSelectable:!0,deletable:!0,creatable:!0}}]}}]),COMPONENTS.directive("editCurrentUser",["$rootScope","userService","sessionService",function(a,b,c){"use strict";return{restrict:"A",replace:!1,templateUrl:"editCurrentUser.html",scope:{model:"=",onLayer:"="},link:function(a){a.userSession=c.getUserSession(),a.onLayer.save=function(c){b.updateUser(a.userSession,function(){c()})},a.logout=function(){c.logout()}}}}]),function(a){"use strict";a.directive("editGeneral",["$location","portalService","mediaService","metaService","globalMsgService","i18nService",function(a,b,c,d,e,f){return{restrict:"A",replace:!0,templateUrl:"editGeneral.html",scope:{model:"="},link:function(a){a.$watch("model.title",function(){b.setHeader()}),a.level2Tabs=[{title:"editGeneral.general",styleClass:"settingsIcon"},{title:"editGeneral.app",styleClass:"appIcon"},{title:"editGeneral.languages",styleClass:"languagesIcon"},{title:"editGeneral.comments",styleClass:"commentsIcon"},{title:"editGeneral.email",styleClass:"notificationsIcon"},{title:"editGeneral.analytics",styleClass:"statsIcon"},{title:"editGeneral.migration",styleClass:"migrationIcon"}],a.defaultFaviconUrl=d.getDefaultFaviconUrl(),c.getMedia(a.model.faviconId,null,function(b){a.favicon=b}),a.updateFavicon=function(b){a.model.faviconId=b[0]._id},a.onImportedPortal=function(){b.initializeResources(),e.show(f("editGeneral.migration.import.success"),null,1)}}}}])}(window.COMPONENTS),COMPONENTS.directive("editLanguage",["i18nService",function(a){"use strict";return{restrict:"A",replace:!1,templateUrl:"editLanguage.html",scope:{language:"=model",onLayer:"="},link:function(b){b.onLayer.save=function(c){a.updateLanguage(b.language,function(a){c(a)})}}}}]),COMPONENTS.directive("editMedia",["mediaService","tagService",function(a,b){"use strict";return{restrict:"A",replace:!0,templateUrl:"editMedia.html",scope:{media:"=model",onLayer:"="},link:function(c){c.availableTags=b.getTags(),c.onLayer.save=function(b){a.updateMedia(c.media,function(){b()})},c.onUpload=function(a){c.media.name="",setTimeout(function(){c.media.name=a[0].name,c.$apply()},0)}}}}]),COMPONENTS.directive("editMediaList",[function(){"use strict";return{restrict:"A",replace:!1,templateUrl:"editMediaList.html",scope:{},controller:["$scope",function(a){a.config={editable:!0,selectable:!0,multiSelectable:!0,uploadable:!0,deletable:!0,creatable:!0}}]}}]),function(a){"use strict";a.directive("editNotifications",["emailService","stdService","userService","liveMessageService",function(a,b,c,d){return{restrict:"A",replace:!0,templateUrl:"editNotifications.html",scope:{model:"=",onLayer:"="},link:function(e){function f(c){if(e.model.notifications.email&&e.model.notifications.email.subject&&e.model.notifications.email.text&&e.model.notifications.email.selectedUsers.length>0){var d={subject:e.model.notifications.email.subject,text:e.model.notifications.email.text,to:e.model.notifications.email.selectedUsers.join(",")};a.sendEmail(d,function(a){a?c():b.error("There was an error sending the e-mail")})}c()}function g(a){if(e.model.notifications.liveMessage&&e.model.notifications.liveMessage.subject&&e.model.notifications.liveMessage.text){var c={text:e.model.notifications.liveMessage.subject,details:e.model.notifications.liveMessage.text};d.sendPublicMessage(c,function(c){c?a():b.error("There was an error sending the live message")})}a()}e.usersList=c.getUsers(),e.level2Tabs=[{title:"editNotifications.email",styleClass:"notificationsIcon"},{title:"editNotifications.liveMessage",styleClass:"infoIcon"}],e.onLayer.save=function(a){f(function(){g(function(){e.model.notifications={},a()})})}}}}])}(window.COMPONENTS),function(a){"use strict";a.directive("editPages",["$rootScope","$routeParams","$location","portalService","pageService","validationService","$timeout","stringService","timerService","stdService","arrayService","constantsService","i18nService","i18nDbService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){return{restrict:"A",replace:!0,templateUrl:"editPages.html",scope:{onLayer:"="},link:function(a){function d(){var b,c=e.getCurrentPage();for(b=0;b<a.pages.length&&a.pages[b]._id!==c._id;b+=1);return b}function f(b){function c(){j+=1,j===a.pages.length&&b()}function d(a){i(a),c()}function f(a,b){delete a.added,e.createPage(a,function(){d(b)})}function g(a,b){delete a.deleted,e.deletePage(b._id,function(){d(b)})}function h(a,b){delete a.updated,e.updatePage(b._id,a,function(){d(b)})}function i(b){var c=b?b.items:a.items;c.forEach(function(a){var c=$.extend(!0,{},a);c.parentPageId=b?b._id:null,delete c.areSubItemsHidden,delete c._id,delete c.items,c.added?f(c,a):c.deleted?g(c,a):c.updated?h(c,a):d(a)})}var j=0;i(null)}a.registerSelectedPageChange=function(){a.selectedPage&&(a.selectedPage.updated=!0)},a.onAddPage=function(b){b.type=a.pageTypes[0].id},a.onLayer.save=function(e){f(function(){var f=d();c.path(b.portal+"/"+a.pages[f].url),e()})},a.pageTypes=[{id:l.pageTypes.apps,text:l.pageTypes.apps},{id:l.pageTypes.externalLink,text:l.pageTypes.externalLink}],a.targets=[{id:"_blank",text:m("editPages.target.newTab")},{id:"_self",text:m("editPages.target.sameTab")}],a.level2Tabs=[{title:"General"},{title:"Section 2"},{title:"Section 3"}]}}}])}(window.COMPONENTS),COMPONENTS.directive("editStyles",[function(){"use strict";return{restrict:"A",replace:!0,templateUrl:"editStyles.html",scope:{model:"=",onLayer:"="},link:function(a){a.level2Tabs=[{title:"editStyles.portal",styleClass:"webIcon"},{title:"editStyles.app",styleClass:"appIcon"}]}}}]),COMPONENTS.directive("editTag",["tagService",function(a){"use strict";return{restrict:"A",replace:!1,templateUrl:"editTag.html",scope:{tag:"=model",onLayer:"="},link:function(b){b.onLayer.save=function(c){a.updateTag(b.tag,function(){c()})}}}}]),COMPONENTS.directive("editTagList",[function(){"use strict";return{restrict:"A",replace:!1,templateUrl:"editTagList.html",scope:{},controller:["$scope",function(a){a.config={editable:!0,selectable:!0,multiSelectable:!0,deletable:!0,creatable:!0}}]}}]),COMPONENTS.directive("editUser",["$routeParams","userService","mediaService","tagService","roleService","i18nService",function(a,b,c,d,e,f){"use strict";return{restrict:"A",replace:!1,templateUrl:"editUser.html",scope:{user:"=model",onLayer:"="},link:function(a){a.availableTags=d.getTags(),a.roles=e.getRoles(),a.languages=$.extend(!0,[],f.getLanguages()),a.languages.unshift({code:"",text:f("editUser.language.inheritBrowser")}),a.clickToChangePassword=!0,a.defaultAvatarUrl=c.getDefaultAvatarUrl(),a.user&&(a.user.media||(a.user.media={})),a.onLayer.save=function(c){b.updateUser(a.user,function(a){c(a)})}}}}]),COMPONENTS.directive("editUserList",[function(){"use strict";return{restrict:"A",replace:!1,templateUrl:"editUserList.html",scope:{},controller:["$scope",function(a){a.config={editable:!0,selectable:!0,multiSelectable:!0,deletable:!0,creatable:!0}}]}}]),COMPONENTS.directive("stats",["$rootScope","statsService","roleService","constantsService",function(a,b,c,d){"use strict";return{restrict:"A",replace:!1,templateUrl:"stats.html",scope:{},link:function(a){function e(a){a.forEach(function(a){a["create.date"]||(a["create.date"]="2013-04-01T22:00:00.000Z")})}function f(a){var b=[];return a.forEach(function(a){f.create&&b.push({label:a.create.author?a.create.author.fullName:void 0,value:a.count})}),b}function g(a){var b,d=[];return a.forEach(function(a){b=c.getRole(a.role),d.push({label:b?b.title:"undefined",value:a.count})}),d}var h;b.loadStats(d.collections.content,{},function(b){e(b),a.newsPerDay=b}),b.loadStats(d.collections.users,{},function(b){e(b),a.usersPerDay=b}),h={groupBy:"create.authorId"},b.loadStats(d.collections.content,h,function(b){a.contentPerUser=f(b)}),h={groupBy:"role"},b.loadStats(d.collections.users,h,function(b){a.usersPerRole=g(b)}),h={groupBy:"create.authorId"},b.loadStats(d.collections.comments,h,function(b){a.commentsPerUser=f(b)})}}}]),COMPONENTS.directive("styles",["mediaService","i18nService","constantsService",function(a,b,c){"use strict";return{restrict:"A",replace:!0,templateUrl:"styles.html",scope:{model:"=styles",target:"@"},controller:["$scope",function(a){a.aligns={vertical:[{id:"top",text:b("position.vertical.top")},{id:"center",text:b("position.vertical.center")},{id:"bottom",text:b("position.vertical.bottom")}],horizontal:[{id:"left",text:b("position.horizontal.left")},{id:"center",text:b("position.horizontal.center")},{id:"right",text:b("position.horizontal.right")}]}}],link:function(b){b.isPortalTarget=function(){return b.target===c.stylesTarget.portal},b.isAppTarget=function(){return b.target===c.stylesTarget.app},b.changeLogoId=function(a){a?b.model.logoId=a._id:delete b.model.logoId},b.model&&b.model.logoId&&a.getMedia(b.model.logoId,null,function(a){b.logo=a})}}}]),COMPONENTS.directive("verticalTabs",[function(){"use strict";return{restrict:"A",replace:!0,transclude:!0,template:'<ul class="tabs level2"><li class="tabButton {{tab.styleClass}}" ng-repeat="tab in tabs" ng-class="isCurrentLayer($index)" ng-click="setCurrentLayer($index)"><label i18n="{{tab.title}}"></label></li></ul>',scope:{tabs:"=verticalTabs"},link:function(a){a.isCurrentLayer=function(b){return b===a.activePanel?"active":null},a.setCurrentLayer=function(b){a.activePanel=b,$(".content.level2 > ul").css("top","-"+100*b+"%")},a.activePanel=0}}}]),function(){"use strict";COMPONENTS.directive("app",["$rootScope","$compile","portalService","styleService","appService","availableAppsService","constantsService","stringService","roleService",function(a,b,c,d,e,f,g,h,i){return{restrict:"A",replace:!0,templateUrl:"app.html",scope:{_id:"=app",type:"=",model:"=",width:"=",templateApp:"@"},controller:["$scope",function(a){a.view="view",a.bindings={},a.onEvent={},a.internalData={}}],link:function(b,j){function k(){var a;a=f.getAvailableApps(),b.appInfo=l(a,b.type),!b.model&&b.appInfo&&(b.model=b.appInfo.defaultModel||{}),m()}function l(a,b){return a?$.extend(!0,{},a.model[a.index[b]]):null}function m(){b.bindings.model=b.model,b.bindings.internalData=b.internalData}var n=!1;j.addClass(b.type),b.getAppStyles=function(){var a=c.getPortal();if(b.model&&a){var e=d.getNormalizedStyles(a.app.styles,null);return e=d.getNormalizedStyles(b.model.styles,e)}return null},b.getAppAlignment=function(){var a,c,d={};return b.model&&b.model.styles&&b.model.styles.align&&(a="alignHorizontally"+h.capitalize(b.model.styles.align.horizontal),c="alignVertically"+h.capitalize(b.model.styles.align.vertical),d[a]=!0,d[c]=!0),d},b.isTitleVisible=function(){var a=c.getPortal();return b.model&&void 0!==b.model.showTitle?b.model.showTitle:a.app?a.app.showTitle:!1},b.removeApp=function(){j.hide("explode",{direction:"horizontal"},window.speed,function(){e.isFullscreen()&&e.disableFullscreen(j,b.onEvent.resize),e.deleteApp(j,b.$parent.$index),$(this).remove()})},b.getAppStyleClasses=function(){var a={};return a[b.type]=!0,a[i.getCurrentUserAdminAccessStyleClass()]=!0,b.model&&b.model.styles&&b.model.styles.height&&(a.fixedHeight=!0),a},b.getCurrentUserAdminAccessStyleClass=function(){return i.getCurrentUserAdminAccessStyleClass()},b.$watch("type",function(a){a&&k()}),b.$watch("width",function(a){a&&(n?e.triggerOnResizeEvent(b.onEvent.resize):n=!0)}),a.$on(g.collections.availableApps+"Undeployed",function(a,c){c===b.type&&b.removeApp()}),j.mouseenter(function(){j.addClass("hover")}),j.mouseleave(function(){j.removeClass("hover")})}}}])}(),function(){"use strict";COMPONENTS.directive("appBridge",["$injector","$compile","$timeout","$templateCache","objectService","stringService",function(a,b,c,d,e,f){return{restrict:"A",replace:!0,scope:{bindings:"=",config:"=",onLayer:"=",onEvent:"=",src:"@",view:"@"},link:function(g,h){function i(){q.internalData=g.internalData,q.model=g.model,q.onLayer=g.onLayer,q.src=g.src,q.view=g.view,q.onEvent=g.onEvent,j(q,g.bindings)}function j(a,b){var c;b&&(c=e.getRootKeys(b),c.forEach(function(b){a[b]=g.bindings[b]}))}function k(a,b){var c=l(a,b);m(a,b,c)}function l(a,c){var e=a+f.capitalize(c),g=$(d.get(a+f.capitalize(c)+".html"));return h.html(g),h.addClass(e),b(g)(q),g}function m(b,c,d){var e=a.get(b+"Service");o(e,c,d),n(e,c),p(e,d)}function n(a,b){var c="on"+f.capitalize(b)+"Save";q.onLayer&&q.onLayer.save&&a[c]&&(q.onLayer.save=function(b){a[c](q,function(){b()})})}function o(a,b,c){a[b]&&a[b](q,c)}function p(a,b){q.onEvent&&(q.onEvent.resize=function(){var c="onResize";a[c]&&a[c](q,b)})}var q;g.$watch("src",function(a){a&&(q=g.$new(!0),c(function(){i(),q.src&&q.view&&k(q.src,q.view)}))})}}}])}(),function(){"use strict";COMPONENTS.directive("appHeader",["$rootScope","$location","appService","portalService","pageService","roleService","sessionService","stringService","editBoxUtilsService",function(a,b,c,d,e,f,g,h,i){return{restrict:"A",replace:!0,templateUrl:"appHeader.html",link:function(h,j){function k(){return h.appInfo.editPanels?m():l()}function l(){var a=[];return h.appInfo.noCustomEditPanel||a.push({title:"Edit",appBridge:!0,src:h.type,view:"edit"}),a.push({title:"Edit App",src:"editAppGeneral"},{title:"Styles setup",src:"editAppStyles"}),a}function m(){var a,b=[];return h.appInfo.editPanels.forEach(function(a){b.push({title:a.title,styleClass:a.type,appBridge:!0,src:h.type,view:a.type})}),a=l(),a.forEach(function(a){b.push(a)}),b}function n(){c.enableFullscreen(t,h._id,h.width,h.onEvent.resize)}function o(){c.disableFullscreen(t,h.onEvent.resize)}function p(){Number(b.search()._id)===h._id?n():b.search()._id||o()}function q(){$(".app").not(t).removeClass("enabledHeader"),t.toggleClass("enabledHeader")}function r(){t.removeClass("enabledHeader")}function s(a,b){a.forEach(function(a){a.bindings=b})}var t=j.parent(),u=g.getUserSession();h.showHeader=function(){return u},h.showEditActions=function(){return u&&f.hasCreatorRole(u)},h.showAdminActions=function(){return u&&f.hasAdminRole(u)},h.toggleHeader=function(){q()},h.isAdmin=function(){return f.hasAdminRole(u)},h.getAppHelpText=function(){if(h.model&&h.appInfo&&h.appInfo.desc){var a="<h6>"+(h.model.title||h.appInfo.title)+" app</h6>",b=h.appInfo.desc;return a+b}return null},h.toggleFullscreen=function(){c.isFullscreen()?o():n(),r()},h.showEditTemplate=function(){var a=$("> .header > .actions > .editIcon",j);h.panels=k(),s(h.panels,h.bindings),h.onSave=function(){h.onLayer&&h.onLayer.save&&h.onLayer.save(),e.updateCurrentPage(null),d.updatePortal()},i.showEditBox(h,a,a)},a.$on("onWindowResized",function(){c.triggerOnResizeEvent(h.onEvent.resize)}),h.isTemplateFullscreen=d.isTemplateFullscreen(),a.$on("onPortalSaved",function(){h.isTemplateFullscreen=d.isTemplateFullscreen()}),p(),h.$on("$routeUpdate",function(){p()})}}}])}(),function(){"use strict";COMPONENTS.directive("bannerCanvas",["timerService","arrayService","keyboardService","roleService","sessionService","bannerItemService",function(a,b,c,d,e,f){return{restrict:"A",replace:!0,templateUrl:"bannerCanvas.html",scope:{model:"=ngModel",height:"=",gridSize:"=",onChange:"&"},link:function(g,h){function i(){$(".ruler",h).remove(),r=100/g.gridSize,s=100/g.gridSize,j(),k()}function j(){for(var a,b=0;r>b;b++)a=(b+1)*g.gridSize,t.append('<div class="ruler col" style="top: 0; left: '+a+'%"></div>')}function k(){for(var a,b=0;s>b;b++)a=(b+1)*g.gridSize,t.append('<div class="ruler row" style="top: '+a+'%; left: 0"></div>')}function l(a){m(a,f.getDefaultValue(a))}function m(b,c){var d=a.getRandomNumber(),e=Math.floor(Math.random()*s-1)*g.gridSize,f=Math.floor(Math.random()*r-1)*g.gridSize;g.items.index[d]=g.items.data.length,g.items.data.push({id:d,type:b,value:c,position:{top:e,left:f}}),q()}function n(){c.register("del",u,function(){o(),g.$apply()})}function o(){$(".bannerItem.active").each(function(){var a=$(this).attr("id"),c=g.items.index[a];delete g.items.index[a],b.delete(g.items.data,c),p()}),q()}function p(){angular.forEach(g.items.data,function(a,b){g.items.index[a.id]=b})}function q(){g.onChange&&g.onChange()}var r,s,t=$(" > .grid",h),u="bannerCanvas",v=e.getUserSession(),w=d.hasCreatorRole(v);g.$watch("gridSize",i),g.$watch("height",i),n(),g.model||(g.model=[]),g.overflow={visible:!1},g.items={index:{},data:g.model},g.addItem=l,g.onItemChange=function(){q()},g.isReadOnly=function(){return!w||h.attr("readonly")||h.attr("disabled")},g.getCanvasHeight=function(){return{height:g.height}}}}}])}(),function(){"use strict";COMPONENTS.directive("bannerItem",["bannerItemService","$timeout","editBoxUtilsService",function(a,b,c){return{restrict:"A",replace:!0,scope:{item:"=data",overflow:"=",onItemChange:"&onChange",readOnly:"=",gridSize:"="},templateUrl:"bannerItem.html",link:function(d,e){function f(){d.template=h(),d.item.size||(d.item.size=D()),a.setDomCoordinatesFromModel(d.item,e),d.invisible=!1}function g(a,b){d.readOnly||(B(a),i(),b&&b!==a&&C())}function h(){var a=$(G.getTemplate());return a.addClass("item "+d.item.type),a}function i(){j(),l(),e.click(m),H.focus(n),H.blur(o),d.editItem=p}function j(){e.draggable({grid:[F.width,F.height],start:q,stop:r})}function k(){e.draggable("destroy")}function l(){e.resizable({grid:[F.width,F.height],handles:"ne, nw, se, sw",resize:s,stop:t})}function m(a){c.isEditBoxClicked(a)||u()}function n(){e.addClass("active")}function o(){v()}function p(){J=!0,d.internalData={},d.panels=y(),d.onSave=z,d.onClose=A,w(),k(),c.showEditBox(d,I,I)}function q(){u()}function r(){a.setModelCoordinatesFromDom(d.item,d.template,e,d.gridSize,E),a.propagateChanges(d.onItemChange)}function s(){G.onResizeItem&&(G.onResizeItem(d.template),d.$apply())}function t(){a.refresh(d.item,d.template,e,d.gridSize,E),a.propagateChanges(d.onItemChange)}function u(){H.addClass("forceVisible"),H.focus()}function v(){b(function(){J||(e.removeClass("active"),H.removeClass("forceVisible"),a.setModelCoordinatesFromDom(d.item,d.template,e,d.gridSize,E))},150)}function w(){d.overflow.visible=!0}function x(){d.overflow.visible=!1}function y(){return G.getEditPanels(d.item,d.template,e,d.gridSize,E)}function z(){a.propagateChanges(d.onItemChange)}function A(){J=!1,v(),x(),j(),a.refresh(d.item,d.template,e,d.gridSize,E),a.propagateChanges(d.onItemChange)}function B(a){var b=100/a;E={width:K.width(),height:K.height()},F={width:E.width/b,height:E.height/b}}function C(){d.item.position.top-=d.item.position.top%d.gridSize,d.item.position.left-=d.item.position.left%d.gridSize,d.item.size.width-=d.item.size.width%d.gridSize,d.item.size.height-=d.item.size.height%d.gridSize,0===d.item.size.width&&(d.item.size.width=d.gridSize),0===d.item.size.height&&(d.item.size.height=d.gridSize),a.setDomCoordinatesFromModel(d.item,e)}function D(){var b=a.getDefaultItemSize(d.gridSize);return{width:b,height:b}}var E,F,G=a.getTypeService(d.item.type),H=$(" input.selectHandler",e),I=$(" button.edit",e),J=!1,K=e.parent();d.invisible=!0,d.$evalAsync(function(){f()}),d.$watch("gridSize",g)}}}])}(),function(){"use strict";COMPONENTS.factory("bannerImageService",["mediaService",function(a){function b(){return'<img ng-src="{{item.value}}" />'}function c(){return"/client/images/logo.svg"}function d(b){return[{title:"Select media",src:"selectMedia",config:{editSize:!1},bindings:{mediaSize:""},onLayer:{change:function(c){b.value=a.getDownloadUrl(c)}}}]}return{getTemplate:b,getDefaultValue:c,getEditPanels:d}}])}(),function(){"use strict";COMPONENTS.factory("bannerTextService",["bannerItemService",function(a){function b(){return'<div><label i18n-db="item.value"></label></div>'}function c(){return"menzit portal!"}function d(b,c,d,e,f){return[{title:"Content",appBridge:!0,src:"bannerText",view:"editText",bindings:{item:b},onLayer:{change:function(){a.setModelCoordinatesFromDom(b,c,d,e,f)}}}]}function e(a){a.contentChanged=function(){a.onLayer.change()}}return{getTemplate:b,getDefaultValue:c,getEditPanels:d,editText:e}}])}(),COMPONENTS.directive("lineChart",["sessionService",function(a){"use strict";return{restrict:"E",replace:!0,template:' <div class="lineChart chart" ng-style="getChartSize()" ng-show="data.length > 0"></div>',scope:{data:"="},link:function(b,c){var d=c.width();b.$watch("data",function(d,e){a.isUserLogged()&&d&&d!==e&&(c.html(""),b.data.length>0&&new Morris.Line({element:c,data:b.data,xkey:"create.date",ykeys:["count"],labels:["count"],lineColors:["#32b4e4"]}))},!0),b.getChartSize=function(){return{width:d,height:.45*d}}}}}]),COMPONENTS.directive("pieChart",["sessionService",function(a){"use strict";return{restrict:"E",replace:!0,template:' <div class="pieChart chart" ng-style="getChartSize()" ng-show="data.length > 0"></div>',scope:{data:"="},link:function(b,c){var d=c.width();b.$watch("data",function(d,e){a.isUserLogged()&&d&&d!==e&&(c.html(""),b.data.length>0&&new Morris.Donut({element:c,data:b.data}))},!0),b.getChartSize=function(){var a=.6*d,b=(d-a)/2;return{width:a,height:a,marginLeft:b}}}}}]),function(){"use strict";COMPONENTS.directive("comment",["$compile","portalService","dateService","objectService","mediaService","commentsService","constantsService","tooltipService","sessionService",function(a,b,c,d,e,f,g,h,i){return{restrict:"A",replace:!0,scope:{comment:"="},templateUrl:"comment.html",link:function(g,j){function k(a){f.deleteComment(a._id,function(){a.deleted=!0
})}function l(a){a.comments&&a.comments.length&&a.comments.forEach(function(a){l(a)}),k(a)}function m(){return g.isLoggedUser&&g.comment.create.author._id===i.getUserSession()._id}var n='<comments target-id="comment._id" parent-comment="comment" hide-add="hideAdd" placeholder="comments.addReply.placeholder"></comments>';$(".repliesWrapper",j).replaceWith(a(n)(g)),g.hideAdd=!0,g.comment.isEditable=!1,g.isLoggedUser=i.isUserLogged(),g.isSelfActionAllowed=m(),g.getDownloadUrl=function(a){return a?e.getDownloadUrl(a):!1},g.getFormattedDate=function(){return c.getFormattedDate(g.comment.create.date)},g.showRatings=function(){return d.isEmpty(g.allowRatings)?b.getPortal().comments.allowRatings:g.allowRatings},g.toggleReply=function(){g.hideAdd=g.hideAdd!==!0},g.toggleEdit=function(){g.comment.isEditable=g.comment.isEditable!==!0},g.updateComment=function(){f.updateComment(g.comment._id,{text:g.comment.text})},g.deleteComment=function(){l(g.comment),h.hide()}}}}])}(),function(){"use strict";COMPONENTS.directive("comments",["commentsService","sessionService","mediaService",function(a,b,c){return{restrict:"E",replace:!0,scope:{targetId:"=",onAdd:"=",allowRatings:"=",parentComment:"=",hideAdd:"=",placeholder:"@"},templateUrl:"comments.html",link:function(d){d.loggedUser=b.isUserLogged(),d.$watch("targetId",function(b){b&&a.loadComments(d.targetId,function(a){d.comments=a.results,d.parentComment&&(d.parentComment.comments=d.comments)})}),d.createComment=function(){a.createComment(d.newCommentText,d.targetId,function(a){d.newCommentText="",b.addSessionDataToModel(a),d.comments.push(a),void 0!==d.hideAdd&&(d.hideAdd=!0),d.onAdd&&d.onAdd()})},d.getUserAvatarUrl=function(){return b.isUserLogged()?c.getDownloadUrl(b.getUserSession().media):!1}}}}])}(),function(){"use strict";COMPONENTS.directive("contentEditable",["caretService","roleService","sessionService","mediaService","contentEditableService","contentEditableRichContentService","contentEditableSelectMediaService",function(a,b,c,d,e,f,g){return{priority:-1,require:"ngModel",scope:{contentEditable:"=",content:"=ngModel",customPanels:"=panels",options:"=",placeholder:"@",onBlur:"&",uxChange:"&"},replace:!0,templateUrl:"contentEditable.html",link:function(h,i,j,k){var l=$(" > .editableArea > [contenteditable]",i),m=c.getUserSession();h.isCreator=function(){return b.hasCreatorRole(m)},h.onKeyup=function(){e.updateValue(h,l,k),h.showEditBox()},h.isEditable=function(){var a=void 0!==h.contentEditable?h.contentEditable:h.isCreator();return a&&!i.attr("readonly")&&!i.attr("disabled")},h.$watch("content",function(){l.is(":focus")||(l.html(h.content?h.content:""),e.compileElement(h,$("a, img",l))),e.handlePlaceholder(h)}),h.showEditBox=function(){f.showEditBox(h,l,k)},h.showEditBox2=function(a){g.showEditBox(h,l,a,k)},h.onClose=function(){h.showActions=!1},h.$watch("newMedia",function(b){var c,f,g=d.getDownloadUrl(b);b&&b._id&&(c=a.insertImage(g,l,"onMediaClick"),f=$("#"+c,l),e.compileElement(h,f),e.updateValue(h,l,k))}),l.focus(function(){h.showActions=!0}),h.onMediaClick=function(a){var b=$("#"+a,l);h.showEditBox2(b)},l.blur(function(){e.propagateChanges(h)}),h.options&&h.options.allowMultiLine===!1&&l.keypress(function(a){return 13!==a.which})}}}])}(),function(){COMPONENTS.directive("richContent",["pageService","constantsService","textSelectionService","stringService","i18nService",function(a,b,c,d,e){"use strict";return{restrict:"A",replace:!0,templateUrl:"richContent.html",scope:{style:"=",model:"=",config:"=",onChange:"&",onLayer:"="},link:function(b){function f(){var a=c.getSelectedHeadingId();a&&(b.heading=a)}function g(){var a=c.getSelectedLinkId();d.isExternalUrl(a)?(b.externalLink=a,b.linkType=b.linkTypes[1].id):(b.internalLink=a,b.linkType=b.linkTypes[0].id)}function h(a,b){a&&c.setLink({id:a,href:a,title:'<a href="'+a+'" target="'+b+'">'+a+"</a>",target:b})}function i(a){c.setHeading(a)}function j(){b.headingOptions=[{value:"normal",text:"Normal"},{value:"heading1",text:"Heading 1"},{value:"heading2",text:"Heading 2"},{value:"heading3",text:"Heading 3"}]}function k(){b.pagesList=a.getPages()}b.linkTypes=[{id:"internal",text:e("richContent.link.internal")},{id:"external",text:e("richContent.link.external")}],b.propagateChanges=function(){b.onLayer&&b.onLayer.change&&b.onLayer.change(b.model),b.onChange&&b.onChange()},b.setHeading=function(){i(b.heading)},b.setInternalLink=function(){h(b.internalLink,"_self")},b.setExternalLink=function(){h(d.normalizeExternalUrl(b.externalLink),"_blank")},j(),f(),g(),k()}}}])}(),function(){COMPONENTS.directive("selectMedia",["i18nService",function(a){"use strict";return{restrict:"A",replace:!0,templateUrl:"selectMedia.html",scope:{mediaSize:"=",config:"=",onChange:"&",onLayer:"="},link:function(b){b.mediaSizes=[{id:"original",text:a("selectMedia.size.original")},{id:"small",text:a("selectMedia.size.small")},{id:"medium",text:a("selectMedia.size.medium")},{id:"big",text:a("selectMedia.size.big")}],b.propagateChanges=function(a){b.onLayer.change(a,b.mediaSize)},b.onMediaChange=function(a){b.propagateChanges(a)}}}}])}(),function(){COMPONENTS.directive("toggleStyle",["$timeout",function(a){"use strict";return{restrict:"A",replace:!0,template:'<button ng-click="toggleState()" ng-class="{active:isActive()}" on-change="propagateChanges()"></button>',scope:{model:"=ngModel",onChange:"&"},link:function(b,c,d){b.toggleState=function(){b.model=b.isActive()?d.inactiveWhen||"":d.activeWhen,a(function(){b.onChange&&b.onChange()},0)},b.isActive=function(){return b.model===d.activeWhen}}}}])}(),COMPONENTS.directive("globalMsg",["$rootScope","globalMsgService","domService",function(a,b,c){"use strict";return{restrict:"A",replace:!0,scope:{},template:'<div id="globalMsg" ng-class="getActiveStyleClass()"><div class="text"><label>{{globalMsg.text}}</label> <a href="#" ng-show="globalMsg.details" ng-click="toggleDetails()">[Details]</a><div class="details" ng-show="isDetailsVisible"><label ng-bind-html-unsafe="globalMsg.details"></label></div></div><div class="actions"><button class="removeIcon" ng-click="hide()"></button></div></div>',link:function(d){b.onShow(function(b,e,f){d.globalMsg||(d.globalMsg={text:b,details:e,type:f},c.removeLoadingFeedback($("body")),a.$$phase||d.$apply())}),b.onHide(function(){delete d.globalMsg}),d.isDetailsVisible=!1,d.hide=function(){b.hide()},d.getActiveStyleClass=function(){var a;return d.globalMsg?(a=Number(d.globalMsg.type),{active:!0,success:1===a,info:0===a,error:-1===a}):null},d.toggleDetails=function(){d.isDetailsVisible=d.isDetailsVisible===!1}}}}]),function(){"use strict";COMPONENTS.directive("backupTitle",["$rootScope","$compile",function(a,b){return{restrict:"A",compile:function(a,c){return a.attr("title",c.backupTitle),a.removeAttr("backup-title"),function(a,c){c.data("backup-title",!0),b(c)(a)}}}}]),COMPONENTS.directive("title",["$rootScope","$compile","tooltipService",function(a,b,c){return{restrict:"A",priority:-1,compile:function(){return function(d,e,f){function g(a,b,d){var f={fadeInTime:0,fadeOutTime:0,smartPlacement:!0,mouseOnToPopup:!0};angular.extend(f,b),c.initialize(e,a,f,d)}function h(){var a='<label i18n="'+(f.confirmText||"areYouSure")+'"></label>',h="executeConfirmAction('"+f.confirmAction+"')",j='<button class="okIcon" ng-click="'+h+'"></button>',k='<div class="confirmText">'+a+j+"</div>",l=b($(k))(d),m={manual:!0};d.$apply(),c.hide(),g(l,m,!0),c.show(e),i=!0}var i=!1;e.data("backup-title")&&e.attr("backup-title",f.title),d.executeConfirmAction=function(a){d.$eval(a)},f.$observe("title",function(a){g(a)}),f.$observe("confirmAction",function(a){a&&e.click(function(){h()})}),c.onClose(e,function(){i&&(i=!1,g(f.title),a.$$phase||d.$apply())}),a.$on("languageChanged",function(){g(f.title)})}}}}])}(),COMPONENTS.directive("urlToken",["i18nDbService","stringService",function(a,b){"use strict";return{restrict:"A",replace:!0,scope:{input:"=",output:"="},template:"<label>{{output}}</label>",link:function(c){c.$watch("input",function(d){var e,f;void 0!==d&&(e=a.hasI18nStructure(d)?a.getI18nProperty(d).text:d,f=b.replaceToken(e," ","-",!1),c.output=b.toCamelCase(f))},!0)}}}]),function(){"use strict";COMPONENTS.directive("i18n",["$rootScope","i18nService",function(a,b){return{restrict:"A",replace:!0,scope:{i18n:"@"},template:"<label>{{label}}</label>",link:function(c){function d(){c.label=b(c.i18n)}c.$watch("i18n",function(){d()}),a.$on("languageChanged",function(){d()})}}}])}(),function(){"use strict";COMPONENTS.directive("i18nDb",["$rootScope","i18nService","i18nDbService","constantsService",function(a,b,c,d){return{restrict:"A",replace:!0,scope:{i18nDb:"="},template:'<label ng-bind-html-unsafe="label.text"></label>',link:function(b){function e(){b.i18nDb&&(b.label=c.getI18nProperty(b.i18nDb))}a.$on(d.collections.languages+"Loaded",function(){e()}),b.$watch("i18nDb",function(){e()}),a.$on("languageChanged",function(){e()})}}}])}(),function(){"use strict";COMPONENTS.directive("i18nDbInput",["$rootScope","$compile","i18nService","i18nDbService","stringService","objectService",function(a,b,c,d,e,f){var g="_i18n_";return{priority:1e3,restrict:"A",replace:!0,transclude:"element",controller:["$scope","$element","$attrs","$transclude","$compile",function(a,b,c,d,f){this.i18nNgModel=e.replaceToken(g+c.ngModel,"\\.","_"),b.removeAttr("i18n-db-input"),b.attr("ng-model",this.i18nNgModel+".text"),f(b)(a)}],template:"<input />",link:function(b,e,h,i){function j(a){y=c.getCurrentLanguage(),t=d.hasI18nStructure(a),q(a,t),t||p(a),k(a),t=!0}function k(a){y===A||z?l(A):d.hasI18nStructure(a)?l(y):m()}function l(a){b[i.i18nNgModel]=v[a],u=!1,e.removeAttr("readonly")}function m(){b[i.i18nNgModel]=v[A],u=!0,e.attr("readonly","readonly")}function n(){w[x]={},w[x][A]={},v=w[x]}function o(a){v[A]={},v[A].text=a}function p(a){f.isObject(a)?z=!1:(n(),o(a),y!==A&&(z=!0))}function q(a,b){b?s(a):r()}function r(){b[B[0]]||(b[B[0]]={}),b[g+B[0]]={},v=b[B[0]];for(var a=1;a<B.length;a+=1)v[B[a]]||(v[B[a]]={}),w=v,v=v[B[a]],a===B.length-1&&(x=B[a])}function s(a){v=a}var t,u,v,w,x,y,z,A=c.getDefaultLanguage(),B=h.ngModel.split(".");setTimeout(function(){e.click(function(){y=c.getCurrentLanguage(),u&&(u=!1,$(this).removeAttr("readonly"),v[y]={},v[y].text=v[A].text,b[i.i18nNgModel]=v[y],b.$apply())})}),b.$watch(h.ngModel,function(a){j(a)}),a.$on("languageChanged",function(a,c){y=c,k(b.$eval(h.ngModel))})}}}])}(),COMPONENTS.directive("autoComplete",["$rootScope","tagService","constantsService","i18nService","i18nDbService",function(a,b,c,d,e){"use strict";return{restrict:"E",replace:!0,template:'<div class="autoCompleteContainer"><input type="hidden" /></div>',require:"?ngModel",scope:{model:"=ngModel",options:"=ngOptions",multiple:"@",placeholder:"@",labelKey:"@",valueKey:"@",onChange:"=uxChange"},link:function(c,f,g,h){function i(a){a.added&&a.added.newItem?(delete a.added.newItem,b.createTag(a.added.text,function(b){a.val[a.val.length-1]=b[g.valueKey],l(a.val)})):l(a.val.length>0?a.val:void 0),c.onChange&&c.onChange()}function j(){c.model&&h.$setViewValue(c.model);var a=k();s.select2(a).select2("val",c.model)}function k(){return{data:{results:c.options,text:m},multiple:"true"===g.multiple,placeholder:d(g.placeholder),minimumInputLength:0,id:n,createSearchChoice:o,initSelection:p,formatResult:q,formatSelection:r}}function l(b){c.model=b,h.$setViewValue(c.model),a.$$phase||c.$apply()}function m(a){var b=e.getI18nProperty(a[g.labelKey]).text;return b||""}function n(a){return a[g.valueKey]}function o(a,b){if(0===$(b).filter(function(){var b=e.getI18nProperty(this[g.labelKey]).text;return 0===parseInt(b.localeCompare(a),10)}).length){var c={};return c.newItem=!0,c[g.valueKey]=a,c[g.labelKey]=a,c}return null}function p(a,b){var d,e=[],f=a.val().split(",");$(f).each(function(){d=this,$(c.options).each(function(){0===parseInt(d.localeCompare(""+this[g.valueKey]),10)&&("true"===g.multiple?e.push(this):e=this)})}),b(e)}function q(a){var b=e.getI18nProperty(a[g.labelKey]).text,c="<label>"+b+"</label>";return a.newItem&&(c+=" <i>(New item)</i>"),c}function r(a){return e.getI18nProperty(a[g.labelKey]).text}var s=$(' > input[type="hidden"]',f);g.valueKey||(g.valueKey="_id"),s.on("change",function(a){i(a)}),c.$watch("options",function(){j()},!0)}}}]),function(){"use strict";COMPONENTS.directive("background",["mediaService","objectService","i18nService",function(a,b,c){return{restrict:"E",replace:!0,templateUrl:"background.html",scope:{background:"=ngModel"},link:function(d){d.position={top:[{id:"top",text:c("position.vertical.top")},{id:"center",text:c("position.vertical.center")},{id:"bottom",text:c("position.vertical.bottom")}],left:[{id:"left",text:c("position.horizontal.left")},{id:"center",text:c("position.horizontal.center")},{id:"right",text:c("position.horizontal.right")}]},d.background||(d.background={position:{top:d.position.top[0].id,left:d.position.left[0].id}}),d.background.src&&a.getMedia(d.background.src,null,function(a){d.backgroundSrc=a}),d.changeMediaId=function(a){a?d.background.src=a._id:delete d.background.src},d.existsSrc=function(){return!b.isEmpty(d.backgroundSrc)}}}}])}(),function(){"use strict";COMPONENTS.directive("borders",["i18nService",function(a){return{restrict:"E",replace:!0,templateUrl:"borders.html",scope:{borders:"=ngModel"},controller:["$scope",function(b){b.styles=[{id:"",text:""},{id:"solid",text:a("editStyles.borders.style.options.solid")},{id:"dashed",text:a("editStyles.borders.style.options.dashed")},{id:"dotted",text:a("editStyles.borders.style.options.dotted")},{id:"double",text:a("editStyles.borders.style.options.double")}]}],link:function(a){a.borders||(a.borders={}),a.onWidthChange=function(){null===a.borders.width&&(a.borders.width="")}}}}])}(),COMPONENTS.directive("checkbox",["$rootScope","$timeout",function(a,b){"use strict";return{require:"ngModel",restrict:"A",replace:!0,template:'<div class="checkContainer"><input tabindex="{{tabindex}}" type="checkbox" id="checkbox{{$id}}"><label for="checkbox{{$id}}" ng-show="label" title="{{title}}" i18n-title><label i18n="{{label}}"></label></label></div>',scope:{ngModel:"=",ngClick:"&ngClick",label:"@",tabindex:"@",title:"@",blockUpdateModel:"@"},link:function(c,d,e,f){function g(b){h||("true"!==c.blockUpdateModel&&(c.ngModel=b,f.$setViewValue(c.ngModel)),a.$$phase||c.$apply(),c.ngClick&&c.ngClick())}var h=!1;b(function(){d.iCheck({checkboxClass:"check icheckbox_square-blue",increaseArea:"20%"}),c.ngModel?d.iCheck("check"):d.iCheck("uncheck")},0),c.$watch("ngModel",function(a){h=!0,d.iCheck(a?"check":"uncheck"),setTimeout(function(){h=!1},0)}),d.on("ifChecked",function(){g(!0)}),d.on("ifUnchecked",function(){g(!1)})}}}]),COMPONENTS.directive("colorPicker",["$rootScope","$timeout","styleService","i18nService",function(a,b,c,d){"use strict";return{require:"ngModel",restrict:"A",replace:!0,template:'<div class="colorPicker"><input type="text" placeholder="{{getI18nPlaceholder()}}"/><div class="transparentToggle" checkbox ng-model="isTransparent" label="colorPicker.transparent" ng-click="toggleTransparent()" /></div>',scope:{model:"=ngModel",placeholder:"@",onChange:"&"},link:function(c,e){function f(){i(),c.$apply()}function g(a){var c="transparent"===a?"":a;"transparent"===a&&h(),b(function(){k.is(":focus")||(k.minicolors("letterCase","uppercase"),k.minicolors("value",c),k.val(c))})}function h(){c.isTransparent=!0,c.model="transparent",k.attr("readonly","readonly")}function i(){c.isTransparent=!1,"transparent"===c.model&&(c.model=""),k.removeAttr("readonly")}function j(a){return a&&"#"!==a.substr(0,1)&&(a="#"+a),a}var k=$(' > input[type="text"]',e);k.minicolors({letterCase:"uppercase",animationSpeed:0,showSpeed:0,hideSpeed:0,show:f}),k.blur(function(){c.model=c.isTransparent?"transparent":j($(this).val()),c.$apply(),c.onChange&&c.onChange()}),c.$watch("model",function(a){angular.isString(a)?g(a):k.is(":focus")||(c.model="")}),c.getI18nPlaceholder=function(){return d(c.placeholder)},c.toggleTransparent=function(){c.isTransparent?h():i(),a.$$phase||c.$apply()}}}}]),COMPONENTS.directive("date",[function(){"use strict";return{require:"ngModel",restrict:"A",replace:!0,template:'<input type="text" ui-date="dateOptions" ui-date-format="yy-mm-dd" />',controller:["$scope",function(a){a.dateOptions={dateFormat:"dd-mm-yy",changeYear:!0,showAnim:!1}}]}}]),function(){"use strict";COMPONENTS.directive("fileUploader",["$rootScope","globalMsgService",function(a,b){return{restrict:"E",replace:!0,templateUrl:"fileUploader.html",scope:{model:"=ngModel",endpoint:"@",onUpload:"&",defaultMediaUrl:"=",multiple:"@",preview:"@"},link:function(c,d){function e(b){c.model&&(c.model=b[0]),a.$$phase||c.$apply(),c.onUpload&&c.onUpload({$uploadedFile:b})}c.selectFile=function(){$('input[type="file"]',d).click()},c.submit=function(){return d.ajaxSubmit({error:function(a){b.show(a.responseText)},success:function(a){e(a)}}),!1}}}}])}(),function(){"use strict";COMPONENTS.directive("password",[function(){return{restrict:"A",require:"ngModel",replace:!0,templateUrl:"password.html",scope:{model:"=ngModel",clickToChange:"="},link:function(a){a.togglePassword=function(){a.changePasswordActive=a.changePasswordActive!==!0,a.hangePasswordActive||(a.model=null)}}}}])}(),COMPONENTS.directive("radio",["$rootScope","$timeout",function(a,b){"use strict";return{require:"ngModel",restrict:"A",replace:!0,template:'<div class="checkContainer"><input tabindex="{{tabindex}}" type="radio" id="radio{{$id}}" name="{{name}}"><label for="radio{{$id}}" ng-show="label" title="{{title}}" i18n-title><label i18n="{{label}}"></label></label></div>',scope:{ngModel:"=",name:"@",label:"@",tabindex:"@",title:"@"},link:function(c,d,e,f){function g(b){b&&!h&&("true"!==c.blockUpdateModel&&(c.ngModel=b,f.$setViewValue(c.ngModel)),c.ngClick&&c.ngClick(),a.$$phase||c.$apply())}var h=!1;b(function(){d.iCheck({radioClass:"check iradio_square-blue",increaseArea:"20%"})},0),c.ngModel===e.value&&$(" > input",d).attr("checked",!0),d.on("ifChecked",function(){g(e.value)})}}}]),COMPONENTS.directive("rating",["rateService","sessionService",function(a,b){"use strict";return{restrict:"A",replace:!0,scope:{rating:"=",targetId:"=",targetAuthorId:"=",targetCollection:"@",starSize:"@height"},templateUrl:"rating.html",link:function(c){function d(){var a=b.isUserLogged(),d=a&&c.targetAuthorId===b.getUserSession()._id;return a&&(!c.targetAuthorId||!d)}function e(){h=d()}function f(){c.normalizedRating=[],c.rateOnHover=0,g()}function g(){var a,b=5;for(a=0;b>a;a+=1)c.normalizedRating[a]=c.rating>a&&c.rating>=a+1?"full":c.rating>a?"half":"none"}var h;c.$watch("rating",function(){f()}),c.$watch("targetId",function(){f()}),c.$watch("targetAuthorId",function(){e()}),c.hoverRate=function(a){h&&(c.rateOnHover=a)},c.clearHoverRate=function(){c.rateOnHover=0},c.getStarStyleClass=function(a,b){var d=a<=c.rateOnHover?"hoverState":"";return b+"-rated "+d},c.rate=function(b){h&&a.rate(b,c.targetId,c.targetCollection,function(a){c.rating=a.avgRating,g()})},c.getStarSize=function(){var a=24;return{width:c.starSize||a,height:c.starSize||a}}}}}]),COMPONENTS.directive("contentList",["constantsService",function(a){"use strict";return{restrict:"E",replace:!0,templateUrl:"contentList.html",scope:{_id:"=id",config:"="},link:function(b){b.items=[],b.collection=a.collections.content,b.searchTargets=["title","summary","content"],b.onEditPanels=[{title:"Edit content",src:"editContent"}],b.template='<h3><a href="#"><label i18n-db="item.title"></label></a></h3><div class="summary" i18n-db="item.summary"></div><div list-expanded-view><div class="content" i18n-db="item.content"></div></div>{{item.update.date}}'}}}]),function(){"use strict";COMPONENTS.directive("createItem",["$compile",function(a){return{restrict:"A",replace:!1,template:"<div></div>",scope:{collection:"=",data:"=",onLayer:"=",onCreate:"&"},link:function(b,c){var d=b.collection,e=$("<div create-"+d+' model="data" on-layer="onLayer" class="cf"></div>');c.html(e),a(e)(b)}}}])}(),function(){COMPONENTS.directive("createItemButton",["editBoxUtilsService",function(a){return{restrict:"A",scope:{collection:"=",onCreatePanels:"=",onCreate:"&"},link:function(b,c){function d(){b.panels=e(),f(b.panels),b.onSave=function(){b.onCreate({$item:g})},a.showEditBox(b,c,c)}function e(){var a;return a=b.onCreatePanels?b.onCreatePanels:[{title:"Create item",src:"createItem"}]}function f(a){a.forEach(function(a){a.bindings||(a.bindings={}),a.bindings.collection=b.collection,a.bindings.data=g})}var g={};b.createItem=function(){d()}}}}])}(),COMPONENTS.directive("languagesList",["$rootScope","i18nService","constantsService",function(a,b,c){"use strict";return{restrict:"E",replace:!0,templateUrl:"languagesList.html",scope:{},link:function(a){function d(){a.languagesList=b.getLanguages(!0)}function e(){return'<div ng-class="{ disabled: item.inactive }"><div class="avatar columns large-2"><img ng-src="/client/images/flags/{{item.code}}.svg" /></div><div class="columns large-23"><h3><a href="#" edit-target>{{item.text}}</a></h3></div></div>'}d(),a.collection=c.collections.languages,a.onEditPanels=[{title:"Edit language",src:"editLanguage"}],a.template=e(),a.config={creatable:!1,editable:!0,deletable:!1}}}}]),function(a,b,c){"use strict";c.directive("list",["$rootScope","$location","$compile","$timeout","rowService","listService","listSelectService","roleService","sessionService","objectService","tooltipService","arrayService",function(c,d,e,f,g,h,i,j,k,l,m,n){return{restrict:"A",replace:!0,transclude:!0,templateUrl:"list.html",scope:{items:"=list",collection:"=",config:"=",projection:"=",currentPage:"=",transcludedData:"=",onCreatePanels:"=",onEditPanels:"=",template:"=",onSelect:"&",onCreate:"&",onEdit:"&",onDelete:"&",onSearch:"&",dbSource:"@"},link:function(c,e){function f(a){return l()?a:!1}function l(){var a=k.getUserSession();return j.hasAdminRole(a)}function o(){var b=g.getMaxSlots(),d=a.floor(b/c.colWidth);return e.width()/d}function p(a){c.items.forEach(function(b,d){b._id===a&&n.delete(c.items,d)})}c.isPageActionsTop=function(){var a=h.getDefaultValue("pageActionPos",c.config),d=b(a);return 0===d||2===d},c.isPageActionsBottom=function(){var a=h.getDefaultValue("pageActionPos",c.config),d=b(a);return 1===d||2===d},c.select=function(a){i.selectItem(c,a)},c.unselect=function(a){i.unselectItem(c,a)},c.clickOnItem=function(a,b,d,f){i.clickOnItem(c,e,a,b,d,f)},c.getWrapperClass=function(){var a=c.isSelectable()?"selectable":"",b=c.isEditable()?"editable":"";return a+" "+b},c.getItemStyleClasses=function(b){var d,e=g.getMaxSlots(),f=c.detailId?"detailView":"listView",h={};return c.colWidth=c.config.columns?a.floor(e/c.config.columns):e,d="large-"+c.colWidth,h[d]=!0,h.active=b.isSelected,h[f]=!0,h.boxedItems=c.config.boxedItems,h.multiSelectable=c.isMultiSelectable(),h},c.createItem=function(a){c.onCreate({$item:a})},c.deleteItem=function(a){c.isMultiSelectable()&&i.dropFromSelectedList(c,a),p(a),m.hide(),c.onDelete({$id:a})},c.deleteDetailId=function(){d.search("detailId",null)},c.isSearchable=function(){return h.getDefaultValue("searchable",c.config)},c.isSelectable=function(){return c.isSingleSelectable()||c.isMultiSelectable()},c.isSingleSelectable=function(){return f(c.config.selectable)},c.isMultiSelectable=function(){return f(c.config.multiSelectable)},c.isEditable=function(){return f(c.config.editable)},c.isDeletable=function(){return f(c.config.deletable)},c.isCreatable=function(){return f(c.config.creatable)},c.getFilter=function(){return"true"==c.dbSource?"":c.searchText},c.executeSearch=function(){c.onSearch({$text:c.searchText})},c.setItemHeight=function(){return c.config.boxedItems?{height:o()}:{}},c.page=0,void 0!==c.currentPage&&(c.currentPage=c.page),h.setDetailId(c,d.search().detailId),c.$on("$routeUpdate",function(){h.setDetailId(c,d.search().detailId)})}}}])}(window.Math,window.Number,window.COMPONENTS),function(a){"use strict";COMPONENTS.directive("listActions",["arrayService","listService",function(b,c){return{restrict:"A",replace:!0,templateUrl:"listActions.html",link:function(d){function e(){d.items.forEach(function(a){d.select(a)})}function f(){d.items.forEach(function(a){d.unselect(a)})}function g(){var a=b.copy(d.selectedIds);a.forEach(function(a){d.deleteItem(a)})}d.getPrevPage=function(){d.currentPage-=1,d.loadList()},d.getNextPage=function(){d.currentPage+=1,d.loadList()},d.showPrevPageLink=function(){return c.getDefaultValue("pageSize",d.config)&&d.currentPage>0},d.showNextPageLink=function(){var b=a(c.getDefaultValue("pageSize",d.config));return(d.currentPage+1)*b<d.totalSize},d.toggleSelectAll=function(){d.selectedIds&&d.items.length===d.selectedIds.length?f():e()},d.deleteSelected=function(){g()}}}}])}(window.Number),function(a,b,c){"use strict";c.directive("listDb",["$rootScope","$location","rowService","listService","listDbService",function(a,b,c,d,e){return{restrict:"A",replace:!0,transclude:!0,templateUrl:"listDb.html",scope:{_id:"=id",collection:"=",exportedItems:"=list",config:"=",projection:"=",searchTargets:"=",template:"=",transcludedData:"=",onCreatePanels:"=",onEditPanels:"=",onSelect:"&"},link:function(b){function c(){var a={collection:b.collection,searchText:b.searchText,searchTargets:b.searchTargets,currentPage:b.currentPage,pageSize:d.getDefaultValue("pageSize",b.config),skip:d.getDefaultValue("skip",b.config),sort:d.getDefaultValue("sort",b.config),projection:b.projection};e.loadList(a,function(a){b.totalSize=a.totalSize,b.items=a.results,b.exportedItems&&(b.exportedItems=b.items)})}b.currentPage=0,b.searchText="",b.loadList=function(){c()},b.createItem=function(a){e.createItem(b.collection,a)},b.deleteItem=function(a){e.deleteItem(b.collection,a),b.loadList()},b.onSearch=function(a){b.searchText=a,b.loadList()},b.selectItem=function(a){b.onSelect({$item:a})},b.$watch("collection",function(){b.loadList(),a.$on(b.collection+"Changed",function(){b.loadList()})})}}}])}(window.Math,window.Number,window.COMPONENTS),COMPONENTS.directive("listEdit",["rowService","tagService",function(a,b){"use strict";return{restrict:"A",replace:!1,templateUrl:"listEdit.html",link:function(c){c.availableTags=b.getTags(),c.sortTypes={field:[{id:"create.date",text:"Create date"},{id:"update.date",text:"Update date"},{id:"create.author",text:"Create author"},{id:"update.author",text:"Update author"}],order:[{id:"1",text:"Asc"},{id:"-1",text:"Desc"}]},c.model.sort||(c.model.sort={field:c.sortTypes.field[0].id,order:c.sortTypes.order[1].id}),c.columnOptions=[];for(var d=0;d<a.getMaxSlots();d+=1)c.columnOptions.push({value:d+1,text:d+1});c.model.columns||(c.model.columns=1)}}}]),function(){"use strict";COMPONENTS.directive("listExpandedView",[function(){return{restrict:"A",replace:!0,transclude:!0,template:'<div ng-show="detailId"><div ng-transclude></div></div>'}}])}(),COMPONENTS.directive("mediaList",["$rootScope","mediaService","constantsService",function(a,b,c){"use strict";return{restrict:"E",replace:!0,scope:{config:"=",onSelect:"&"},templateUrl:"mediaList.html",link:function(d){d.items=[],d.collection=c.collections.media,d.projection={data:0},d.searchTargets=["name"],d.onEditPanels=[{title:"Edit media",src:"editMedia"}],d.template='<img ng-src="{{transcludedData.getDownloadUrl(item)}}" title="{{transcludedData.getMediaTitle(item)}}" class="cursorPointer" edit-on-click="true" />',d.$watch("config",function(a){a.boxedItems=!0,a&&!a.columns&&(a.columns=4)}),d.onUpload=function(){a.$broadcast("mediaChanged","create"),d.$apply()},d.selectItem=function(a){d.onSelect({$item:a})},d.transcludedData={},d.transcludedData.getDownloadUrl=function(a){return b.getDownloadUrl(a)},d.transcludedData.getMediaTitle=function(a){return b.getMediaHtmlDetails(a)}}}}]),function(a){"use strict";a.directive("nestedItems",["$compile",function(a){return{restrict:"E",replace:!0,transclude:!0,terminal:!0,scope:{items:"=",selectedItem:"=",onSelect:"&",onAdd:"&",onDelete:"&",sortableOptions:"="},link:function(b,c){function d(a,c){b[a]&&b[a]({$item:c})}b.selectItem=function(a){d("onSelect",a)},b.addItem=function(a){d("onAdd",a)},b.deleteItem=function(a){d("onDelete",a)},b.emitSelect=function(a){d("onSelect",a)},b.emitAdd=function(a){d("onAdd",a)},b.emitDelete=function(a){d("onDelete",a)},b.toggleSubItems=function(a){a.areSubItemsHidden=a.areSubItemsHidden!==!0},b.getToggleSubItemsIcon=function(a){return a.areSubItemsHidden!==!0?"downIcon":"rightIcon"},b.$watch("sortableOptions",function(d){if(d){var e='<ul ui-sortable="sortableOptions" ng-model="items" class="items"><li ng-repeat="item in items" class="item" ng-class="{hasSubItems:item.items.length}"ng-show="!item.deleted"><div class="box" ng-class="{selected:item._id == selectedItem._id, collapsed:item.areSubItemsHidden}"><div class="sortingBox"></div><button class="toggleSubItems small" ng-click="toggleSubItems(item)" ng-show="item.items.length" ng-class="getToggleSubItemsIcon(item)"></button><div ng-click="selectItem(item)"><label i18n-db="item.text"></label></div><div class="actions"><button class="addIcon" ng-click="addItem(item)"></button><button class="removeIcon" ng-click="deleteItem(item)"></button></div></div><div class="subItemsContainer" ng-class="{hasSubItems:item.items.length}" ng-show="!item.areSubItemsHidden"><nested-items items="item.items" on-select="emitSelect($item)" on-add="emitAdd($item)" on-delete="emitDelete($item)" selected-item="selectedItem" sortable-options="sortableOptions"></nested-items></div></li></ul>';c.append(e),a(c.contents())(b)}})}}}])}(window.COMPONENTS),function(a){"use strict";a.directive("nestedItemsWrapper",["globalMsgService","i18nService","timerService","$timeout",function(a,b,c,d){return{restrict:"E",replace:!0,template:'<div><nested-items items="items" sortable-options="sortableOptions" selected-item="selectedItem" on-select="onSelectItem($item)" on-add="onAddItem($item)" on-delete="onDeleteItem($item)"></nested-items><button class="addIcon floatRight" ng-click="addRootItem()"></button></div>',scope:{items:"=",selectedItem:"=",onSelect:"&",onAdd:"&"},link:function(e){function f(a){var d={_id:c.getRandomNumber(),text:b("editPages.newPage"),items:[],position:e.items.length,added:!0};a.push(d),e.onSelectItem(d),e.onAdd&&e.onAdd({$item:d})}function g(a){a.deleted=!0,a.items&&a.items.forEach(function(a){g(a)})}function h(a){a.deleted=!1,a.items&&a.items.forEach(function(a){h(a)})}function i(a){var b=[];return a.forEach(function(a){a.deleted||(b.push(a),i(a.items).forEach(function(a){b.push(a)}))}),b}function j(){d(function(){k()},0)}function k(a,b){a?b+=1:(a=e.items,b=0),a.forEach(function(a,c){a.updated=!0,a.position=c+b,k(a.items,a.position)})}e.sortableOptions={items:"li",connectWith:"[ui-sortable]",placeholder:"sortingPlaceholder",forceHelperSize:!0,forcePlaceholderSize:!0,tolerance:"pointer",cursorAt:{top:0,left:0},handle:".sortingBox",update:j},e.onSelectItem=function(a){e.onSelect&&e.onSelect({$item:a})},e.addRootItem=function(){f(e.items)},e.onAddItem=function(a){f(a.items)},e.onDeleteItem=function(c){var d,f=!1;g(c),d=i(e.items).length>0,d?c._id===e.selectedItem._id&&e.items.forEach(function(a){a.deleted||f||(e.selectedItem=a,f=!0)}):(h(c),a.show(b("editPages.cannotDeletePage")))}}}}])}(window.COMPONENTS),function(){"use strict";COMPONENTS.directive("nestedPagesWrapper",["pageService","rowService","$timeout",function(a,b,c){return{restrict:"E",replace:!0,template:'<div><nested-items-wrapper items="items" on-select="onSelect($item)" selected-item="selectedItem"on-add="onAddPage($item)"></nested-items-wrapper></div>',scope:{pages:"=",items:"=",selectedItem:"=",onAdd:"&"},link:function(d){function e(a,b){var c=null,f=b?b.items:d.items;return f.forEach(function(b){b._id===a?c=b:c||(c=e(a,b))}),c}function f(a){d.pages=a,d.items=[],d.pages.forEach(function(a){if(a.items=[],a.parentPageId){var b=e(a.parentPageId);b.items.push(a)}else d.items.push(a)}),g()}function g(){c(function(){d.selectedItem=d.items[0]})}var h;d.selectedItem={},d.onSelect=function(a){d.selectedItem=a},d.onAddPage=function(a){a.description="",a.rows=[b.getEmptyRow()],d.onAdd&&d.onAdd({$page:a})
},h=a.getPages(),f(h)}}}])}(),COMPONENTS.directive("tagList",["constantsService",function(a){"use strict";return{restrict:"E",replace:!0,templateUrl:"tagList.html",scope:{config:"="},link:function(b){b.items=[],b.collection=a.collections.tags,b.searchTargets=["text"],b.onEditPanels=[{title:"Edit tag",src:"editTag"}]}}}]),COMPONENTS.directive("userList",["$rootScope","mediaService","userService","constantsService","listDbService",function(a,b,c,d,e){"use strict";return{restrict:"E",replace:!0,templateUrl:"userList.html",scope:{config:"="},link:function(f){function g(){f.userList=c.getUsers()}function h(){c.loadUsers(function(a){f.userList=a})}function i(a){c.createUser(a.user,function(){a.user={},h()})}function j(a){e.deleteItem(f.collection,a),h()}function k(a){return a.media?b.getDownloadUrl(a.media):b.getDefaultAvatarUrl()}function l(){return'<div class="avatar columns large-3"><img ng-src="{{transcludedData.getUserAvatarUrl(item)}}" /></div><div class="columns large-22"><h3><a href="#">{{item.fullName}}</a></h3><div list-expanded-view class="email" ng-bind-html-unsafe="item.email"></div>{{item.create.date}}</div>'}var m={user:{}};g(),f.collection=d.collections.users,f.onCreatePanels=[{title:"Create user",src:"createUser",bindings:m}],f.onEditPanels=[{title:"Edit users",src:"editUser"}],f.onCreate=function(){i(m)},f.onDelete=j,f.transcludedData={},f.transcludedData.getUserAvatarUrl=k,f.template=l(),a.$on(f.collection+"Changed",function(){h()}),f.config.pageActionPos=0}}}]),COMPONENTS.directive("login",["sessionService",function(a){"use strict";return{restrict:"E",replace:!0,templateUrl:"login.html",scope:{},link:function(b){b.userSession=a.getUserSession(),b.logout=function(){a.logout()}}}}]),function(){"use strict";COMPONENTS.directive("mediaPicker",["$rootScope","editBoxUtilsService","mediaService",function(a,b,c){return{restrict:"E",replace:!0,scope:{model:"=ngModel",endpoint:"@",onUpload:"=",onMediaChange:"&onChange",onMediaClose:"&onClose",defaultMediaUrl:"=",preview:"@"},templateUrl:"mediaPicker.html",link:function(d,e){function f(b){d.model&&(d.model=b),a.$$phase||d.$apply(),d.onUpload&&d.onUpload(b),d.onMediaChange&&d.onMediaChange({$media:b})}d.getDownloadUrl=function(a){return a&&a._id?c.getDownloadUrl(a):d.defaultMediaUrl?d.defaultMediaUrl:null},d.getFileTitle=function(a){return c.getMediaHtmlDetails(a)},d.selectFromMediaList=function(){d.panels=[{title:"Media list selection",src:"mediaListPicker",onLayer:{change:function(a){f(a)}}}],d.onClose=function(){d.onMediaClose&&d.onMediaClose()},b.showEditBox(d,e,$("button",e))},d.deleteSelection=function(){f(null)}}}}]),COMPONENTS.directive("mediaListPicker",[function(){return{restrict:"A",replace:!1,template:'<media-list config="config" on-select="onSelect($item)"></media-list>',scope:{onLayer:"="},link:function(a){a.config={selectable:!0,uploadable:!0,columns:2},a.onSelect=function(b){a.onLayer.change(b)}}}}])}(),COMPONENTS.directive("pages",["$rootScope","portalService","pageService","rowService","appService","roleService","sessionService","styleService",function(a,b,c,d,e,f,g,h){"use strict";return{restrict:"E",replace:!0,templateUrl:"pages.html",link:function(c){function d(a,b,c,d){var e=a;return j||(c||d.length?e++:e=0,1===b&&e++),e}function i(){return c.isAdmin()&&!e.isFullscreen()}var j=!1;a.$on("portalLoaded",function(){c.portal=b.getPortal()}),c.setPagesStyles=function(){return c.portal?h.getNormalizedStyles(c.portal.styles,null):null},c.getCurrentUserAdminAccessStyleClass=function(){return f.getCurrentUserAdminAccessStyleClass()},c.isAdmin=function(){return f.hasAdminRole(g.getUserSession())},c.isAppSortAllowed=function(){return i()},c.isAppResizeAllowed=function(){return i()},a.$on("onStartDraggingNewApp",function(){j=!0,c.$digest()}),a.$on("onStopDraggingNewApp",function(){j=!1,c.$digest()}),c.getColStyleClass=function(a,b,c){var e,f={};return c&&(a.apps?f.template=!0:f.pageWrapper=!0),e=d(a.size,b,f.pageWrapper,a.apps),f["large-"+e]=!0,f}}}}]),function(){"use strict";COMPONENTS.directive("resizableApp",["resizableAppService",function(a){return{restrict:"A",replace:!1,link:function(b,c,d){function e(){c.resizable({handles:"e, w",start:function(b){a.start($(this),b)},resize:function(){a.resize($(this))}})}function f(){c.resizable("destroy")}var g=!1;d.$observe("resizableApp",function(a){"true"===a?(g=!0,e()):g&&f()})}}}])}(),function(){"use strict";COMPONENTS.directive("sortableAddApp",["sortableAppService","keyboardService","$timeout",function(a,b,c){return{restrict:"A",replace:!1,link:function(d,e){function f(b){$(b.helper).css({width:e.outerWidth(),height:e.outerHeight()}),h(),a.broadcastStartSortingApp()}function g(){i(),a.broadcastStopSortingApp()}function h(){b.register("esc","sortableAddApp",function(){e.trigger("mouseup")})}function i(){b.unregister("esc","sortableAddApp")}c(function(){e.draggable({helper:"clone",connectToSortable:"[sortable-app]",forceHelperSize:!0,tolerance:"pointer",cursorAt:{top:0,left:0},start:function(a,b){f(b)},stop:function(){g()}})},0)}}}])}(),function(){"use strict";COMPONENTS.directive("sortableApp",["pageService","sortableAppService",function(a,b){return{restrict:"A",replace:!1,link:function(a,c,d){function e(){a.sortableOptions={items:".app",cancel:".content > *",connectWith:"[sortable-app]",placeholder:"sortingPlaceholder",tolerance:"pointer",cursorAt:{top:0,left:0},start:function(a,c){b.start(c),b.broadcastStartSortingApp()},update:function(a,c){b.update(c)},stop:function(){b.stop(),b.broadcastStopSortingApp()}}}var f=c.closest("[sortable-app]");a.sortableOptions={},e(),d.$observe("sortableApp",function(a){"true"!==a?f.sortable("disable"):f.sortable("enable")})}}}])}(),function(a){"use strict";COMPONENTS.directive("boxSortable",["keyboardService",function(b){return{restrict:"A",transclude:!0,template:'<ul class="sortable" ng-transclude></ul>',scope:{onChange:"=uxChange",handle:"@",connectWith:"@"},replace:!0,link:function(c,d,e){var f=function(){c.onChange&&c.onChange()},g=e.connectWith?$(e.connectWith):d;d.sortable({placeholder:"sortingPlaceholder",forceHelperSize:!0,forcePlaceholderSize:!0,connectWith:e.connectWith,tolerance:"pointer",handle:e.handle||"",cursorAt:{top:0,left:0},start:function(){g.addClass("sorting"),b.register("esc","boxSortable",function(){d.sortable("option","update",function(){return!1}),$(a).trigger("mouseup"),d.sortable("option","update",function(){f()})})},stop:function(){g.removeClass("sorting"),b.unregister("esc","boxSortable")},update:f}),d.disableSelection()}}}])}(window.document),function(){COMPONENTS.directive("multipleFiles",[function(){"use strict";return{restrict:"A",link:function(a,b,c){c.$observe("multipleFiles",function(a){"true"===a?b.attr("multiple",""):b.removeAttr("multiple")})}}}])}(),function(){"use strict";function a(a){return a.charAt(0).toUpperCase()+a.slice(1)}var b=angular.forEach,c=["change","keyup","blur"];b(c,function(b){var c="ux"+a(b);COMPONENTS.directive(c,["$parse",function(a){return function(d,e,f){var g=a(f[c]);e.bind(b,function(a){d.$apply(function(){g(d,{$event:a})})})}}])})}(),function(){"use strict";COMPONENTS.directive("uxShow",["constantsService",function(a){return{terminal:!0,transclude:"element",priority:100,restrict:"A",compile:function(b,c,d){return function(b,c,e){function f(){i=b.$new(),d(i,function(b){c.after(b),setTimeout(function(){h=c.next()},a.keyboardInterval)})}function g(){h&&(h.remove(),h=null),i&&(i.$destroy(),i=null)}var h,i;b.$watch(e.uxShow,function(a){a?f():g()})}}}}])}(),function(){"use strict";COMPONENTS.directive("uxTransclude",["$compile",function(a){return{restrict:"A",scope:{template:"=uxTransclude"},link:function(b,c){b.$watch("template",function(d){if(d){var e=$(d);c.html(e),a(e)(b.$parent)}})}}}])}(),COMPONENTS.directive("emailMandatory",["emailService","validationService",function(a,b){"use strict";return{restrict:"A",require:"ngModel",link:function(c,d,e,f){var g=c.$eval(e.ngModel),h="Please enter a valid e-mail",i="emailMandatory",j=function(b){return!b||""===b||a.validateEmail(b)};b.setupValidation(g,d,f,h,null,i,j)}}}]),COMPONENTS.directive("mandatory",["validationService",function(a){"use strict";return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var f=b.$eval(d.ngModel),g="This field is required",h="mandatory",i=function(a){return a&&""!==a};a.setupValidation(f,c,e,g,null,h,i)}}}]),COMPONENTS.directive("passwordMandatory",["$compile","validationService",function(a,b){"use strict";return{require:"ngModel",link:function(c,d,e,f){var g=c.$eval(e.ngModel),h="Password must meet the following requirements",i="passwordMandatory",j='<ul><li ng-class="pwdHasLetter">At least <strong>one letter</strong></li><li ng-class="pwdHasNumber">At least <strong>one number</strong></li><li ng-class="pwdValidLength">At least <strong>8 characters long</strong></li></ul>',k=a(j)(c),l=function(a){return a?(c.pwdValidLength=a&&a.length>=8?"valid":void 0,c.pwdHasLetter=a&&/[A-z]/.test(a)?"valid":void 0,c.pwdHasNumber=a&&/\d/.test(a)?"valid":void 0,c.pwdValidLength&&c.pwdHasLetter&&c.pwdHasNumber):!0};b.setupValidation(g,d,f,h,k,i,l)}}}]),function(){"use strict";COMPONENTS.factory("ajaxService",["$http","loadingService",function(a,b){function c(c){var d={url:c.url,method:c.method||"GET",data:c?c.data:{}};d.data&&"GET"===d.method&&(d.url=d.url+"?"+decodeURIComponent($.param(d.data))),b.start(),a(d).success(function(a){c.success&&c.success(a)}).error(function(a){c.error&&c.error(a)}),b.done()}return{ajax:c}}])}(),function(){"use strict";COMPONENTS.factory("addAppService",["pageService","domService",function(a){function b(){var b=$("#addAppPanel"),c=a.getMainScrollingElm();b.attr("state","collapsed"),c.addClass("addAppPanelOpen"),f=!0}function c(){var b=$("#addAppPanel"),c=a.getMainScrollingElm();f&&(f=!1,b.attr("state","hidden"),c.removeClass("addAppPanelOpen"))}function d(){f?c():b()}function e(){return f}var f=!1;return{showAddAppPanel:b,hideAddAppPanel:c,toggleAddAppPanel:d,isAddAppPanelActive:e}}])}(),function(){"use strict";COMPONENTS.factory("appService",["$rootScope","$location","portalService","pageService","rowService","colService","arrayService","keyboardService",function(a,b,c,d,e,f,g,h){function i(a,b,d,e){k()||($("html").addClass("fullscreen"),x=!0,c.isRealFullscreen()?o(a,e):c.isMaximizedFullscreen()?q(a,b):c.isTemplateFullscreen()&&s(a,b,d),l(e),u(a,e))}function j(a,b){$("html").removeClass("fullscreen"),x=!1,c.isRealFullscreen()?p(a):c.isMaximizedFullscreen()?r(a):c.isTemplateFullscreen()&&t(a),l(b),v()}function k(){return x}function l(a){a&&setTimeout(function(){a()},100)}function m(a,b){var h=angular.element(a.closest(".columns")).scope(),i=h.column.apps,j=h.$parent,k=j.row.columns,l=e.getWrappingRows(j,c.getPortal().template.rows);g.delete(i,b),0===i.length&&(f.deleteColAndDependencies(k,h.$index),1!==k.length||e.isTemplateRow(j.row)||e.deleteRowAndDependencies(l,j.$index)),d.updateCurrentPage(),c.updatePortal()}function n(a){return a.closest(".app")}function o(a,b){$("html").addClass("appRealFullscreen"),a.addClass("realFullscreen"),a.fullScreen(!0),$(document).bind("fullscreenchange",function(){$(document).fullScreen()||j(a,b)})}function p(a){$("html").removeClass("appRealFullscreen"),a.removeClass("realFullscreen"),a.fullScreen(!1),$(document).unbind("fullscreenchange")}function q(a,b){$("html").addClass("appMaximizedFullscreen"),a.addClass("maximizedFullscreen"),w(b)}function r(a){$("html").removeClass("appMaximizedFullscreen"),a.removeClass("maximizedFullscreen"),w(null)}function s(a,b,c){var d=a.closest(".columns");d.addClass("colFullscreen large-23"),d.prev(".columns").addClass("colFullscreen"),d.next(".columns").addClass("colFullscreen"),y=c,$("html").addClass("appTemplateFullscreen"),a.addClass("templateFullscreen"),w(b)}function t(a){$(".colFullscreen.large-23").removeClass("large-23").addClass("large-"+y),$(".colFullscreen").removeClass("colFullscreen"),$("html").removeClass("appTemplateFullscreen"),a.removeClass("templateFullscreen"),w(null)}function u(b,c){h.register("esc",z,function(){j(b,c),a.$apply()})}function v(){h.unregister("esc",z)}function w(a){b.search("_id",a)}var x,y,z="app";return{enableFullscreen:i,disableFullscreen:j,isFullscreen:k,triggerOnResizeEvent:l,deleteApp:m,getAppRootElem:n}}])}(),function(){"use strict";COMPONENTS.factory("resizableAppService",["portalService","pageService","rowService",function(a,b,c){function d(a,b){var c=a.closest(".rows"),d=c.width()/o;l=a.width(),m=angular.element(a).scope(),f(a,b),a.resizable("option","grid",d)}function e(c){var d=c.width()<l;n&&k(d),l=c.width(),c.removeAttr("style"),m.$parent.$apply(),b.updateCurrentPage(),a.updatePortal()}function f(a,b){var c=m.$index;b.clientX>a.offset().left+a.width()/2?g(c):h(c)}function g(a){var b=m.$parent.row.columns[a+1];n=j(a,b)?b:m.$parent.row.columns[a+2]}function h(a){var b=m.$parent.row.columns[a-1];n=i(a,b)?b:m.$parent.row.columns[a-2]}function i(a,b){return 1===a||b.size>1}function j(a,b){return a===m.$parent.row.columns.length-2||b.size>1}function k(a){a&&m.column.size>1?(m.column.size=m.column.size-1,n.size=n.size+1):(m.column.size=m.column.size+1,n.size=n.size-1)}var l,m,n,o=c.getMaxSlots();return{start:d,resize:e}}])}(),function(){"use strict";COMPONENTS.factory("sortableAppService",["$rootScope","$timeout","portalService","pageService","rowService","colService","arrayService","keyboardService","timerService",function(a,b,c,d,e,f,g,h,i){function j(a){$("html").addClass("sorting"),G=$(a.item).parent(),I=!$(a.item).hasClass("new"),p()}function k(b){s(G,$(b.item)),o()&&(r(),a.$$phase||a.$apply()),I=!1}function l(){q(),$("html").removeClass("sorting")}function m(){a.$broadcast("onStartDraggingNewApp")}function n(){a.$broadcast("onStopDraggingNewApp")}function o(){return f.areSameCol(H.originalCol,H.dropCol)||!I||H.isNewItem}function p(){h.register("esc","sortableApp",function(){$("[sortable-app]").trigger("mouseup")})}function q(){h.unregister("esc","sortableApp")}function r(){e.isAvailableSpaceInRow(H.dropRow,H.dropCol,H.affectedDropCol)?b(function(){u()},0):t()}function s(a,b){var d=c.getPortal().template.rows;return H={},H.isNewItem=void 0!==b.attr("sortable-add-app"),H.wrapperOriginalRowScope=angular.element(a.closest(".rows")).scope(),H.wrapperDropRowScope=angular.element(b.closest(".rows")).scope(),H.originalRows=e.getWrappingRows(H.wrapperOriginalRowScope,d),H.dropRows=e.getWrappingRows(H.wrapperDropRowScope,d),H.droppedElm=b,H.originalColIndex=a.closest(".columns").prevAll(".columns").size(),H.dropColIndex=b.closest(".columns").prevAll(".columns").size(),H.originalRowIndex=a.closest(".rows").prevAll(".rows").size(),H.originalAppIndex=a.prevAll(".app").size(),H.dropRowIndex=b.closest(".rows").prevAll(".rows").size(),H.dropAppIndex=b.prevAll(".app").size(),H.originalRow=a.closest(".rows").scope().row,H.dropRow=b.closest(".rows").scope().row,H.dropCol=H.dropRow.columns[H.dropColIndex],H.originalCol=H.originalRow.columns[H.originalColIndex],H.elmHasChangedRow=H.originalRow.$$hashKey!==H.dropRow.$$hashKey,H.affectedDropCol=f.getAffectedCol(H.dropRow.columns,H.dropColIndex),H.affectedOriginalCol=H.elmHasChangedRow?f.getAffectedCol(H.originalRow.columns,H.originalColIndex):H.affectedDropCol,H}function t(){F(H.dropCol,H.droppedElm,H.dropAppIndex),b(function(){g.delete(H.dropCol.apps,H.dropAppIndex)})}function u(){H.isNewItem&&F(H.dropCol,H.droppedElm,H.dropAppIndex),v(),D(),E(),d.updateCurrentPage(),c.updatePortal()}function v(){(H.isNewItem||1===H.dropCol.apps.length||0===H.originalCol.apps.length)&&(H.isNewItem||H.elmHasChangedRow?w():z())}function w(){e.isDropRowEmpty(H.dropRow)&&!e.isTemplateRow(H.wrapperDropRowScope.row)&&C(),H.affectedDropCol&&H.dropCol.apps.length>0?y():H.affectedOriginalCol&&x()}function x(){var a=H.affectedOriginalCol.size+H.originalCol.size;H.affectedOriginalCol.size=a+1}function y(){var a=H.dropCol.size+H.affectedDropCol.size;H.dropCol.size=Math.ceil(a/2)+1,H.affectedDropCol.size=Math.floor(a/2)-1,H.affectedOriginalCol&&!H.originalCol.apps.length&&(a=H.affectedOriginalCol.size+H.originalCol.size,H.affectedOriginalCol.size=a+1)}function z(){H.affectedDropCol&&H.originalCol.apps.length?B():A()}function A(){var a=H.dropCol.size+H.originalCol.size;H.dropCol.size=a+1}function B(){var a=H.dropCol.size+H.affectedDropCol.size;H.affectedDropCol.$$hashKey!==H.dropCol.$$hashKey&&(H.dropCol.size=Math.ceil(a/2)+1,H.affectedDropCol.size=Math.floor(a/2)-1)}function C(){e.addEmptyRow(H.dropRows,H.dropRowIndex),e.addEmptyRow(H.dropRows,H.dropRowIndex+2),H.dropRowIndex<H.originalRowIndex&&(H.originalRowIndex+=2)}function D(){1===H.dropCol.apps.length&&f.addEmptyCols(H.dropRow,H.dropCol,H.dropColIndex),f.normalizeEmptyCols(H.originalRow),e.isOriginalRowEmpty(H.originalRow)&&!e.isTemplateRow(H.wrapperOriginalRowScope.row)&&e.deleteRowAndDependencies(H.originalRows,H.originalRowIndex)}function E(){H.droppedElm.siblings("[app]:not(:empty)").size()+1>H.dropCol.apps.length&&H.droppedElm.remove()}function F(a,b,c){a.apps.forEach(function(b,c){b||g.delete(a.apps,c)}),g.add(a.apps,{type:b.attr("type"),id:i.getRandomNumber()},c),b.remove()}var G,H,I=!1;return{start:j,update:k,stop:l,broadcastStartSortingApp:m,broadcastStopSortingApp:n}}])}(),function(){"use strict";COMPONENTS.factory("availableAppsService",["$rootScope","crudService","constantsService",function(a,b,c){function d(d){var f={sort:{field:"category",order:"-1"}};b.get(c.collections.availableApps,null,f,function(b){g(b.results),a.$broadcast("availableAppsLoaded"),d&&d(e())})}function e(){return i}function f(){return j}function g(a){var b=0;i={index:{},model:[]},a.forEach(function(a){h(a),i.index[a.id]=b,i.model.push(a),b+=1})}function h(a){a.category||(a.category=c.defaultCategory),j[a.category]||(j[a.category]=!0,a.firstInCategory=!0)}var i,j=[];return{loadAvailableApps:d,getAvailableApps:e,getCategories:f}}])}(),function(){"use strict";COMPONENTS.factory("bannerItemService",["$rootScope","$injector","stringService",function(a,b,c){function d(a){var b=e(a);return b.getDefaultValue()}function e(a){var c=k(a);return b.get(c)}function f(a,b){b.css("width",a.size.width+"%"),b.css("height",a.size.height+"%"),b.css("top",a.position.top+"%"),b.css("left",a.position.left+"%")}function g(b,c,d,e,f){var g=d.width()>c.width()?d.width():c.width(),h=d.height()>c.height()?d.height():c.height();b.size.width=Math.round(g/f.width*100),b.size.height=Math.round(h/f.height*100),b.position.top=Math.round(parseInt(d.css("top"),10)/f.height*100),b.position.left=Math.round(parseInt(d.css("left"),10)/f.width*100),l(b,e),a.$$phase||a.$apply()}function h(a,b,c,d,e){g(a,b,c,d,e),f(a,c)}function i(a){a&&a()}function j(a){return 2*a}function k(a){return"banner"+c.capitalize(a)+"Service"}function l(a,b){var c=a.size.width%b,d=a.size.height%b,e=a.position.top%b,f=a.position.left%b;c&&(a.size.width=a.size.width-c+b),d&&(a.size.height=a.size.height-d+b),e&&(a.position.top=a.position.top-e+b),f&&(a.position.left=a.position.left-f+b)}return{getDefaultValue:d,getTypeService:e,refresh:h,setDomCoordinatesFromModel:f,setModelCoordinatesFromDom:g,propagateChanges:i,getDefaultItemSize:j}}])}(),function(){"use strict";COMPONENTS.factory("commentsService",["crudService","constantsService",function(a,b){function c(c,d){var e={q:{targetId:c},sort:{field:"create.date",order:"1"}};a.get(b.collections.comments,null,e,function(a){d&&d(a)})}function d(c,d,e){var f={text:c,targetId:d};a.create(b.collections.comments,f,function(a){e&&e(a)})}function e(c,d,e){a.update(b.collections.comments,c,d,function(a){e&&e(a)})}function f(c,d){a.delete(b.collections.comments,c,function(){d&&d()})}return{loadComments:c,createComment:d,updateComment:e,deleteComment:f}}])}(),function(){"use strict";COMPONENTS.factory("emailService",["ajaxService",function(a){function b(a){var b=/\S+@\S+\.\S+/;return b.test(a)}function c(b,c){a.ajax({url:"rest/sendEmail",method:"POST",data:b,success:function(a){c&&c(a)}})}return{validateEmail:b,sendEmail:c}}])}(),function(a){"use strict";COMPONENTS.factory("liveMessageService",["globalMsgService",function(b){function c(a,b){d.emit("publicMessage",a,function(a){b&&b(a)})}var d=a.connect(window.location.origin);return d.on("publicMessageReceived",function(a){b.show("msg received: "+a.text,a.details,0)}),{sendPublicMessage:c}}])}(window.io),function(){"use strict";COMPONENTS.factory("constantsService",[function(){return{appKey:"app",appsPath:"/client/apps",defaultCategory:"Others",collections:{portal:"portal",pages:"pages",availableApps:"availableApps",content:"content",media:"media",users:"users",roles:"roles",comments:"comments",ratings:"ratings",tags:"tags",languages:"languages"},roles:{guest:"guest",reader:"reader",creator:"creator",admin:"admin",superAdmin:"superAdmin"},templates:{view:"view",edit:"edit",help:"help"},renderTypes:{dom:"dom",canvas:"canvas"},pageTypes:{apps:"apps",externalLink:"externalLink"},stylesTarget:{portal:"portal",app:"app"},blurOpacity:.3,keyboardInterval:100,defaultFontSize:16}}])}(),function(){"use strict";COMPONENTS.factory("contentEditableRichContentService",["contentEditableService","editBoxUtilsService","textSelectionService","tooltipService","styleService",function(a,b,c,d,e){function f(a,d,f){if(a.isEditable()&&c.isSelection()){var l,m=c.getSelectedTextDomObj();a.style=e.getComputedStyleInRange(d,m),l=[{title:"Content",src:"richContent",bindings:{style:a.style}}],j(),k(d),a.panels=a.customPanels?a.customPanels:l,a.onSave=function(){g(a,d,f)},a.onCancel=function(){h(a)},a.onChange=function(){i(a,d,f,a.style)},b.showEditBox(a,d,m),a.showActions=!0}}function g(b,d,e){l(b),c.removeSelection(),a.updateValue(b,d,e),a.propagateChanges(b)}function h(b){c.removeSelection(),a.propagateChanges(b)}function i(b,d,e,f){c.restoreSelection(),c.setStylesToSelection(f),a.updateValue(b,d,e),k(d)}function j(){c.setFakeSelection(),c.saveSelection()}function k(a){a.blur()}function l(b){var e=c.getSelectedLink(),f=e.attr("title");e.size()&&(d.exists(e)?m(e,f):a.compileElement(b,e),d.backupTitle(e,f))}function m(a,b){d.setTitle(b,a,!0),a.removeAttr("title")}return{showEditBox:f}}])}(),function(){"use strict";COMPONENTS.factory("contentEditableSelectMediaService",["contentEditableService","editBoxUtilsService","mediaService",function(a,b,c){function d(a,c,d,l){var m=[{title:"Select media",src:"selectMedia",bindings:{mediaSize:k(d)},onLayer:{change:function(a,b){i(d,a),j(d,b)}}}];a.isEditable()&&(h($("img.active",c)),b.hideEditBox(a.$id),g(d),a.panels=m,a.onSave=function(){e(a,c,d,l)},a.onCancel=function(){f(d)},b.showEditBox(a,c,d),a.showActions=!0)}function e(b,c,d,e){h(d),a.updateValue(b,c,e),a.propagateChanges(b)}function f(a){h(a)}function g(a){a.addClass("active")}function h(a){a.removeClass("active")}function i(a,b){b&&a.attr("src",c.getDownloadUrl(b))}function j(a,b){a.attr("size",b)}function k(a){return a.attr("size")}return{showEditBox:d}}])}(),function(){"use strict";COMPONENTS.factory("contentEditableService",["$compile","$timeout","editBoxUtilsService",function(a,b,c){function d(a,b,c){"<br>"===b.html()&&b.html(""),a.content=b.html(),f(a),c.$setViewValue(a.content),a.uxChange&&a.uxChange()}function e(a){b(function(){c.isAnyEditBoxVisible()||(a.showActions=!1,a.onBlur&&a.onBlur())},250)}function f(a){a.showPlaceholder=void 0===a.content||""===a.content}function g(b,c){a(c)(b)}return{updateValue:d,propagateChanges:e,handlePlaceholder:f,compileElement:g}}])}(),function(){"use strict";COMPONENTS.factory("contentService",["crudService","constantsService",function(a,b){function c(c,d){var e;c&&(c.title||c.summary||c.content)?(e={title:c.title,summary:c.summary,content:c.content,tags:c.tags},a.create(b.collections.content,e,function(a){d&&d(a)})):d&&d({})}function d(c,d){var e;c&&(c.title||c.summary||c.content)?(e={title:c.title,summary:c.summary,content:c.content,tags:c.tags},a.update(b.collections.content,c._id,e,function(a){d&&d(a)})):d&&d({})}function e(c,d,e){d||(d={}),a.get(b.collections.content,c,d,function(a){e&&e(a)})}return{createContent:c,updateContent:d,getContent:e}}])}(),function(a){"use strict";a.factory("crudService",["$rootScope","ajaxService","constantsService",function(a,b,c){function d(c,d,e,f){b.ajax({url:"rest/"+c+"/create",data:d,method:"POST",success:function(b){f||a.$broadcast(c+"Changed","create"),e&&e(b)}})}function e(a,c,d,e){b.ajax({url:"rest/"+a+(c?"/"+c:""),data:d?d:{},method:"GET",success:function(a){e&&e(a)}})}function f(c,d,e,f,g){b.ajax({url:"rest/"+c+"/"+d+"/update",data:e,method:"PUT",success:function(b){g||a.$broadcast(c+"Changed",d),f&&f(b)}})}function g(c,d,e,f){b.ajax({url:"rest/"+c+"/"+d+"/delete",method:"DELETE",success:function(b){f||a.$broadcast(c+"Changed",d),e&&e(b)}})}function h(a,c,d){b.ajax({url:"rest/"+a+"/getStats",data:c?c:{},method:"GET",success:function(a){d&&d(a)}})}function i(a,c,d){b.ajax({url:"rest/"+a+"/rate",data:c,method:"POST",success:function(a){d&&d(a)}})}function j(d,e,f,g){b.ajax({url:"rest/"+c.collections.availableApps+"/"+d+"/undeploy",data:e,method:"POST",success:function(){g||a.$broadcast(c.collections.availableApps+"Undeployed",e.id),f&&f({})}})}return{create:d,get:e,update:f,"delete":g,getStats:h,rate:i,undeployApp:j}}])}(window.COMPONENTS),function(a){"use strict";a.factory("dbService",["crudService",function(a){function b(b){a.get(h,null,null,function(a){b&&b(a)})}function c(b,c){a.create(h,b,function(a){c&&c(a)})}function d(b,c,d){a.update(h,b,c,function(a){d&&d(a)})}function e(b,c){a.delete(h,b,function(a){c&&c(a)})}function f(a,b){var c=b?"^"+a+"$":a;return{$regex:c,$options:"i"}}function g(a){return{$regex:"^.*"+a+".*",$options:"i"}}var h="databases";return{loadDatabases:b,createDatabase:c,updateDatabase:d,deleteDatabase:e,getInsensitiveSelector:f,getInexactSelector:g}}])}(window.COMPONENTS),function(){"use strict";COMPONENTS.factory("globalMsgService",["arrayService",function(a){function b(b,c,d){d||(d=-1);var e=f(b,c,d);g.length?g.forEach(function(a){a(e.text,e.details,e.type)}):a.add(i,{text:b,details:c,type:d},0)}function c(){h.forEach(function(a){a()})}function d(c){g.push(c),i.length&&i.forEach(function(c,d){b(c.text,c.details,c.type),a.delete(i,d)})}function e(a){h.push(a)}function f(a,b,c){var d={};try{d=$.parseJSON(a)}catch(e){d={text:a,details:b,type:c}}return d}var g=[],h=[],i=[];return{show:b,hide:c,onShow:d,onHide:e}}])}(),function(){"use strict";COMPONENTS.factory("loadingService",[function(){function a(){NProgress.start()}function b(){NProgress.done()}return NProgress.configure({trickleRate:.1,trickleSpeed:0}),{start:a,done:b}}])}(),function(){"use strict";COMPONENTS.factory("stdService",["globalMsgService",function(a){function b(a,b){console.warn("[WARN] "+a,b)}function c(b,c){console.error("[ERROR] "+b,c),a.show(b,c)}function d(a){console.log("[TODO] "+a)}return{warn:b,error:c,todo:d}}])}(),function(){"use strict";COMPONENTS.factory("tooltipService",["i18nService","i18nDbService",function(a,b){function c(a,b,c,d){a.powerTip(c),j(b,a,d),a.removeAttr("title")}function d(a){h(a)&&$.powerTip.show(a)}function e(){try{$.powerTip.hide(null,!0)}catch(a){}}function f(a,b){a.on({powerTipClose:function(){b&&b()}})}function g(){return{smartPlacement:!0,fadeInTime:0,fadeOutTime:0,closeDelay:200,mouseOnToPopup:!0}}function h(a){return a.data("powertip")}function i(a,b){a.attr("backup-title",b)}function j(c,d,e){var f=d.attr("i18n-title"),g=d.attr("i18n-db-title");if(e)d.data("powertip",c);else if(void 0!==f)d.data("powertip",a(c));else if(void 0!==g)try{d.data("powertip",b.getI18nProperty(jQuery.parseJSON(c)).text)}catch(h){d.data("powertip",c)}else d.data("powertip",c)}return{initialize:c,show:d,hide:e,onClose:f,getDefaults:g,exists:h,backupTitle:i}}])}(),function(){"use strict";COMPONENTS.factory("i18nDbService",["i18nService","objectService",function(a,b){function c(c){var d=a.getCurrentLanguage(),e=a.getDefaultLanguage();return c&&b.isObject(c)?c[d]||c[e]:{text:c}}function d(b){var c=a.getCurrentLanguage();return b&&void 0!==b[c]}function e(b){var c=b;return b={},b[a.getDefaultLanguage()]={text:c},b}return{getI18nProperty:c,hasI18nStructure:d,setInitI18nStructure:e}}])}(),function(){"use strict";var a=angular.forEach;COMPONENTS.factory("i18nService",["$rootScope","crudService","constantsService",function(b,c,d){function e(){return $.i18n.prop.apply($.i18n,arguments)}function f(a){var b=g();m=a.results,n=h(),o?e.changeLanguage(b):(p.language=b,$.i18n.properties(p))}function g(){var a,b=j();return a=i(b)?e.getDefaultLanguage():b}function h(){var b=[];return m.length&&a(m,function(a){a.inactive||b.push(a)}),b}function i(b){var c=!1;return m.length&&a(m,function(a){a.code!==b||c||(c=a.inactive)}),c}function j(){return(navigator.language||navigator.userLanguage).split("-")[0]}function k(){var b=null;return m.length&&a(m,function(a){a.inactive||b||(b=a.code)}),b}var l,m=[],n=[],o=!1,p={name:"messages",path:"/client/messages/",mode:"map",callback:function(){o=!0}};return e.loadLanguages=function(a){var e={sort:{field:"position",order:"1"}};c.get(d.collections.languages,null,e,function(c){f(c),b.$broadcast(d.collections.languages+"Loaded"),a&&a(m)})},e.updateLanguage=function(a,b){var f={inactive:a.inactive};c.update(d.collections.languages,a._id,f,function(a){e.loadLanguages(function(){b&&b(a)})})},e.getLanguages=function(a){return a?m:n},e.getCurrentLanguage=function(){return p.language},e.getDefaultLanguage=function(){return l||(l=k()),l},e.changeLanguage=function(a){var c;a===p.language||i(a)||(p.language=a,$.i18n.properties(p),c=a===e.getDefaultLanguage()?"":a,$.datepicker.setDefaults($.datepicker.regional[c]),b.$broadcast("languageChanged",a))},e}])}(),function(){"use strict";COMPONENTS.factory("colService",["$rootScope","rowService","arrayService",function(a,b,c){function d(a){for(var c=0;c<a.columns.length;c+=1)l(a.columns,c)&&d(a);1===a.columns.length&&(a.columns[0].size=b.getMaxSlots())}function e(a,b,d){c.add(a.columns,h(),d),c.add(a.columns,h(),d+2),b.size=b.size-=2}function f(a,d){var e,f=g(a,d);f&&(e=a[d].size+f.size,f.size=e+1),c.delete(a,d),c.delete(a,d),f||(a[0].size=b.getMaxSlots())}function g(a,b){var c;return c=j(a,b),c||(c=k(a,b)),c}function h(){return{size:1,apps:[]}}function i(a,b){return a.$$hashKey===b.$$hashKey}function j(a,b){var c,d;for(d=b+1;d<a.length;d+=1)if(a[d].size>=3){c=a[d];break}return c}function k(a,b){var c,d;for(d=b-1;d>=0;d-=1)if(a[d].size>=3){c=a[d];break}return c}function l(a,b){var d=a[b],e=a[b+1];return 0===d.apps.length&&d.size>1&&(d.size=1),e&&0===d.apps.length&&0===e.apps.length?(c.delete(a,b),!0):null}return{normalizeEmptyCols:d,addEmptyCols:e,deleteColAndDependencies:f,getAffectedCol:g,getEmptyCol:h,areSameCol:i}}])}(),function(){"use strict";COMPONENTS.factory("rowService",["arrayService",function(a){function b(){return l}function c(a,b,c){return c||1===a.columns.length||b.apps.length>1}function d(a){return 1===a.columns.length&&0===a.columns[0].apps.length}function e(a){return 1===a.columns.length&&1===a.columns[0].apps.length}function f(c,d){var e={columns:[{size:1,apps:[]},{size:b()-2,apps:[{type:"menuApp"}]},{size:1,apps:[]}]};a.add(c,e,d),g(c,d+1)}function g(b,c){a.add(b,h(),c)}function h(){return{columns:[{size:b(),apps:[]}]}}function i(b,c){b.length>1&&a.delete(b,c),b.length>1&&a.delete(b,c)}function j(a,b){return a.row.template?b:b[1].columns[0].rows}function k(a){return a.template}var l=25;return{getMaxSlots:b,isAvailableSpaceInRow:c,isOriginalRowEmpty:d,isDropRowEmpty:e,addRowAndDependencies:f,addEmptyRow:g,getEmptyRow:h,deleteRowAndDependencies:i,getWrappingRows:j,isTemplateRow:k}}])}(),function(){"use strict";COMPONENTS.factory("listDbService",["$injector","crudService","dbService","i18nService","stringService",function(a,b,c,d,e){function f(a,c){var d={q:{$and:[{$or:i(a.searchText,a.searchTargets)},{$or:j(a.tags)}]},currentPage:a.currentPage,pageSize:a.pageSize,skip:a.skip,sort:a.sort,projection:a.projection};b.get(a.collection,null,d,function(a){c&&c(a)})}function g(c,d){var f=a.get(c+"Service"),g="create"+e.capitalize(c);f[g]?f[g](d):b.create(c,d)}function h(a,c){b.delete(a,c,null)}function i(a,b){var e=[],f=d.getCurrentLanguage(),g=c.getInexactSelector(a);
return b.forEach(function(a){var b,c={},d={};c[a]=g,e.push(c),b=a+"."+f+".text",d[b]=g,e.push(d)}),e}function j(a){var b=[];return a&&a.forEach(function(a){b[b.length]={tag:a}}),b}return{loadList:f,createItem:g,deleteItem:h}}])}(),function(){"use strict";COMPONENTS.factory("listSelectService",["$rootScope","$location","listService","editBoxUtilsService","arrayService","stdService",function(a,b,c,d,e,f){function g(a,b,c,d,e,f){k(c),a.isSelectable()||a.isEditable()?l(a,b,c,f,e):n(a,c),m(a,c,d)}function h(b,c){k(c),b.isMultiSelectable()?(b.selectedIds||(b.selectedIds=[]),c.isSelected||b.selectedIds.push(c._id)):b.isSingleSelectable()&&(b.selectedIds=c._id,b.lastSelectedItem&&(b.lastSelectedItem.isSelected=!1)),b.lastSelectedItem=c,c.isSelected=!0,a.$$phase||b.$apply()}function i(b,c){k(c),b.isMultiSelectable()?c.isSelected&&j(b,c._id):b.isSingleSelectable()&&(b.selectedIds=null),c.isSelected=!1,a.$$phase||b.$apply()}function j(a,b){var c=o(a,b);void 0!==c&&e.delete(a.selectedIds,c)}function k(a){a._id||f.error("The matched element has to contain an _id attribute")}function l(a,b,c,e,f){c.isSelected?f&&d.isEditBoxClicked(f)||(a.unselect(c),a.isEditable()&&q()):(a.select(c),a.isEditable()&&e&&p(a,b,c))}function m(a,b){a.onSelect({$item:b})}function n(a,d){c.setDetailId(a,d._id),b.search("detailId",d._id)}function o(a,b){var c,d=null;if(a.selectedIds)for(c=0;c<a.selectedIds.length;c+=1)if(a.selectedIds[c]===b){d=c;break}return d}function p(a,b,c){var e=$("#"+c._id+" [edit-target]:visible:first",b);q(b),a.panels=a.onEditPanels,a.panels.forEach(function(a){a.bindings||(a.bindings={}),a.bindings.model=c}),a.onSave=function(){a.onEdit({$item:a.model})},a.onClose=function(){a.unselect(c)},d.showEditBox(a,e,e)}function q(a){var b,c;a&&(b=a.closest(".editBox"),c=$(".editBox",b).attr("id"),c&&d.hideEditBox(c))}return{clickOnItem:g,selectItem:h,unselectItem:i,dropFromSelectedList:j}}])}(),function(){"use strict";COMPONENTS.factory("listService",[function(){function a(a,b){return void 0!==b[a]?b[a]:c[a]}function b(a,b){a.detailId=b}var c={pageSize:10,skip:0,pageActionPos:2,searchable:!0,sort:{field:"create.date",order:"1"}};return{setDetailId:b,getDefaultValue:a}}])}(),function(){"use strict";COMPONENTS.factory("metaService",["$rootScope","pageService","mediaService","i18nDbService","timerService",function(a,b,c,d,e){function f(a,b){k(a),n(b)}function g(){o={width:$(window).width(),height:$(window).height()},$(window).resize(function(){($(this).width()!==o.width||$(this).height()!==o.height)&&(o={width:$(this).width(),height:$(this).height()},a.$broadcast("onWindowResized",o))})}function h(){return o}function i(a){if(a){var b,c,d=d||[];d.push(["_setAccount",a]),d.push(["_trackPageview"]),b=document.createElement("script"),b.type="text/javascript",b.async=!0,b.src=("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",c=document.getElementsByTagName("script")[0],c.parentNode.insertBefore(b,c)}}function j(){return"/client/images/favicon.ico"}function k(a){var c=b.getCurrentPage();document.title=d.getI18nProperty(c.text).text+" | "+a}function l(){var a=j();$("#favicon").attr("href",a)}function m(a){c.getMedia(a,null,function(a){var b=c.getDownloadUrl(a)+"?v="+e.getRandomNumber();$("#favicon").attr("href",b)})}function n(a){a?m(a):l()}var o;return{setHeader:f,setWindowDimensions:g,getWindowDimensions:h,getDefaultFaviconUrl:j,trackAnalytics:i}}])}(),function(a){"use strict";a.factory("pageService",["$rootScope","crudService","rowService","constantsService",function(a,b,c,d){function e(a){var c={sort:{field:"position",order:"1"}};b.get(d.collections.pages,null,c,function(b){p=b.results,a&&a(f())})}function f(){return p}function g(a){var b=null;return p.forEach(function(c){c.url.toLowerCase()!==a.toLowerCase()||b||(b=c)}),b}function h(c,f){b.create(d.collections.pages,c,function(){e(function(){a.$broadcast(d.collections.pages+"Changed","create"),f&&f()})},!0)}function i(c,f,g){b.update(d.collections.pages,c,f,function(b){e(function(){a.$broadcast(d.collections.pages+"Changed",c),g&&g(b)})},!0)}function j(a){var b=l();i(b._id,b,function(b){a&&a(b)})}function k(c,f){b.delete(d.collections.pages,c,function(){e(function(){a.$broadcast(d.collections.pages+"Changed",c),f&&f()})},!0)}function l(){return q}function m(a){q=a}function n(a,b){return a.parentPageId===b._id}function o(){return $("div.portal")}var p,q;return{loadPages:e,getPages:f,getPage:g,createPage:h,updatePage:i,updateCurrentPage:j,deletePage:k,getCurrentPage:l,setCurrentPage:m,isSubPageOf:n,getMainScrollingElm:o}}])}(window.COMPONENTS),function(){"use strict";COMPONENTS.factory("portalService",["$rootScope","$routeParams","pageService","crudService","constantsService","domService","metaService","userService","roleService","tagService","i18nService","availableAppsService","sessionService","stringService","timerService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){h.loadUsers(null),c.loadPages(null),i.loadRoles(function(){j.loadTags(null),k.loadLanguages(null),l.loadAvailableApps(null),m.loadUserSession(function(a){a&&a.language&&k.changeLanguage(a.language),q(b.page,function(){x(),g.setWindowDimensions(),y()})})})}function q(b,g){var h;h=$("body"),f.addLoadingFeedback(h),d.get(e.collections.portal,null,null,function(d){var e=c.getPage(b);f.removeLoadingFeedback(h),B=d.results[0],t(B,e.rows),c.setCurrentPage(e),a.$broadcast("portalLoaded"),g&&g(B)})}function r(){return B}function s(a,b){var c;c=angular.copy(B),delete c.user,t(c,[]),d.update(e.collections.portal,c._id,c,function(c){z(a),b&&b(c)})}function t(a,b){a.template.rows[1].columns[0].rows=b}function u(){return"real"===B.fullscreenMode}function v(){return"maximized"===B.fullscreenMode}function w(){return"template"===B.fullscreenMode}function x(){g.setHeader(B.title,B.faviconId)}function y(){g.trackAnalytics(B.trackingCode)}function z(b){a.$broadcast("onPortalSaved"),b&&A(),x()}function A(){var a="forceRefresh",b=o.getRandomNumber(),c=$("link");c.each(function(){var c=$(this).attr("href"),d=$(this).clone(),e=n.updateQueryStringParameter(c,a,b);d.attr("href",e),$(this).after(d)}),setTimeout(function(){c.remove()},3e3)}var B={};return{initializeResources:p,loadPortal:q,getPortal:r,updatePortal:s,updatePageDataFromTemplate:t,isRealFullscreen:u,isMaximizedFullscreen:v,isTemplateFullscreen:w,setHeader:x,trackAnalytics:y}}])}(),function(){"use strict";COMPONENTS.service("portalsAdminService",["dbService",function(a){function b(b){function c(){return[{title:"Create database",src:"portalsAdmin",view:"editDb",appBridge:!0,bindings:{model:j}}]}function d(){return[{title:"Edit database",src:"portalsAdmin",view:"editDb",appBridge:!0,bindings:{model:b.model}}]}function e(a){b.databases=a.results}function f(b){a.createDatabase(b,function(a){e(a)})}function g(b){a.updateDatabase(b._id,b)}function h(b){a.deleteDatabase(b,function(a){e(a)})}function i(){return'<div class="columns large-25"><h5>{{item.name}}</h5>Size on disk; {{item.sizeOnDisk}} - empty: {{item.empty}}</div>'}var j={};a.loadDatabases(function(a){e(a)}),b.config={multiSelectable:!0,creatable:!0,editable:!0,deletable:!0},b.onCreatePanels=c(),b.onEditPanels=d(),b.onCreate=function(){f(j)},b.onEdit=function(){g(b.onEditPanels[0].bindings.model)},b.onDelete=function(a){h(a)},b.template=i(),b.transcludedData={}}function c(){}function d(a){a.model&&(a.model.typedName=a.model.name)}return{view:b,createDb:c,editDb:d}}])}(),function(){"use strict";COMPONENTS.factory("rateService",["crudService","constantsService",function(a,b){function c(c,d,e,f){var g={rating:c,target:{id:d,collection:e}};a.rate(b.collections.ratings,g,function(a){f&&f(a)})}return{rate:c}}])}(),function(){"use strict";COMPONENTS.factory("roleService",["$rootScope","sessionService","crudService","constantsService","i18nService",function(a,b,c,d,e){function f(a){var b={sort:{field:"karma",order:"1"}};c.get(d.collections.roles,null,b,function(b){o(b.results),a&&a(g())})}function g(){return r}function h(a){return r[a]}function i(a){return a&&q?a.role>=q[d.roles.guest].karma:!1}function j(a){return a&&q?a.role>=q[d.roles.reader].karma:!1}function k(a){return a&&q?a.role>=q[d.roles.creator].karma:!1}function l(a){return a&&q&&a?a.role>=q[d.roles.admin].karma:!1}function m(a){return a&&q&&a?a.role>=q[d.roles.superAdmin].karma:!1}function n(){return l(b.getUserSession())?"adminAccess":""}function o(a){q=[],r=[],a.forEach(function(a){var b={code:a.code,karma:a.karma,title:e("role."+a.code),description:e("role."+a.code+".description")};q[a.code]=b,r.push(b)})}function p(){r.forEach(function(a,b){var c=e("role."+a.code),d=e("role."+a.code+".description"),f=q[a.code],g=r[b];f.title=c,g.title=c,f.description=d,g.description=d})}var q,r;return a.$on("languageChanged",function(){p()}),{loadRoles:f,getRoles:g,getRole:h,hasGuestRole:i,hasReaderRole:j,hasCreatorRole:k,hasAdminRole:l,hasSuperAdminRole:m,getCurrentUserAdminAccessStyleClass:n}}])}(),function(){"use strict";COMPONENTS.factory("sessionService",["$rootScope","$routeParams","ajaxService","objectService",function(a,b,c,d){function e(a){c.ajax({url:"rest/getSession/",method:"POST",data:{},success:function(b){j(b),a&&a(f())}})}function f(){return k}function g(a){a.create.author=f(),delete a.create.authorId}function h(){var a=f();return!d.isEmpty(a)}function i(){window.open("logout","_self")}function j(a){k=a?a:null}var k;return{loadUserSession:e,getUserSession:f,addSessionDataToModel:g,isUserLogged:h,logout:i}}])}(),function(){"use strict";COMPONENTS.factory("statsService",["crudService",function(a){function b(b,c,d){a.getStats(b,c,function(a){d&&d(a)})}return{loadStats:b}}])}(),function(){"use strict";COMPONENTS.factory("tagService",["crudService","constantsService",function(a,b){function c(c){a.get(b.collections.tags,null,{},function(a){g=a.results,c&&c(f())})}function d(c,d){a.create(b.collections.tags,{text:c},function(a){d&&d(a)})}function e(c,d){var e={text:c.text};a.update(b.collections.tags,c._id,e,function(a){d&&d(a)})}function f(){return g}var g;return{loadTags:c,createTag:d,getTags:f,updateTag:e}}])}(),function(){"use strict";COMPONENTS.factory("undeployService",["crudService",function(a){function b(b,c){a.undeployApp(b._id,b,function(){c&&c()})}return{undeploy:b}}])}(),function(a){"use strict";a.factory("userService",["sessionService","crudService","$routeParams","constantsService",function(a,b,c,d){function e(a){var c={projection:{password:0}};b.get(d.collections.users,null,c,function(b){i=b.results,a&&a(f())})}function f(){return i}function g(a,c){var e;a.fullName||a.email||a.password?(e={fullName:a.fullName,email:a.email,password:a.password,role:a.role,language:a.language,tags:a.tags,birthDate:a.birthDate},e.mediaId=a.media&&a.media._id?a.media._id:null,b.create(d.collections.users,e,function(a){c&&c(a)})):c&&c({})}function h(a,c){var e;a.fullName||a.email||a.password?(e={fullName:a.fullName,email:a.email,role:a.role,language:a.language,tags:a.tags,birthDate:a.birthDate},e.mediaId=a.media&&a.media._id?a.media._id:null,a.password&&(e.password=a.password),b.update(d.collections.users,a._id,e,function(a){c&&c(a)})):c&&c({})}var i;return{loadUsers:e,getUsers:f,createUser:g,updateUser:h}}])}(window.COMPONENTS),function(a){"use strict";COMPONENTS.factory("arrayService",[function(){function b(b){return b instanceof a}function c(a,b,c){return a.splice(c,0,b),a}function d(a,b,c){var d,e=[];for(b=b||0,c=c||a.length,d=b;b+c>d;d+=1)e.push(a[d]);return e}function e(a,b,c){if(c>=a.length)for(var d=c-a.length;(d-=1)+1;)a.push(void 0);return a.splice(c,0,a.splice(b,1)[0]),a}function f(a,b){return a.splice(b,1),a}return{isArray:b,add:c,copy:d,move:e,"delete":f}}])}(window.Array),function(){"use strict";COMPONENTS.factory("caretService",["timerService",function(a){function b(b,d,e){var f=a.getRandomNumber(),g=e?'ng-click="'+e+"("+f+")":"";return c('<img id="'+f+'" src="'+b+'" '+g+'"/>',d),f}function c(a,b){b.focus(),d(a,!1)}function d(a,b){var c,d;if(window.getSelection){if(c=window.getSelection(),c.getRangeAt&&c.rangeCount){d=c.getRangeAt(0),d.deleteContents();var e=document.createElement("div");e.innerHTML=a;for(var f,g,h=document.createDocumentFragment();f=e.firstChild;)g=h.appendChild(f);var i=h.firstChild;d.insertNode(h),g&&(d=d.cloneRange(),d.setStartAfter(g),b?d.setStartBefore(i):d.collapse(!0),c.removeAllRanges(),c.addRange(d))}}else if((c=document.selection)&&"Control"!=c.type){var j=c.createRange();j.collapse(!0),c.createRange().pasteHTML(a),d=c.createRange(),d.setEndPoint("StartToStart",j),d.select()}}return{insertImage:b}}])}(),function(a){"use strict";a.factory("dateService",[function(){function a(a){function b(a){return("0"+a).slice(-2)}var c,d,e,f;return c=new Date(a),d=b(c.getDate()),e=b(c.getMonth()+1),f=c.getFullYear(),d+"-"+e+"-"+f}return{getFormattedDate:a}}])}(window.COMPONENTS),function(){"use strict";COMPONENTS.factory("domService",["pageService",function(a){function b(b){return{top:b.offset().top+a.getMainScrollingElm().scrollTop(),left:b.offset().left,width:b.outerWidth(),height:b.outerHeight()}}function c(a){return{top:parseInt(a.css("paddingTop"),10),right:parseInt(a.css("paddingRight"),10),bottom:parseInt(a.css("paddingBottom"),10),left:parseInt(a.css("paddingLeft"),10)}}function d(a){return{top:parseInt(a.css("borderTopWidth"),10),right:parseInt(a.css("borderRightWidth"),10),bottom:parseInt(a.css("borderBottomWidth"),10),left:parseInt(a.css("borderLeftWidth"),10)}}function e(a){return a[0].tagName.toLowerCase()}function f(a,b){return a instanceof jQuery||(a=$(a)),Math.round(100*parseInt(a.css(b),10)/$("html").width())}function g(a){a.addClass("loading")}function h(a){a.removeClass("loading")}function i(a){return $("<div>").append(a.clone()).html()}return{getCoordinates:b,getObjPadding:c,getObjBorderWidth:d,getElementType:e,getDomPercent:f,addLoadingFeedback:g,removeLoadingFeedback:h,convertDomObjToStr:i}}])}(),function(){"use strict";COMPONENTS.factory("editBoxUtilsService",["$compile","pageService","domService",function(a,b,c){function d(d,e,f){function g(){e.parent().css("position","relative"),d.target={id:d.$id,element:e,coordinates:f?c.getCoordinates(f):c.getCoordinates(e)}}function k(){function a(){return f.offset().left+d.target.coordinates.width/2<$(window).width()/2}d.arrowPos=a()?"left":"right"}function m(){d.model||(d.model={});var c;return c=$('<edit-box panels="panels" arrow-pos="arrowPos" on-save="onSave()" on-change="onChange()" on-cancel="onCancel()" on-close="onClose()" target="target"></edit-box>'),b.getMainScrollingElm().append(c),a(c)(d),c}function o(){setTimeout(function(){n||i()},100)}var p;l(e)||(g(),k(),h(),p=m(),o(),j(p))}function e(a){var b;m||(b=a?$("#"+a):$(".editBox").remove(),k(b),b.remove())}function f(){return $(".editBox").size()>0}function g(a){return $(a.target).closest(".editBox").size()>0}function h(){m=!0}function i(){m=!1}function j(a){var c=b.getMainScrollingElm()[0].scrollHeight;a.before('<div class="overlay" style="height:'+c+'"></div>')}function k(a){a.prev(".overlay").remove()}function l(a){return a.next(".editBox").size()>0}var m=!1,n=!1;return{showEditBox:d,hideEditBox:e,isAnyEditBoxVisible:f,isEditBoxClicked:g,blockHideEditBox:h,unblockHideEditBox:i}}])}(),function(a){"use strict";COMPONENTS.factory("keyboardService",["arrayService","stringService","constantsService",function(b,c,d){function e(a,c,d){function e(a,b,c){var d=i(a);j[d]||(j[d]=[]),j[d].push({fn:c,source:b}),g(d,c)}b.isArray(a)?a.forEach(function(a){e(a,c,d)}):e(a,c,d)}function f(a,c){function d(a,c){var d=i(a),e=j[d];e&&e[e.length-1]&&c===e[e.length-1].source&&(b.delete(e,e.length-1),h(d))}b.isArray(a)?a.forEach(function(a){d(a,c)}):d(a,c)}function g(b,c){var e=function(){return k||(c(),k=!0,setTimeout(function(){k=!1},d.keyboardInterval)),!1};a.bind(b,e)}function h(b){var c=j[b];a.unbind(b),c.length&&g(b,c[c.length-1].fn)}function i(a){return c.replaceToken(a," ","")}var j=[],k=!1;return{register:e,unregister:f}}])}(window.Mousetrap),function(){"use strict";COMPONENTS.factory("mediaService",["crudService","objectService","constantsService",function(a,b,c){function d(a,b){var c=0;a.forEach(function(d){d.tags=a.tags,e(d,function(d){c+=1,b&&c===a.length&&b(d)})})}function e(b,d){var e;b?(e={name:b.name,tags:b.tags},a.update(c.collections.media,b._id,e,function(a){d&&d(a)})):d&&d({})}function f(b,d,e){d||(d={}),d.projection={data:0},a.get(c.collections.media,b,d,function(a){e&&e(a)})}function g(a){return b.isObject(a)?a&&a._id?"media/"+a._id+"/"+a.name:null:"media/"+a}function h(a){function b(a){function b(a){return Math.floor(10*a)/10}var c,d=1073741824,e=1048576,f=1024;return c=a>d?b(a/d)+" GB":a>e?b(a/e)+" MB":a>f?b(a/f)+" KB":a+" bytes"}if(a&&a._id){var c=g(a),d=b(a.size),e=a.width+"x"+a.height;return'<a href="'+c+'" target="_blank">'+a.name+"</a><br/>("+e+", "+d+")"}}function i(){return"/client/images/user.svg"}return{createMedia:d,updateMedia:e,getMedia:f,getDownloadUrl:g,getMediaHtmlDetails:h,getDefaultAvatarUrl:i}}])}(),function(){"use strict";COMPONENTS.factory("objectService",[function(){function a(a){return"object"==typeof a}function b(a){var b=Object.prototype.hasOwnProperty;if(null===a||void 0===a)return!0;if(a.length&&a.length>0)return!1;if(0===a.length)return!0;for(var c in a)if(b.call(a,c))return!1;return!0}function c(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}return{isObject:a,isEmpty:b,getRootKeys:c}}])}(),function(){"use strict";COMPONENTS.factory("stringService",[function(){function a(a,b,c,d){var e=new RegExp(b,"g");return d&&(a=j(a)),a?a.replace(e,c):""}function b(a){return a.charAt(0).toUpperCase()+a.slice(1)}function c(a){return a.charAt(0).toLowerCase()+a.slice(1)}function d(a){return a.replace(/[A-Z]/g,function(a,b){return(b?"-":"")+a.toLowerCase()})}function e(a){return a.replace(/([\:\-\_]+(.))/g,function(a,b,c,d){return d?c.toUpperCase():c}).replace(/^moz([A-Z])/,"Moz$1")}function f(a){return $.trim(a)}function g(a){var b=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,c=new RegExp(b);return a?null!==a.match(c):!1}function h(a){return a.indexOf("http://")<0?"http://"+a:a}function i(a,b,c){var d=new RegExp("([?|&])"+b+"=.*?(&|$)","i"),e=-1!==a.indexOf("?")?"&":"?";return a.match(d)?a.replace(d,"$1"+b+"="+c+"$2"):a+e+b+"="+c}function j(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}return{replaceToken:a,capitalize:b,decapitalize:c,toSnakeCase:d,toCamelCase:e,trim:f,isExternalUrl:g,normalizeExternalUrl:h,updateQueryStringParameter:i}}])}(),function(){"use strict";COMPONENTS.factory("styleService",["mediaService","stringService",function(a,b){function c(a,b){var c;b||(b={});for(c in a)a.hasOwnProperty(c)&&g(a,c,b);return b}function d(a,c){for(var d,e,f,g,h,i,j,k=[],l={};c[0]!==a[0];){if(d={},void 0!==c.attr("style")){e=c.attr("style").split(";");for(f in e)e.hasOwnProperty(f)&&(g=e[f].split(":"),""!==g[0]&&void 0!==g[0]&&(i=b.trim(b.toCamelCase(g[0])),j=b.trim(g[1]),d[i]=j));k.unshift(d)}c=c.parent()}for(h in k)k.hasOwnProperty(h)&&(l=$.extend(!0,l,k[h]));return l}function e(a){var c=a.indexOf("(")+1,d=a.indexOf(")")-a.indexOf("(")-1,e=a.substr(c,d).split(",");return 3===e.length?{r:Number(b.trim(e[0])),g:Number(b.trim(e[1])),b:Number(b.trim(e[2]))}:null}function f(a){function b(a){var b=a.toString(16);return 1===b.length?"0"+b:b}return("#"+b(a.r)+b(a.g)+b(a.b)).toUpperCase()}function g(a,b,c){var d=a[b];"background"===b?i(d,c):"borders"===b?j(d,c):"cssVars"!==b&&h(d,b,c)}function h(a,b,c){(a||k(a))&&(c[b]=a)}function i(b,c){var d=a.getDownloadUrl(b.src);b.color&&(c.backgroundColor=b.color),b.src&&(c.backgroundImage='url("'+d+'")',c.backgroundRepeat=b.mosaic?"":"no-repeat",b.position&&(c.backgroundPosition=b.position.top+" "+b.position.left))}function j(a,b){a.color&&(b.borderColor=a.color),a.style&&(b.borderStyle=a.style),k(a.width)&&(b.borderWidth=a.width)}function k(a){return!isNaN(parseFloat(a))&&isFinite(a)}return{getNormalizedStyles:c,getComputedStyleInRange:d,rgbStrToRgbObj:e,rgbObjToHexStr:f}}])}(),function(){"use strict";COMPONENTS.factory("textSelectionService",[function(){function a(){p=q.saveSelection()}function b(){var a=c();a.attr("fakeSelection","true")}function c(){q.init();var a="rangyTemp_"+ +new Date,b=q.createCssClassApplier(a,!0);return b.applyToSelection(),$("."+a).removeClass(a)}function d(){var a=q.getSelection();return a._ranges.length>0&&a._ranges[0].startOffset!=a._ranges[0].endOffset}function e(){return $("[fakeSelection]").size()>0}function f(a){var b=c();b.css(a)}function g(){p&&q.restoreSelection(p),a()}function h(a){o("a",r.link,a)}function i(a){o("div",r.heading,{id:a})}function j(){return n(r.heading)}function k(){return c().closest("."+r.link)}function l(){return n(r.link)}function m(){var a=q.getSelection();if(d()||e()){a.removeAllRanges();var b=$("[fakeSelection]");""===b.attr("style")?b.replaceWith(b.html()):b.removeAttr("fakeSelection")}}function n(a){return c().closest("."+a).attr("id")}function o(a,b,d){g();var e=c().closest("."+b),f=e.length>0;if(f)e.attr(d);else{var h=q.createCssClassApplier(b,{elementTagName:a,elementProperties:d});h.applyToSelection()}g()}var p=!1,q=rangy,r={link:"link",heading:"heading"};return{saveSelection:a,setFakeSelection:b,getSelectedTextDomObj:c,isSelection:d,isFakeSelection:e,setStylesToSelection:f,restoreSelection:g,removeSelection:m,setLink:h,setHeading:i,getSelectedLink:k,getSelectedHeadingId:j,getSelectedLinkId:l}}])}(),function(a){"use strict";COMPONENTS.factory("timerService",[function(){function b(b,c,d){return a(b),b=setInterval(c,d)}function c(){var a=new Date;return a.getTime()}return{updateInterval:b,getRandomNumber:c}}])}(window.clearInterval),function(a){"use strict";COMPONENTS.factory("validationService",[function(){function b(a){function b(a){return a.$pristine||a.$dirty&&a.$valid}var c=!0;return $.isArray(a)?a.forEach(function(a){c*=b(a)}):c=b(a),c}function c(a){$(".ng-invalid[ng-model]:first",a).focus().addClass("forceMessage")}function d(b,c,d,e,f,g,h){function i(a,b,c){a.data("decorated")||(a.wrap('<div class="positionRelative"></div>'),a.after('<div class="input-help"></div>'),k(a,b,c)),a.data("decorated",!0)}function j(a,b,c){k(a,b,c)}function k(a,b,c){var d,e=a.next(".input-help");e.empty(),e.prepend('<div class="title">'+b+"</div>"),c&&(d=$('<div class="details"></div>'),e.append(d),d.html(c))}i(c,e,f),d.$setValidity(g,h(b));var l=function(b){return h(b)?(d.$setValidity(g,!0),b):(d.$setValidity(g,!1),j(c,e,f),a)};d.$formatters.push(l),d.$parsers.unshift(l)}return{isFormValid:b,setFocusOnFirstError:c,setupValidation:d}}])}(window.undefined),function(a,b){"use strict";b.module("errorModule",["components"]).config(["$httpProvider","$provide",function(a,b){b.provider("$exceptionHandler",function(){this.$get=["stdService",function(a){return function(b){a.error(b.message,b.stack)}}]}),b.factory("customHttpErrorInterceptor",["stdService","globalMsgService",function(a){function b(a){return a}function c(b){a.error(b.data)}return function(a){return a.then(b,c)}}]),a.responseInterceptors.push("customHttpErrorInterceptor")}])}(window,window.angular),angular.module("templates-main",["bannerAppEdit.html","bannerAppHelp.html","bannerAppView.html","contentListAppAdd.html","contentListAppEdit.html","contentListAppHelp.html","contentListAppView.html","iframeAppEdit.html","iframeAppHelp.html","iframeAppView.html","imageAppEdit.html","imageAppHelp.html","imageAppView.html","languageSelectAppEdit.html","languageSelectAppHelp.html","languageSelectAppView.html","linksAppEdit.html","linksAppHelp.html","linksAppView.html","loginAppEdit.html","loginAppHelp.html","loginAppView.html","mapAppEdit.html","mapAppHelp.html","mapAppView.html","mediaCarouselAppEdit.html","mediaCarouselAppHelp.html","mediaCarouselAppSelectMedia.html","mediaCarouselAppView.html","mediaListAppAdd.html","mediaListAppEdit.html","mediaListAppHelp.html","mediaListAppView.html","menuAppEdit.html","menuAppHelp.html","menuAppView.html","portalsAdminAppHelp.html","portalsAdminAppView.html","example.html","slidesAppCreateSlide.html","slidesAppEdit.html","slidesAppEditSlide.html","slidesAppHelp.html","slidesAppView.html","socialAppEdit.html","socialAppHelp.html","socialAppView.html","staticContentAppAdd.html","staticContentAppEdit.html","staticContentAppHelp.html","staticContentAppSelectContent.html","staticContentAppView.html","userListAppAdd.html","userListAppEdit.html","userListAppHelp.html","userListAppView.html","videoAppEdit.html","videoAppHelp.html","videoAppView.html","webGlAppEdit.html","webGlAppHelp.html","webGlAppView.html","addAppPanel.html","adminPanel.html","createMedia.html","edit.html","editAppGeneral.html","editAppStyles.html","editBox.html","editContent.html","editContentList.html","editCurrentUser.html","editGeneral.html","editLanguage.html","editMedia.html","editMediaList.html","editNotifications.html","editPages.html","editStyles.html","editTag.html","editTagList.html","editUser.html","editUserList.html","portalsAdminEditDb.html","portalsAdminView.html","stats.html","styles.html","app.html","appHeader.html","bannerCanvas.html","bannerItem.html","bannerTextEditText.html","comment.html","comments.html","contentEditable.html","richContent.html","selectMedia.html","background.html","borders.html","fileUploader.html","password.html","rating.html","contentList.html","languagesList.html","list.html","listDb.html","mediaList.html","tagList.html","userList.html","login.html","mediaPicker.html","pages.html","errorPage.html","loginPage.html","portalPage.html","listActions.html","listEdit.html"]),angular.module("bannerAppEdit.html",[]).run(["$templateCache",function(a){a.put("bannerAppEdit.html",'<div>\n    <div class="large-10">Height (px):</div>\n    <div class="large-15"><input type="text" ng-model="model.height" /></div>\n    <div class="large-10">Grid size (px):</div>\n    <div class="large-15">\n        <select ng-model="model.gridSize" ng-options="gridSize for gridSize in gridSizes"></select>\n    </div>\n</div>')}]),angular.module("bannerAppHelp.html",[]).run(["$templateCache",function(a){a.put("bannerAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("bannerAppView.html",[]).run(["$templateCache",function(a){a.put("bannerAppView.html",'<div>\n    <div banner-canvas ng-model="model.items" height="model.height" grid-size="model.gridSize"\n         on-change="onModelChange()"></div>\n</div>')}]),angular.module("contentListAppAdd.html",[]).run(["$templateCache",function(a){a.put("contentListAppAdd.html",'<div>\n    <div create-content model="content"></div>\n</div>')}]),angular.module("contentListAppEdit.html",[]).run(["$templateCache",function(a){a.put("contentListAppEdit.html","<div list-edit></div>")}]),angular.module("contentListAppHelp.html",[]).run(["$templateCache",function(a){a.put("contentListAppHelp.html","<b>This is</b>The HELP! page of CONTENT LIST :)")}]),angular.module("contentListAppView.html",[]).run(["$templateCache",function(a){a.put("contentListAppView.html",'<div>\n    <content-list id="_id" config="model"></content-list>\n</div>')}]),angular.module("iframeAppEdit.html",[]).run(["$templateCache",function(a){a.put("iframeAppEdit.html",'<div>\n    <div>URL: <input type="text" ng-model="internalData.url"></textarea></div>\n    <div>Height: <input type="text" ng-model="internalData.height"></textarea></div>\n</div>')}]),angular.module("iframeAppHelp.html",[]).run(["$templateCache",function(a){a.put("iframeAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("iframeAppView.html",[]).run(["$templateCache",function(a){a.put("iframeAppView.html",'<div>\n    <iframe width="100%" ng-show="model.url" height="{{model.height}}" src="{{model.url}}" frameborder="0"\n            allowfullscreen></iframe>\n    <div ng-show="!model.url"><i>There isn\'t any content to show</i></div>\n</div>')}]),angular.module("imageAppEdit.html",[]).run(["$templateCache",function(a){a.put("imageAppEdit.html",'<div>\n    <media-list config="config" on-select="onSelect($item)"></media-list>\n</div>')}]),angular.module("imageAppHelp.html",[]).run(["$templateCache",function(a){a.put("imageAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("imageAppView.html",[]).run(["$templateCache",function(a){a.put("imageAppView.html",'<div>\n    <img ux-show="model.mediaId" ng-src="{{getDownloadUrl()}}" title="{{getMediaTitle()}}" />\n    <div ux-show="!model.mediaId"><em>Please select an image from the gallery</em></div>\n</div>')}]),angular.module("languageSelectAppEdit.html",[]).run(["$templateCache",function(a){a.put("languageSelectAppEdit.html","<div>\n    Hello edit!\n</div>")}]),angular.module("languageSelectAppHelp.html",[]).run(["$templateCache",function(a){a.put("languageSelectAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("languageSelectAppView.html",[]).run(["$templateCache",function(a){a.put("languageSelectAppView.html",'<div>\n    <div ng-repeat="language in languages" class="flag {{language.code}}" ng-click="selectLanguage(language.code)"\n         ng-class="{current: isCurrentLanguage(language.code)}" title="{{language.text}}">\n        <img ng-src="/client/images/flags/{{language.code}}.svg" />\n     </div>\n</div>')}]),angular.module("linksAppEdit.html",[]).run(["$templateCache",function(a){a.put("linksAppEdit.html",'<div><h6>Text</h6></div>\n<div><h6>URL<h6></div>\n<ul sortable="model.links">\n	<li ng-repeat="link in model.links" class="cf">\n		<div><input type="text" ng-model="link.text"/></div>\n		<div><input type="text" ng-model="link.url"/></div>\n		<div><button class="removeIcon" ng-click="removeItemFromModel($index, model.links)">Remove</button></div>\n	</li>\n</ul>\n<div class="actions">\n	<button class="addIcon" ng-click="addItemToModel(model.links)">+</button>\n</div>\n')}]),angular.module("linksAppHelp.html",[]).run(["$templateCache",function(a){a.put("linksAppHelp.html","<b>This is</b>The HELP! page :) of the Links app\n<ul>\n	<li>V1</li>\n	<li>V2</li>\n	<li>V3</li>\n</ul>")}]),angular.module("linksAppView.html",[]).run(["$templateCache",function(a){a.put("linksAppView.html",'<div>\n    <div ng-repeat="link in model.links"><a href="{{link.url}}" target="_blank">{{link.text}}</a></div>\n</div>\n')}]),angular.module("loginAppEdit.html",[]).run(["$templateCache",function(a){a.put("loginAppEdit.html",'Video ID:\n<input type="text" ng-model="model.videoId"></textarea>\nHeight:\n<input type="text" ng-model="model.height"></textarea>\n')}]),angular.module("loginAppHelp.html",[]).run(["$templateCache",function(a){a.put("loginAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("loginAppView.html",[]).run(["$templateCache",function(a){a.put("loginAppView.html","<div>\n    <login></login>\n</div>")}]),angular.module("mapAppEdit.html",[]).run(["$templateCache",function(a){a.put("mapAppEdit.html",'<div>\n    Height:\n    <input type="text" ng-model="model.height"></textarea>\n    Map URL:\n    <input type="text" ng-model="model.url"></textarea>\n</div>\n')}]),angular.module("mapAppHelp.html",[]).run(["$templateCache",function(a){a.put("mapAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("mapAppView.html",[]).run(["$templateCache",function(a){a.put("mapAppView.html",'<iframe width="100%" height="{{model.height}}" frameborder="0" scrolling="no" marginheight="0"\n        marginwidth="0" src="{{model.url}}&amp;output=embed"></iframe>\n')}]),angular.module("mediaCarouselAppEdit.html",[]).run(["$templateCache",function(a){a.put("mediaCarouselAppEdit.html",'<div>\n     <label>Time between slides (milliseconds):<input type="text" ng-model="model.timer"/></label>\n    <label>\n        Legend pos:\n        <select ng-model="model.navigationPos" ng-options="obj.value as obj.text for obj in navigationPos"></select>\n    </label>\n</div>')}]),angular.module("mediaCarouselAppHelp.html",[]).run(["$templateCache",function(a){a.put("mediaCarouselAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("mediaCarouselAppSelectMedia.html",[]).run(["$templateCache",function(a){a.put("mediaCarouselAppSelectMedia.html",'<div>\n    <div edit-media-list selected="model.selectedMedia"></div>\n</div>')
}]),angular.module("mediaCarouselAppView.html",[]).run(["$templateCache",function(a){a.put("mediaCarouselAppView.html",'<div>\n    <div class="navigationContainer {{model.navigationPos}}">\n        <div class="navigatorOverlay"></div>\n        <div class="navigator cf" ng-style="setNavigatorCenterPos()">\n            <img class="mediaThumbnail" ng-repeat="media in internalData.mediaList" ng-click="internalData.goToMedia($index)"\n                 ng-class="getMediaThumbnailSelectedClass($index)" ng-src="{{getDownloadUrl($index)}}" />\n        </div>\n    </div>\n    <img ng-src="{{getDownloadUrl(internalData.currentMediaIndex)}}" />\n</div>')}]),angular.module("mediaListAppAdd.html",[]).run(["$templateCache",function(a){a.put("mediaListAppAdd.html",'<div>\n    <div create-media model="media"></div>\n</div>')}]),angular.module("mediaListAppEdit.html",[]).run(["$templateCache",function(a){a.put("mediaListAppEdit.html","<div list-edit></div>")}]),angular.module("mediaListAppHelp.html",[]).run(["$templateCache",function(a){a.put("mediaListAppHelp.html","<b>This is</b>The HELP! page of CONTENT LIST :)")}]),angular.module("mediaListAppView.html",[]).run(["$templateCache",function(a){a.put("mediaListAppView.html",'<div>\n    <media-list config="model"></media-list>\n</div>')}]),angular.module("menuAppEdit.html",[]).run(["$templateCache",function(a){a.put("menuAppEdit.html",'<!--<div><h6>Text</h6></div>\n<div><h6>Page<h6></div>\n<div><h6>Layout<h6></div>\n<ul sortable=model.pages">\n	<li ng-repeat="page in edit.portal.pages" class="cf page">\n		<div><input type="text" ng-model="page.text"></div>\n		<div><input type="text" ng-model="page.page"/></div>\n		<div class="actions">\n			<button class="changeLayout">L</button>\n			<button class="remove" ng-click="removeItemFromModel($index, edit.portal.pages)"></button>\n		</div>\n	</li>\n</ul>\n<div class="actions">\n	<button class="add" ng-click="addItemToModel(edit.portal.pages)">+</button>\n</div>-->\n')}]),angular.module("menuAppHelp.html",[]).run(["$templateCache",function(a){a.put("menuAppHelp.html","<b>This is</b>The HELP! page :) <h6>of the Menu app</h6>\n<ul>\n	<li>V4</li>\n	<li>V5</li>\n	<li>V6</li>\n</ul>")}]),angular.module("menuAppView.html",[]).run(["$templateCache",function(a){a.put("menuAppView.html",'<div>\n    <ul class="pagesMenu">\n        <li ng-repeat="page in pages" class="page" ng-class="getPageStyleClass(page)" ng-show="!page.parentPageId && !page.invisible">\n            <h6>\n                <a href="{{getPageUrl(page)}}" target="{{getPageTarget(page)}}" title="{{page.description}}" i18n-db-title>\n                    <button class="toggleSubPages downIcon small" ng-show="hasSubPages(page)"></button>\n                    <label i18n-db="page.text"></label>\n                </a>\n            </h6>\n            <div class="subPagesMenuContainer">\n                <ul class="subPagesMenu" ng-show="page.hasSubPages">\n                    <li ng-repeat="subPage in pages" class="page" ng-class="getPageStyleClass(subPage)"\n                        ux-show="isSubPageOf(subPage, page) && !subPage.invisible">\n                        <h6>\n                            <a href="{{getPageUrl(subPage)}}" target="{{getPageTarget(subPage)}}" title="{{subPage.description}}" i18n-db-title>\n                                <label i18n-db="subPage.text"></label>\n                            </a>\n                        </h6>\n                    </li>\n                </ul>\n            </div>\n        </li>\n    </ul>\n</div>')}]),angular.module("portalsAdminAppHelp.html",[]).run(["$templateCache",function(a){a.put("portalsAdminAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("portalsAdminAppView.html",[]).run(["$templateCache",function(a){a.put("portalsAdminAppView.html",'<div>\n    <div app-bridge src="portalsAdmin" view="view"></div>\n</div>')}]),angular.module("example.html",[]).run(["$templateCache",function(a){a.put("example.html",'<!doctype html>\n<html lang="en">\n\n	<head>\n		<meta charset="utf-8">\n\n		<title>reveal.js - Markdown Demo</title>\n\n		<link rel="stylesheet" href="../../css/reveal.css">\n		<link rel="stylesheet" href="../../css/theme/default.css" id="theme">\n	</head>\n\n	<body>\n\n		<div class="reveal">\n\n			<div class="slides">\n\n                <!-- Use external markdown resource, separate slides by three newlines; vertical slides by two newlines -->\n                <section data-markdown="example.md" data-separator="^\\n\\n\\n" data-vertical="^\\n\\n"></section>\n\n                <!-- Slides are separated by three dashes (quick \'n dirty regular expression) -->\n                <section data-markdown data-separator="---">\n                    <script type="text/template">\n                        ## Demo 1\n                        Slide 1\n                        ---\n                        ## Demo 1\n                        Slide 2\n                        ---\n                        ## Demo 1\n                        Slide 3\n                    </script>\n                </section>\n\n                <!-- Slides are separated by newline + three dashes + newline, vertical slides identical but two dashes -->\n                <section data-markdown data-separator="^\\n---\\n$" data-vertical="^\\n--\\n$">\n                    <script type="text/template">\n                        ## Demo 2\n                        Slide 1.1\n\n                        --\n\n                        ## Demo 2\n                        Slide 1.2\n\n                        ---\n\n                        ## Demo 2\n                        Slide 2\n                    </script>\n                </section>\n\n                <!-- No "extra" slides, since there are no separators defined (so they\'ll become horizontal rulers) -->\n                <section data-markdown>\n                    <script type="text/template">\n                        A\n\n                        ---\n\n                        B\n\n                        ---\n\n                        C\n                    </script>\n                </section>\n\n            </div>\n		</div>\n\n		<script src="../../lib/js/head.min.js"></script>\n		<script src="../../js/reveal.js"></script>\n\n		<script>\n\n			Reveal.initialize({\n				controls: true,\n				progress: true,\n				history: true,\n				center: true,\n\n				theme: Reveal.getQueryHash().theme,\n				transition: Reveal.getQueryHash().transition || \'default\',\n\n				// Optional libraries used to extend on reveal.js\n				dependencies: [\n					{ src: \'../../lib/js/classList.js\', condition: function() { return !document.body.classList; } },\n'+"					{ src: 'marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },\n                    { src: 'markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },\n					{ src: '../notes/notes.js' }\n				]\n			});\n\n		</script>\n\n	</body>\n</html>\n")}]),angular.module("slidesAppCreateSlide.html",[]).run(["$templateCache",function(a){a.put("slidesAppCreateSlide.html",'<div>\n    Create: <div content-editable ng-model="model.content" i18n-db-input></div>\n</div>')}]),angular.module("slidesAppEdit.html",[]).run(["$templateCache",function(a){a.put("slidesAppEdit.html",'<div>\n    <div list="model.slides" config="config" transcluded-data="transcludedData"\n         on-create-panels="onCreatePanels" on-edit-panels="onEditPanels"\n         template="template" on-create="onCreate()" on-delete="onDelete($id)"></div>\n</div>')}]),angular.module("slidesAppEditSlide.html",[]).run(["$templateCache",function(a){a.put("slidesAppEditSlide.html",'<div>\n    <div content-editable ng-model="model.content" i18n-db-input></div>\n</div>')}]),angular.module("slidesAppHelp.html",[]).run(["$templateCache",function(a){a.put("slidesAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("slidesAppView.html",[]).run(["$templateCache",function(a){a.put("slidesAppView.html",'<div>\n    <div class="reveal">\n        <div class="slides">\n            <section ng-repeat="slide in model.slides" ng-show="show" class="slide">\n                <label i18n-db="slide.content"></label>\n            </section>\n        </div>\n    </div>\n</div>')}]),angular.module("socialAppEdit.html",[]).run(["$templateCache",function(a){a.put("socialAppEdit.html",'<div>\n    <div>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.show.email" label="Show e-mail?"/>\n        </div>\n        <div class="columns large-25">\n            <input type="text" ng-model="model.email" ng-show="model.show.email" />\n        </div>\n    </div>\n    <div>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.show.facebook" label="Show Facebook?"/></div>\n        <div class="columns large-25">\n            <input type="text" ng-model="model.facebook" ng-show="model.show.facebook" />\n        </div>\n    </div>\n    <div>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.show.twitter" label="Show Twitter?"/>\n        </div>\n        <div class="columns large-25">\n            <input type="text" ng-model="model.twitter" ng-show="model.show.twitter" />\n        </div>\n    </div>\n    <div>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.show.linkedIn" label="Show LinkedIn?"/>\n        </div>\n        <div class="columns large-25">\n            <input type="text" ng-model="model.linkedIn" ng-show="model.show.linkedIn" />\n        </div>\n    </div>\n    <div class="columns large-25">\n        Icon size:\n        <select ng-model="model.iconSize" ng-options="obj.id as obj.text for obj in internalData.iconSizes"></select>\n    </div>\n</div>')}]),angular.module("socialAppHelp.html",[]).run(["$templateCache",function(a){a.put("socialAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("socialAppView.html",[]).run(["$templateCache",function(a){a.put("socialAppView.html",'<div>\n    <div class="item" ng-class="model.iconSize" ng-show="model.show.email">\n       <a ng-href="mailto:{{model.email}}" target="_blank"><img src="/client/images/email2.svg" title="e-mail" /></a>\n    </div>\n    <div class="item" ng-class="model.iconSize" ng-show="model.show.facebook">\n        <a ng-href="{{model.facebook}}" target="_blank"><img src="/client/images/facebook.svg" title="Facebook" /></a>\n    </div>\n    <div class="item" ng-class="model.iconSize" ng-show="model.show.twitter">\n        <a ng-href="{{model.twitter}}" target="_blank"><img src="/client/images/twitter.svg" title="Twitter" /></a>\n    </div>\n    <div class="item" ng-class="model.iconSize" ng-show="model.show.linkedIn">\n        <a ng-href="{{model.linkedIn}}" target="_blank"><img src="/client/images/linkedin.svg" title="LinkedIn" /></a>\n    </div>\n</div>')}]),angular.module("staticContentAppAdd.html",[]).run(["$templateCache",function(a){a.put("staticContentAppAdd.html",'<div>\n    <div create-content model="content"></div>\n    <input checkbox ng-model="internalData.displayAddedContent" label="Display added?" />\n</div>')}]),angular.module("staticContentAppEdit.html",[]).run(["$templateCache",function(a){a.put("staticContentAppEdit.html",'<div>\n    <div class="row">\n        <h5><label>General</label></h5>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.showTitles" label="Show titles"/>\n        </div>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.showComments" label="Show comments"/>\n        </div>\n    </div>\n    <div class="row">\n        <h5><label>Ratings</label></h5>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.showRatings" label="Show ratings"/>\n\n        </div>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.showCommentsRatings" label="Show comments ratings"/>\n        </div>\n    </div>\n</div>')}]),angular.module("staticContentAppHelp.html",[]).run(["$templateCache",function(a){a.put("staticContentAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("staticContentAppSelectContent.html",[]).run(["$templateCache",function(a){a.put("staticContentAppSelectContent.html",'<div>\n    <auto-complete ng-model="model.selectedContentId" ng-options="contentList" label-key="title"\n                   placeholder="Start typing to select content..."></auto-complete>\n</div>\n')}]),angular.module("staticContentAppView.html",[]).run(["$templateCache",function(a){a.put("staticContentAppView.html",'<div>\n    <div ng-show="!model.selectedContentId"><em>Please select a content from the edit panel</em></div>\n    <div ng-show="model.selectedContentId">\n        <div class="contentHeader cf">\n            <h3 ng-show="model.showTitles" class="title">\n                <a href="#">\n                    <div content-editable ng-model="internalData.title" type="type"\n                         on-blur="onContentUpdated()" class="noBorder" i18n-db-input></div>\n                </a>\n            </h3>\n            <div rating="internalData.avgRating" target-id="model.selectedContentId" target-collection="content"\n                 target-author-id="internalData.create.author._id" ux-show="model.showRatings"></div>\n        </div>\n        <div content-editable ng-model="internalData.summary" type="type"\n             on-blur="onContentUpdated()" class="noBorder" i18n-db-input></div>\n        <div content-editable ng-model="internalData.content" type="type"\n             on-blur="onContentUpdated()" class="noBorder" i18n-db-input></div>\n        <comments target-id="model.selectedContentId" placeholder="comments.addComment.placeholder"\n                  ux-show="model.showComments" allow-ratings="model.showCommentsRatings"></comments>\n    </div>\n</div>\n')}]),angular.module("userListAppAdd.html",[]).run(["$templateCache",function(a){a.put("userListAppAdd.html",'<div>\n    <div create-user model="user"></div>\n</div>')}]),angular.module("userListAppEdit.html",[]).run(["$templateCache",function(a){a.put("userListAppEdit.html","<div list-edit></div>")}]),angular.module("userListAppHelp.html",[]).run(["$templateCache",function(a){a.put("userListAppHelp.html","<b>This is</b>The HELP! page of USER LIST :)")}]),angular.module("userListAppView.html",[]).run(["$templateCache",function(a){a.put("userListAppView.html",'<div>\n    <user-list config="model"></user-list>\n</div>')}]),angular.module("videoAppEdit.html",[]).run(["$templateCache",function(a){a.put("videoAppEdit.html",'<div>\n    Video ID:\n    <input type="text" ng-model="model.videoId"></textarea>\n    Height:\n    <input type="text" ng-model="model.height"></textarea>\n</div>\n')}]),angular.module("videoAppHelp.html",[]).run(["$templateCache",function(a){a.put("videoAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("videoAppView.html",[]).run(["$templateCache",function(a){a.put("videoAppView.html",'<iframe width="100%" height="{{model.height}}" src="http://www.youtube.com/embed/{{model.videoId}}"\n        frameborder="0" allowfullscreen></iframe>')}]),angular.module("webGlAppEdit.html",[]).run(["$templateCache",function(a){a.put("webGlAppEdit.html","<div>3D Edit</div>")}]),angular.module("webGlAppHelp.html",[]).run(["$templateCache",function(a){a.put("webGlAppHelp.html","<b>This is</b>The HELP! page :)")}]),angular.module("webGlAppView.html",[]).run(["$templateCache",function(a){a.put("webGlAppView.html","<div></div>")}]),angular.module("addAppPanel.html",[]).run(["$templateCache",function(a){a.put("addAppPanel.html",'<div id="addAppPanel" class="addAppPanel" state="hidden">\n    <div class="collapsedView">\n        <file-uploader endpoint="rest/availableApps/deploy/" on-upload="onAvailableAppDeployed()"></file-uploader>\n        <div class="filterContainer"><input type="text" ng-model="filter"></div>\n        <ul class="apps">\n            <div ng-repeat="availableApp in availableApps.model | filter: filter" ng-class="getBlockStyleClass(availableApp.id)">\n                <div class="category" ng-show="availableApp.firstInCategory">{{availableApp.category}}</div>\n                <li sortable-add-app class="newItem" type="{{availableApp.id}}" ng-class="getAppClasses($index)">\n                    <div class="text">{{availableApp.title}}</div>\n                    <button class="infoIcon" ng-click="toggleExpandedView(availableApp)"></button>\n                </li>\n            </div>\n        </ul>\n    </div>\n    <div class="expandedView" ux-show="isExpandedViewVisible">\n        <div class="content">\n            <div class="header">\n                <div class="main">\n                    <h3 class="title">{{highlight.title}}</h3>\n                    <div rating="highlight.avgRating" target-id="highlight._id" target-collection="{{highlight.collection}}" height="32"></div>\n                    <div class="actions">\n                        <button class="addIcon">Add!</button>\n                        <button class="removeIcon" ng-click="undeploy()"><label i18n="app.remove"></label></button>\n                    </div>\n                </div>\n                <div class="metadata">\n                    <label class="key" i18n="addApp.version"></label>: <label class="value">{{highlight.version}}</label>\n                    <label class="key" i18n="addApp.category"></label>: <label class="value">{{highlight.category}}</label>\n                    <label class="key" i18n="addApp.creationDate"></label>: <label class="value">{{highlight.create.date}}</label>\n                    <label class="key" i18n="addApp.provider"></label>: <label class="value">{{highlight.provider}}</label>\n                </div>\n                <div class="description">{{highlight.desc}}</div>\n            </div>\n            <div class="preview" app-container>\n                <div app ng-class="highlight.id" model="highlight.model" type="highlight.id"></div>\n            </div>\n            <div class="details">\n                <line-chart data="highlight.stats"></line-chart>\n                <comments target-id="highlight._id" placeholder="addApp.addComment" on-add="onAddedComment"></comments>\n            </div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("adminPanel.html",[]).run(["$templateCache",function(a){a.put("adminPanel.html",'<div class="admin cf">\n    <add-app-panel></add-app-panel>\n    <edit ux-show="panels.length" edit="edit" panels="panels" on-cancel="onCancel()" on-save="onSave()"\n          active-tab="activeTab" limit-layer-height="false"></edit>\n</div>\n')}]),angular.module("createMedia.html",[]).run(["$templateCache",function(a){a.put("createMedia.html",'<div>\n    Name:\n    <div ng-show="multipleFilesUploaded">{{getMultipleFilesUploadedNames()}}</div>\n    <input type="text" ng-model="media[0].name" mandatory ng-show="!multipleFilesUploaded" />\n    content: <file-uploader on-upload="onUpload()"></file-uploader>\n    Tags:\n    <auto-complete ng-model="media.tags" ng-options="availableTags" label-key="text"\n                   placeholder="Start typing to retrieve tags" multiple="true"></auto-complete>\n</div>\n')}]),angular.module("edit.html",[]).run(["$templateCache",function(a){a.put("edit.html",'<div class="edit cf">\n    <div class="actions" ux-show="activeTab.current >= 0">\n        <button class="saveIcon" ng-click="save()"></button>\n        <button class="cancelIcon" ng-click="cancel()"></button>\n    </div>\n	<ul class="tabs level1" ng-show="showIfMultipleTabs()">\n		<li ng-repeat="panel in panels" style="height:{{tabHeight}}%" ng-style="panel.ngStyleFn()" ng-click="clickTab($index)"\n            class="tab tabButton" ng-class="getTabClasses(panel, $index)" title="{{panel.description}}" i18n-title>\n            <label i18n="{{panel.title}}"></label>\n            <label ux-show="isEditedMarkVisible($parent[panel.type])" ng-class="getEditedMarkColor($parent[panel.type])"\n                   class="jsitedMark">*</label>\n		</li>\n	</ul>\n	<div class="content level1" ng-show="activeTab.current >= 0" ng-style="setMaxHeightContent()">\n		<ul></ul>\n	</div>\n</div>\n')}]),angular.module("editAppGeneral.html",[]).run(["$templateCache",function(a){a.put("editAppGeneral.html",'<div class="cf">\n    <div class="row">\n        <h5><label i18n="editApp.general"></label></h5>\n        <div class="columns large-25">\n            <input checkbox ng-model="model.showTitle" label="editApp.showAppTitles"/>\n        </div>\n    </div>\n</div>\n')}]),angular.module("editAppStyles.html",[]).run(["$templateCache",function(a){a.put("editAppStyles.html",'<div>\n    <div styles="model.styles" target="app"></div>\n</div>\n')}]),angular.module("editBox.html",[]).run(["$templateCache",function(a){a.put("editBox.html",'<div id="{{target.id}}" class="editBox cf" arrowPos="{{arrowPos}}" ng-style="getStyles()" type="{{target.type}}"\n    ng-class="{multiLayer: panels.length > 1}">\n    <div class="content cf">\n        <edit panels="panels" active-tab="activeTab" on-save="save()" on-change="change()"\n              on-cancel="cancel()" limit-layer-height="true"></edit>\n    </div>\n    <div class="arrow"></div>\n</div>\n')}]),angular.module("editContent.html",[]).run(["$templateCache",function(a){a.put("editContent.html",'<div>\n    <label i18n="editContent.title"></label>: <input type="text" ng-model="content.title" i18n-db-input mandatory />\n    <label i18n="editContent.summary"></label>: <div content-editable ng-model="content.summary" type="type" i18n-db-input></div>\n    <label i18n="editContent.content"></label>: <div content-editable ng-model="content.content" type="type" i18n-db-input></div>\n    <label i18n="tags"></label>:\n    <auto-complete ng-model="content.tags" ng-options="availableTags" label-key="text"\n                   placeholder="Start typing to retrieve tags" multiple="true"></auto-complete>\n</div>')}]),angular.module("editContentList.html",[]).run(["$templateCache",function(a){a.put("editContentList.html",'<div>\n    <content-list config="config"></content-list>\n</div>')}]),angular.module("editCurrentUser.html",[]).run(["$templateCache",function(a){a.put("editCurrentUser.html",'<div>\n    <div class="actions">\n        <button ng-click="logout()">Logout</button>\n    </div>\n    <div edit-user model="userSession" on-layer="onLayer" class="clearBoth"></div>\n</div>')}]),angular.module("editGeneral.html",[]).run(["$templateCache",function(a){a.put("editGeneral.html",'<li class="hasSubmenu">\n    <ul vertical-tabs="level2Tabs"></ul>\n    <div class="content level2">\n        <ul>\n            <li class="layer">\n                <div class="columns large-25">\n                    <label i18n="editGeneral.general.portalTitle"></label>\n                    <div><input type="text" ng-model="model.title" mandatory /></div>\n                </div>\n                <div class="columns large-25">\n                    <label i18n="editGeneral.general.portalDescription"></label>\n                    <div><textarea content-editable ng-model="model.desc"></textarea></div>\n                </div>\n                <div class="columns large-25">\n                    <label i18n="editGeneral.general.favicon"></label>\n                    <file-uploader preview="true" ng-model="favicon" on-upload="updateFavicon($uploadedFile)"\n                                   default-media-url="defaultFaviconUrl"></file-uploader>\n                </div>\n                <div class="columns large-25">\n                    <h5><label i18n="editGeneral.general.fullscreenMode"></label></h5>\n                    <input radio ng-model="model.fullscreenMode" label="editGeneral.general.fullscreenMode.real"\n                    value="real" name="fullscreenMode" title="editGeneral.general.fullscreenMode.real.desc" i18n-title />\n                    <input radio ng-model="model.fullscreenMode" label="editGeneral.general.fullscreenMode.maximized"\n                    value="maximized" name="fullscreenMode" title="editGeneral.general.fullscreenMode.maximized.desc" i18n-title />\n                    <input radio ng-model="model.fullscreenMode" label="editGeneral.general.fullscreenMode.template"\n                    value="template" name="fullscreenMode" title="editGeneral.general.fullscreenMode.template.desc" i18n-title />\n                </div>\n            </li>\n            <li class="layer">\n                <div edit-app-general model="model.app"></div>\n            </li>\n            <li class="layer">\n                <languages-list config="config"></languages-list>\n            </li>\n            <li class="layer">\n                <input checkbox ng-model="model.comments.allowRatings" label="editGeneral.comments.allowRatings" />\n            </li>\n            <li class="layer">\n                <div class="columns large-8">\n                    <label i18n="editGeneral.email.sourceAddress"></label>\n                    <div><input type="text" ng-model="model.email.user" /></div>\n                </div>\n                <div class="columns large-8">\n                    <label i18n="editGeneral.email.sourcePassword"></label>\n                    <div><input type="password" ng-model="model.email.password" /></div>\n                </div>\n                <div class="columns large-7">\n                    <label i18n="editGeneral.email.host"></label>\n                    <div><input type="text" ng-model="model.email.host" /></div>\n                </div>\n                <div class="columns large-2">\n                    <label>SSL?:</label>\n                    <input checkbox ng-model="model.email.ssl" />\n                </div>\n            </li>\n            <li class="layer">\n                <div class="columns large-8 textAlignRight">\n                    <label i18n="editGeneral.statistics.trackingCode"></label>\n                </div>\n                <div class="columns large-16">\n                    <div><input type="text" ng-model="model.trackingCode" /></div>\n                </div>\n            </li>\n            <li class="layer">\n                <div class="columns large-13">\n                    <h5><label i18n="editGeneral.migration.export"></label></h5>\n                    <div>\n                        <label i18n="editGeneral.migration.export.desc"></label>\n                    </div>\n                    <div>\n                        <a href="rest/export" target="_blank" class="button upIcon">\n                            <label i18n="editGeneral.migration.export.action"></label>\n                        </a>\n                    </div>\n                </div>\n                <div class="columns large-12">\n                    <h5><label i18n="editGeneral.migration.import"></label></h5>\n                    <div>\n                        <label i18n="editGeneral.migration.import.desc"></label>\n                    </div>\n                    <div class="warning">\n                        <b><label i18n="editGeneral.migration.import.warning.title"></label></b><br/>\n                        <label i18n="editGeneral.migration.import.warning.desc"></label>\n                    </div>\n                    <div>\n                        <file-uploader endpoint="rest/import" on-upload="onImportedPortal()"></file-uploader>\n                    </div>\n                </div>\n            </li>\n        </ul>\n    </div>\n</li>\n\n')}]),angular.module("editLanguage.html",[]).run(["$templateCache",function(a){a.put("editLanguage.html",'<div>\n    <input checkbox ng-model="language.inactive" label="editGeneral.languages.inactive" />\n</div>')}]),angular.module("editMedia.html",[]).run(["$templateCache",function(a){a.put("editMedia.html",'<div>\n    <label i18n="editMedia.name"></label>: <input type="text" ng-model="media.name" mandatory ng-show="!multipleFilesUploaded" />\n    <label i18n="editMedia.content"></label>: <file-uploader on-upload="onUpload()" endpoint="media/upload/{{media._id}}"></file-uploader>\n    <label i18n="tags"></label>:\n    <auto-complete ng-model="media.tags" ng-options="availableTags" label-key="text"\n                   placeholder="tags.placeholder" multiple="true"></auto-complete>\n</div>\n')}]),angular.module("editMediaList.html",[]).run(["$templateCache",function(a){a.put("editMediaList.html",'<div>\n    <media-list config="config"></media-list>\n</div>')}]),angular.module("editNotifications.html",[]).run(["$templateCache",function(a){a.put("editNotifications.html",'<li class="hasSubmenu">\n    <ul vertical-tabs="level2Tabs"></ul>\n    <div class="content level2">\n        <ul>\n            <li class="layer">\n                <div class="block">\n                    <h4><label i18n="editNotifications.email.selectAddressees"></label></h4>\n                    <auto-complete ng-model="model.notifications.email.selectedUsers" ng-options="usersList" label-key="fullName" value-key="email"\n                                   placeholder="editNotifications.email.typeToGetUsers" multiple="true"></auto-complete>\n                </div>\n                <div class="block">\n                    <h4><label i18n="editNotifications.email.writeMessage"></label></h4>\n                    <h6><label i18n="editNotifications.title"></label></h6>\n                    <input type="text" ng-model="model.notifications.email.subject" />\n                    <h6><label i18n="editNotifications.content"></label></h6>\n                    <div content-editable ng-model="model.notifications.email.text" class="content"></div>\n                </div>\n            </li>\n            <li class="layer">\n                <h6><i><label i18n="editNotifications.liveMessage.sendMessage"></label></i></h6>\n                <div class="block">\n                    <h6><label i18n="editNotifications.title"></label></h6>\n                    <input type="text" ng-model="model.notifications.liveMessage.subject" />\n                    <h6><label i18n="editNotifications.content"></label></h6>\n                    <div content-editable ng-model="model.notifications.liveMessage.text" class="content"></div>\n                </div>\n            </li>\n        </ul>\n    </div>\n</li>')}]),angular.module("editPages.html",[]).run(["$templateCache",function(a){a.put("editPages.html",'<li class="hasSubmenu">\n	<div class="submenu">\n        <nested-pages-wrapper pages="pages" items="items" selected-item="selectedPage" on-add="onAddPage($page)"></nested-pages-wrapper>\n	</div>\n    <ul vertical-tabs="level2Tabs"></ul>\n	<div class="content level2">\n        <ul ng-form="editPages">\n            <li class="layer" id="currentLayout{{$id}}">\n                <div class="columns large-9 textAlignRight"><label i18n="editPages.id"></label></div>\n                <div class="columns large-16">\n                    /<label url-token input="selectedPage.text" output="selectedPage.url"></label>\n                </div>\n                <div class="columns large-9 textAlignRight"><label i18n="editPages.text"></label></div>\n                <div class="columns large-16">\n                    <input type="text" ng-model="selectedPage.text" i18n-db-input mandatory\n                           placeholder="editPages.text.placeholder" ux-change="registerSelectedPageChange()" />\n                </div>\n                <div class="columns large-9 textAlignRight"><label i18n="editPages.description"></label></div>\n                <div class="columns large-16">\n                    <textarea content-editable ng-model="selectedPage.description" i18n-db-input\n                              ux-change="registerSelectedPageChange()" placeholder="editPages.description.placeholder"></textarea>\n                </div>\n                <div class="columns large-9 textAlignRight"><label i18n="editPages.type"></label></div>\n                <div class="columns large-16">\n                    <select ng-model="selectedPage.type" ng-options="obj.id as obj.text for obj in pageTypes"\n                            ng-change="registerSelectedPageChange()"></select>\n                </div>\n                <div class="columns large-9 textAlignRight"><label i18n="editPages.invisible"></label></div>\n                <div class="columns large-16">\n                    <input type="checkbox" ng-model="selectedPage.invisible" ux-change="registerSelectedPageChange()" />\n                </div>\n                <div ux-show="selectedPage.type==\'externalLink\'">\n                    <div class="columns large-8 textAlignRight"><label i18n="editPages.url"></label></div>\n                    <div class="columns large-11">\n                        <input type="text" ng-model="selectedPage.externalLinkUrl" mandatory ng-change="registerSelectedPageChange()" />\n                    </div>\n                    <div class="columns large-2 textAlignRight"><label i18n="editPages.target"></label></div>\n                    <div class="columns large-4">\n                        <select ng-model="selectedPage.target" ng-options="obj.id as obj.text for obj in targets"\n                                ng-change="registerSelectedPageChange()"></select>\n                    </div>\n                </div>\n            </li>\n            <li class="layer" id="changeLayout{{$id}}">\n                <padding>\n                    34\n                </padding>\n            </li>\n            <li class="layer" id="section2c{{$id}}">\n                <padding>\n                    <h2>Section 6</h2>\n                    <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse et turpis sed metus fermentum pellentesque. Vestibulum auctor neque ac nunc elementum malesuada. Praesent non est sed libero vestibulum consectetuer. Sed vehicula. Vivamus quis tellus sit amet erat ultrices luctus. Fusce a ligula. Fusce viverra libero vitae velit. Aenean bibendum nibh non lorem. Suspendisse quis velit. Integer sit amet lacus. Curabitur tristique. Morbi eu lectus. Vestibulum tristique aliquam quam. Sed neque.</p>\n                    <p>Nulla facilisi. Quisque eleifend libero. Sed eros. Morbi vel leo. Morbi varius tincidunt sem. Nam sodales volutpat velit. Suspendisse potenti. Duis vehicula pede non nisi. Proin elit pede</p>\n                </padding>\n            </li>\n        </ul>\n	</div>\n</li>\n')
}]),angular.module("editStyles.html",[]).run(["$templateCache",function(a){a.put("editStyles.html",'<li class="hasSubmenu">\n    <ul vertical-tabs="level2Tabs"></ul>\n    <div class="content level2">\n        <ul>\n            <li class="layer">\n                <div styles="model.styles" target="portal"></div>\n            </li>\n            <li class="layer">\n                <div styles="model.app.styles" target="app"></div>\n            </li>\n        </ul>\n    </div>\n</li>\n')}]),angular.module("editTag.html",[]).run(["$templateCache",function(a){a.put("editTag.html",'<div>\n    <div class="columns large-8 textAlignRight"><label i18n="editTag.tagName"></label>:</div>\n    <div class="columns large-16"><input type="text" ng-model="tag.text" mandatory /></div>\n</div>')}]),angular.module("editTagList.html",[]).run(["$templateCache",function(a){a.put("editTagList.html",'<div>\n    <tag-list config="config"></tag-list>\n</div>')}]),angular.module("editUser.html",[]).run(["$templateCache",function(a){a.put("editUser.html",'<div>\n    <div class="columns large-8">\n        <media-picker preview="true" ng-model="user.media" default-media-url="defaultAvatarUrl"></media-picker>\n    </div>\n    <div class="columns large-16">\n        <div><label i18n="editUser.fullName"></label>: <input type="text" ng-model="user.fullName" mandatory /></div>\n        <div><label i18n="editUser.email"></label>: <input type="text" ng-model="user.email" email-mandatory mandatory /></div>\n        <div><label i18n="editUser.birthDate"></label>: <input date ng-model="user.birthDate" /></div>\n        <div>\n            <label i18n="editUser.password"></label>:\n            <input password ng-model="user.password" click-to-change="clickToChangePassword" />\n        </div>\n        <div>\n            <label i18n="editUser.role"></label>\n            <select ng-model="user.role" ng-options="obj.karma as obj.title for obj in roles"></select>\n        </div>\n        <div>\n            <label i18n="editUser.language"></label>\n            <select ng-model="user.language" ng-options="obj.code as obj.text for obj in languages"></select>\n        </div>\n        <div><label i18n="tags"></label>:\n            <auto-complete ng-model="user.tags" ng-options="availableTags" label-key="text"\n                           placeholder="Start typing to retrieve tags" multiple="true"></auto-complete>\n        </div>\n    </div>\n</div>')}]),angular.module("editUserList.html",[]).run(["$templateCache",function(a){a.put("editUserList.html",'<div>\n    <user-list config="config"></user-list>\n</div>')}]),angular.module("portalsAdminEditDb.html",[]).run(["$templateCache",function(a){a.put("portalsAdminEditDb.html",'<div>\n    <div class="cf">\n        <div class="columns large-10">Portal Url</div>\n        <div class="columns large-15">\n            <label url-token input="model.typedName" output="model.name"></label>\n        </div>\n    </div>\n    <div class="cf">\n        <div class="columns large-10">Database name:<br/>(Without spaces)</div>\n        <div class="columns large-15"><input type="text" ng-model="model.typedName" /></div>\n    </div>\n</div>')}]),angular.module("portalsAdminView.html",[]).run(["$templateCache",function(a){a.put("portalsAdminView.html",'<div>\n    <div list="databases" config="config" transcluded-data="transcludedData"\n         template="template" on-create-panels="onCreatePanels" on-edit-panels="onEditPanels"\n         on-create="onCreate($item)" on-edit="onEdit($item)" on-delete="onDelete($id)"></div>\n</div>')}]),angular.module("stats.html",[]).run(["$templateCache",function(a){a.put("stats.html",'<div>\n    <div class="columns large-12 chartBlock">\n        <h4 class="title"><label i18n="stats.createdNewsPerDay"></label></h4>\n        <line-chart data="newsPerDay"></line-chart>\n    </div>\n    <div class="columns large-12 chartBlock">\n        <h4 class="title"><label i18n="stats.createdUsersPerDay"></label></h4>\n        <line-chart data="usersPerDay"></line-chart>\n    </div>\n    <div class="columns large-8 chartBlock">\n        <h4 class="title"><label i18n="stats.createdContentPerUser"></label></h4>\n        <pie-chart data="contentPerUser"></pie-chart>\n    </div>\n    <div class="columns large-8 chartBlock">\n        <h4 class="title"><label i18n="stats.usersPerRole"></label></h4>\n        <pie-chart data="usersPerRole"></pie-chart>\n    </div>\n    <div class="columns large-8 chartBlock">\n        <h4 class="title"><label i18n="stats.commentsPerUser"></label></h4>\n        <pie-chart data="commentsPerUser"></pie-chart>\n    </div>\n</div>')}]),angular.module("styles.html",[]).run(["$templateCache",function(a){a.put("styles.html",'<div>\n    <div class="cf" ng-show="isPortalTarget()">\n        <div class="columns large-13">\n            <label i18n="editStyles.fontColor"></label>\n            <div>\n                <input color-picker placeholder="Specify the color" ng-model="model.cssVars.fontColor" />\n            </div>\n        </div>\n        <div class="columns large-12">\n            <label i18n="editStyles.highlightColor"></label>\n            <div>\n                <input color-picker placeholder="Specify the color" ng-model="model.cssVars.high" />\n            </div>\n        </div>\n    </div>\n    <div class="cf columns large-13">\n        <label i18n="editStyles.padding"></label>\n        <div><input type="number" ng-model="model.padding"/></div>\n    </div>\n    <div class="cf columns large-12" ng-show="isAppTarget()">\n        <label i18n="editStyles.margin"></label>\n        <div><input type="number" ng-model="model.margin"/></div>\n    </div>\n    <div class="cf columns large-25">\n        <label i18n="editStyles.fontSize"></label>\n        <div><input type="text" ng-model="model.fontSize"/></div>\n    </div>\n    <div class="cf columns large-9" ng-show="isAppTarget()">\n        <label i18n="editStyles.height"></label>\n        <div><input type="number" ng-model="model.height"/></div>\n    </div>\n    <div class="cf columns large-8" ng-show="isAppTarget()">\n        <label i18n="editStyles.align.horizontal"></label>\n        <select ng-model="model.align.horizontal" ng-options="obj.id as obj.text for obj in aligns.horizontal"\n                ng-init="model.align.horizontal=model.align.horizontal||aligns.horizontal[0].id"></select>\n    </div>\n    <div class="cf columns large-8" ng-show="model.height && isAppTarget()">\n        <label i18n="editStyles.align.vertical"></label>\n        <select ng-model="model.align.vertical" ng-options="obj.id as obj.text for obj in aligns.vertical"\n                ng-init="model.align.vertical=model.align.vertical||aligns.vertical[0].id"></select>\n    </div>\n    <div class="cf columns large-12" ng-show="isPortalTarget()">\n        <h5><label i18n="editStyles.logo"></label></h5>\n        <media-picker ng-model="logo" multiple="false" preview="true" on-change="changeLogoId($media)"></media-picker>\n    </div>\n    <div class="cf">\n        <h5><label i18n="editStyles.background"></label></h5>\n        <background ng-model="model.background"></background>\n    </div>\n    <div class="cf">\n        <h5><label i18n="editStyles.borders"></label></h5>\n        <borders ng-model="model.borders"></borders>\n    </div>\n</div>')}]),angular.module("app.html",[]).run(["$templateCache",function(a){a.put("app.html",'<div ng-class="getAppStyleClasses()" class="app cf" ng-style="getAppStyles()">\n    <div app-header class="cf"></div>\n	<div class="content cf">\n        <div class="title" ng-show="isTitleVisible()"><h5>{{model.title || appInfo.title}}</h5></div>\n        <div class="alignment" ng-class="getAppAlignment()">\n            <div app-bridge bindings="bindings" src="{{type}}" view="{{view}}" on-event="onEvent"></div>\n        </div>\n	</div>\n</div>\n')}]),angular.module("appHeader.html",[]).run(["$templateCache",function(a){a.put("appHeader.html",'<div>\n    <div class="headerToggle" ng-click="toggleHeader()" ng-show="showAdminActions()"></div>\n    <div class="header cf" ng-show="showHeader()" title="{{getAppHelpText()}}">\n        <div class="title">\n            <h5>{{model.title || appInfo.title}}</h5>\n        </div>\n        <div class="actions">\n            <button class="editIcon" ng-click="showEditTemplate()" ng-show="showEditActions()" title="app.edit" i18n-title></button>\n            <button class="fullscreenIcon" ng-click="toggleFullscreen()" ng-show="showAdminActions()" title="app.fullscreen"\n                    ng-disabled="templateApp==\'true\' && isTemplateFullscreen" i18n-title></button>\n            <button class="removeIcon" ng-click="removeApp()" ng-show="showAdminActions()" title="app.remove" i18n-title></button>\n        </div>\n    </div>\n</div>')}]),angular.module("bannerCanvas.html",[]).run(["$templateCache",function(a){a.put("bannerCanvas.html",'<div class="bannerCanvas" ng-class="{readOnly: isReadOnly()}">\n    <div class="addArea" ux-show="!isReadOnly()">\n        <button class="addImage addIcon" ng-click="addItem(\'image\')">Add image</button>\n        <button class="addText addIcon" ng-click="addItem(\'text\')">Add text</button>\n    </div>\n    <div class="grid" ng-class="{overflowVisible: overflow.visible}" ng-style="getCanvasHeight()">\n        <div banner-item ng-repeat="item in items.data" data="item" on-change="onItemChange()"\n             overflow="overflow" read-only="isReadOnly()" grid-size="gridSize"></div>\n    </div>\n</div>')}]),angular.module("bannerItem.html",[]).run(["$templateCache",function(a){a.put("bannerItem.html",'<div id="{{item.id}}" class="bannerItem" ng-class="{readOnly: readOnly, invisible: invisible}">\n    <div class="border">\n        <button class="edit editIcon" ng-click="editItem()"></button>\n        <div ux-transclude="template"></div>\n        <input type="text" class="selectHandler mousetrap" />\n    </div>\n</div>')}]),angular.module("bannerTextEditText.html",[]).run(["$templateCache",function(a){a.put("bannerTextEditText.html",'<div>\n    <div content-editable ng-model="item.value" i18n-db-input ux-change="contentChanged()"></div>\n</div>')}]),angular.module("comment.html",[]).run(["$templateCache",function(a){a.put("comment.html",'<li class="comment cf" ng-hide="comment.deleted">\n    <img class="avatar" ng-src="{{getDownloadUrl(comment.create.author.media)}}" />\n    <div class="metaData avatarSibling">\n        <div class="header">\n            <div class="floatLeft">\n                <div class="author"><a href="#">{{comment.create.author.fullName}}</a></div>\n            </div>\n            <div class="floatRight">\n                <div class="date">{{getFormattedDate()}}</div>\n                <div rating="comment.avgRating" target-id="comment._id" target-author-id="comment.create.author._id"\n                     target-collection="comments" height="16" ux-show="showRatings()"></div>\n                <button class="toggleReply replyIcon small" ng-click="toggleReply()" i18n-title title="comments.addReply"\n                        ng-show="isLoggedUser"></button>\n                <button class="toggleEdit editIcon small" ng-click="toggleEdit()" i18n-title title="comments.edit"\n                        ng-show="isSelfActionAllowed"></button>\n                <button class="deleteComment removeIcon small" i18n-title title="comments.deleteComment"\n                        confirm-action="deleteComment()" ng-show="isSelfActionAllowed"></button>\n            </div>\n        </div>\n        <div content-editable="comment.isEditable" ng-model="comment.text" type="type"\n             on-blur="updateComment()" class="message"></div>\n        <div class="repliesWrapper"></div>\n    </div>\n</li>')}]),angular.module("comments.html",[]).run(["$templateCache",function(a){a.put("comments.html",'<div class="comments">\n    <h5 class="title" ng-hide="parentComment"><label i18n="comments"></label></h5>\n    <div ng-show="comments.length == 0 && !parentComment" class="noComments">\n        <label i18n="comments.noItems"></label>\n    </div>\n    <ul ng-show="comments.length > 0">\n        <li ng-repeat="comment in comments" comment="comment"></li>\n    </ul>\n    <div class="cf" ng-hide="hideAdd || !loggedUser">\n        <img class="avatar" ng-src="{{getUserAvatarUrl()}}" />\n        <textarea content-editable ng-model="newCommentText" class="newCommentInput avatarSibling" placeholder="{{placeholder}}"></textarea>\n        <button class="addIcon createComment floatRight" ng-click="createComment()">\n            <label i18n="{{placeholder}}"></label>\n        </button>\n    </div>\n</div>\n')}]),angular.module("contentEditable.html",[]).run(["$templateCache",function(a){a.put("contentEditable.html",'<div>\n    <div class="actionsArea" ng-show="isEditable() && showActions" >\n        <media-picker ng-model="newMedia" multiple="false" on-close="onClose()"></media-picker>\n    </div>\n    <div class="editableArea">\n        <div ux-keyup="onKeyup()" ng-mouseup="showEditBox()" contenteditable="{{isEditable()}}"></div>\n        <div class="placeholder" ng-show="placeholder && showPlaceholder">\n            <label i18n="{{placeholder}}"></label>\n        </div>\n        <div class="background"></div>\n    </div>\n</div>')}]),angular.module("richContent.html",[]).run(["$templateCache",function(a){a.put("richContent.html",'<div>\n    <div class="columns large-9 textAlignRight"><label i18n="richContent.color"></label></div>\n    <div class="columns large-16">\n        <input color-picker placeholder="richContent.color.placeholder" ng-model="style.color" on-change="propagateChanges()" />\n    </div>\n    <div class="columns large-9 textAlignRight"><label i18n="richContent.style"></label></div>\n    <div class="columns large-16">\n        <button toggle-style ng-model="style.fontWeight" active-when="bold" inactive-when="normal" class="boldIcon"></button>\n        <button toggle-style ng-model="style.fontStyle" active-when="italic" inactive-when="normal" class="italicIcon"></button>\n        <button toggle-style ng-model="style.textDecoration" active-when="underline" inactive-when="none" class="underlineIcon"></button>\n    </div>\n    <div class="columns large-9 textAlignRight"><label i18n="richContent.size"></label></div>\n    <div class="columns large-16">\n        <select ng-model="heading" ng-init="heading=heading||\'normal\'"\n                ng-options="obj.value as obj.text for obj in headingOptions" ng-change="setHeading()"></select>\n    </div>\n    <div class="columns large-9 textAlignRight"><label i18n="richContent.link"></label></div>\n    <div class="columns large-6">\n        <select ng-model="linkType" ng-init="linkType=linkType||\'internal\'" ng-options="obj.id as obj.text for obj in linkTypes"></select>\n    </div>\n    <div class="columns large-10">\n        <div ng-show="linkType==\'internal\'" >\n            <auto-complete ng-model="internalLink" ng-options="pagesList" label-key="text" value-key="url"\n                           ux-change="setInternalLink()" placeholder="richContent.link.placeholder"></auto-complete>\n        </div>\n        <input type="text" ng-model="externalLink" ux-blur="setExternalLink()" ng-show="linkType==\'external\'" />\n    </div>\n</div>\n')}]),angular.module("selectMedia.html",[]).run(["$templateCache",function(a){a.put("selectMedia.html",'<div>\n    <div>\n        <div class="columns large-10 textAlignRight">\n            <label i18n="selectMedia.source"></label>\n        </div>\n        <div class="columns large-15">\n            <media-picker ng-model="internalData.updatedMedia" multiple="false" on-change="onMediaChange($media)"></media-picker>\n        </div>\n    </div>\n    <div ng-hide="config.editSize==false">\n        <div class="columns large-10 textAlignRight">\n            <label i18n="selectMedia.size"></label>\n        </div>\n        <div class="columns large-15">\n            <select ng-model="mediaSize" ng-init="mediaSize=mediaSize||\'original\'"\n                    ng-options="obj.id as obj.text for obj in mediaSizes" ng-change="propagateChanges()"></select>\n        </div>\n    </div>\n</div>')}]),angular.module("background.html",[]).run(["$templateCache",function(a){a.put("background.html",'<div>\n    <div class="columns large-8">\n        <div><label i18n="editStyles.background.color"></label></div>\n        <input color-picker placeholder="Specify the color" ng-model="background.color" />\n    </div>\n    <div class="columns large-5">\n        <div><label i18n="editStyles.background.src"></label></div>\n        <media-picker ng-model="backgroundSrc" multiple="false" preview="true" on-change="changeMediaId($media)"></media-picker>\n    </div>\n    <div class="columns large-4" ng-show="existsSrc()">\n        <div><label i18n="editStyles.background.repeat"></label></div>\n        <div><input type="checkbox" ng-model="background.mosaic"/></div>\n    </div>\n    <div class="columns large-4" ng-show="existsSrc() && !background.mosaic">\n        <div><label i18n="editStyles.background.position.top"></label></div>\n        <select ng-model="background.position.top" ng-options="obj.id as obj.text for obj in positions.top"></select>\n    </div>\n    <div class="columns large-4" ng-show="existsSrc() && !background.mosaic">\n        <div><label i18n="editStyles.background.position.left"></label></div>\n        <select ng-model="background.position.left" ng-options="obj.id as obj.text for obj in positions.left"></select>\n    </div>\n</div>')}]),angular.module("borders.html",[]).run(["$templateCache",function(a){a.put("borders.html",'<div>\n    <div class="columns large-9">\n        <div><label i18n="editStyles.borders.color"></label></div>\n        <input color-picker ng-model="borders.color" />\n    </div>\n    <div class="columns large-8">\n        <div><label i18n="editStyles.borders.width"></label></div>\n        <input type="number" ng-model="borders.width" ng-change="onWidthChange()" />\n    </div>\n    <div class="columns large-8">\n        <div><label i18n="editStyles.borders.style"></label></div>\n        <select ng-model="borders.style" ng-options="obj.id as obj.text for obj in styles"\n                ng-init="borders.style=borders.style||styles[0].id"></select>\n    </div>\n</div>')}]),angular.module("fileUploader.html",[]).run(["$templateCache",function(a){a.put("fileUploader.html",'<form enctype="multipart/form-data" action="{{endpoint||\'media/upload/\'}}" method="post" class="fileUploader">\n    <input type="file" ng-model="files" ux-change="submit()" name="upload" multiple-files="{{multiple}}" />\n</form>')}]),angular.module("password.html",[]).run(["$templateCache",function(a){a.put("password.html",'<div>\n    <a href="#" ng-click="togglePassword()" ng-show="clickToChange">\n        <label class="change" ng-show="!changePasswordActive"><label i18n="password.change"></label></label>\n        <label class="cancelChanges" ng-show="changePasswordActive"><label i18n="password.cancelChanges"></label></label>\n    </a>\n    <input ng-show="changePasswordActive  || !clickToChange" type="password" ng-model="model" password-mandatory />\n</div>')}]),angular.module("rating.html",[]).run(["$templateCache",function(a){a.put("rating.html",'<ul class="rating">\n    <li ng-repeat="rating in normalizedRating" ng-click="rate($index+1)" ng-class="getStarStyleClass($index+1, rating)"\n        ng-mouseenter="hoverRate($index+1)" ng-mouseleave="clearHoverRate()">\n            <div class="star" ng-style="getStarSize()"></div>\n    </li>\n</ul>\n')}]),angular.module("contentList.html",[]).run(["$templateCache",function(a){a.put("contentList.html",'<div>\n    <div list-db="items" id="_id" collection="collection" config="config" template="template"\n         on-edit-panels="onEditPanels" search-targets="searchTargets" config="config"></div>\n</div>')}]),angular.module("languagesList.html",[]).run(["$templateCache",function(a){a.put("languagesList.html",'<div class="languagesList">\n    <div list="languagesList" collection="collection" config="config" template="template" on-edit-panels="onEditPanels"></div>\n</div>')}]),angular.module("list.html",[]).run(["$templateCache",function(a){a.put("list.html",'<div ng-class="getWrapperClass()">\n    <div class="searchArea" ng-show="isSearchable() && !detailId">\n        <label i18n="list.search"></label>\n        <input type="text" ng-model="searchText" ux-keyup="executeSearch()"/>\n    </div>\n    <div ng-show="isPageActionsTop()" list-actions class="top" collection="collection"></div>\n    <div class="noItems" ng-show="items.length == 0"><i><label i18n="list.noItems"></label></i></div>\n    <div ng-show="items.length > 0" ng-hide="detailId && detailId!=item._id" id="{{item._id}}"\n         ng-repeat="item in items | filter: getFilter()" class="item columns"\n         ng-class="getItemStyleClasses(item)" ng-style="setItemHeight()">\n        <div class="selectFromCheckbox" ng-show="isMultiSelectable()" edit-target>\n            <input checkbox class="white" ng-model="item.isSelected" ng-click="clickOnItem(item, $index, $event, false)"\n                   block-update-model="true" />\n        </div>\n        <div class="text" ng-click="clickOnItem(item, $index, $event, true)">\n             <div ux-transclude="template"></div>\n         </div>\n        <button class="remove removeIcon" ng-click="clickOnItem(item, $index, $event, false)" ng-show="isDeletable()"\n                title confirm-action="deleteItem(item._id)">\n            <label i18n="list.deleteItem"></label>\n        </button>\n    </div>\n    <a href="#" class="detailArea floatRight" ng-show="detailId" ng-click="deleteDetailId()">\n        &lt;&lt; <label i18n="list.goBack"></label>\n    </a>\n    <div ng-show="isPageActionsBottom()" list-actions class="bottom" collection="collection"></div>\n</div>\n')}]),angular.module("listDb.html",[]).run(["$templateCache",function(a){a.put("listDb.html",'<div>\n    <div list="items" collection="collection" id="_id" config="config" projection="projection"\n         transcluded-data="transcludedData" on-search="onSearch($text)" on-select="selectItem($item)"\n         on-create="createItem($item)" on-delete="deleteItem($id)" current-page="currentPage"\n         db-source="true" template="template" on-create-panels="onCreatePanels" on-edit-panels="onEditPanels"></div>\n</div>')}]),angular.module("mediaList.html",[]).run(["$templateCache",function(a){a.put("mediaList.html",'<div>\n    <file-uploader ux-show="config.uploadable" on-upload="onUpload()" multiple="true"></file-uploader>\n    <div list-db="items" collection="collection" config="config" projection="projection"\n         template="template" on-edit-panels="onEditPanels" search-targets="searchTargets"\n         transcluded-data="transcludedData" on-select="selectItem($item)">\n    </div>\n</div>')}]),angular.module("tagList.html",[]).run(["$templateCache",function(a){a.put("tagList.html",'<div>\n    <div list-db="items" collection="collection" config="config" on-edit-panels="onEditPanels"\n         search-targets="searchTargets">\n        <h3><a href="#">{{item.text}}</a></h3>\n    </div>\n</div>')}]),angular.module("userList.html",[]).run(["$templateCache",function(a){a.put("userList.html",'<div class="userList">\n    <div list="userList" collection="collection" config="config" transcluded-data="transcludedData"\n         template="template" on-create-panels="onCreatePanels" on-edit-panels="onEditPanels"\n         on-create="onCreate($item)" on-delete="onDelete($id)"></div>\n</div>')}]),angular.module("login.html",[]).run(["$templateCache",function(a){a.put("login.html",'<div>\n    <div ng-show="userSession">\n        Hello, {{userSession.fullName}}. [<a href="#" ng-click="logout()">Logout</a>]\n    </div>\n    <form class="login cf" action="rest/login" method="POST" ng-show="!userSession">\n        <div class="user columns large-12">\n            <div class="label columns large-8 textAlignRight">E-mail:</div><div class="field columns large-16">\n            <input type="text" name="email" ng-model="email" />\n        </div>\n        </div>\n        <div class="password columns large-11">\n            <div class="label columns large-8 textAlignRight">Password:</div><div class="field columns large-16">\n            <input type="password" name="password" ng-model="password" />\n        </div>\n        </div>\n        <!--<div class="remember rows">\n            <input checkbox ng-model="remember" label="Remember" />\n        </div>-->\n        <div class="submit columns large-2">\n            <button type="submit" class="okIcon floatRight"></button>\n        </div>\n    </form>\n</div>')}]),angular.module("mediaPicker.html",[]).run(["$templateCache",function(a){a.put("mediaPicker.html",'<div class="mediaPicker">\n    <button class="mediaIcon" ng-click="selectFromMediaList()">\n        <label i18n="fileUploader.selectFromMediaList"></label>\n    </button>\n    <img class="current" ng-src="{{getDownloadUrl(model)}}" ng-show="model && preview==\'true\'" title="{{getFileTitle(model)}}" />\n    <button class="removeIcon small" ng-click="deleteSelection()" ng-show="model._id">\n        <label i18n="fileUploader.deleteSelection"></label>\n    </button>\n</div>')}]),angular.module("pages.html",[]).run(["$templateCache",function(a){a.put("pages.html",'<div class="portal" ng-class="getCurrentUserAdminAccessStyleClass()">\n    <ul class="pages" ng-style="setPagesStyles()">\n        <li ng-repeat="row in portal.template.rows" class="rows">\n            <ul>\n                <li ng-repeat="column in row.columns" resizable-app="{{isAppResizeAllowed()}}" class="columns"\n                    ng-class="getColStyleClass(column, $index, true)">\n                    <ul ux-show="column.apps" sortable-app="{{isAppSortAllowed()}}" ui-sortable="sortableOptions"\n                        ng-model="column.apps" class="appContainer">\n                        <li app="app.id" ng-repeat="app in column.apps" model="app.model" type="app.type" template-app="true" width="column.size"></li>\n                    </ul>\n                    <ul ux-show="column.rows">\n                        <li ng-repeat="row in column.rows" class="rows">\n                            <ul>\n                                <li ng-repeat="column in row.columns" resizable-app="{{isAppResizeAllowed()}}"\n                                    ng-class="getColStyleClass(column, $index, false)" class="columns page">\n                                    <ul sortable-app="{{isAppSortAllowed()}}" ui-sortable="sortableOptions" ng-model="column.apps" class="appContainer">\n                                        <li app="app.id" ng-repeat="app in column.apps" model="app.model" type="app.type" template-app="false" width="column.size"></li>\n                                    </ul>\n                                </li>\n                            </ul>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n        </li>\n    </ul>\n</div>')}]),angular.module("errorPage.html",[]).run(["$templateCache",function(a){a.put("errorPage.html",'<div class="errorPage">\n    <div class="container">\n        <div class="inner">\n            <div class="cf">\n                <img class="columns large-8" src="/client/images/error.png"/>\n                <div class="text columns large-17">\n                    <h2 class="title" ng-bind="errorTitle"></h2>\n                    <button class="addIcon" ng-click="goToPortalHome()" ng-show="showPortalHomeButton">\n                        <label i18n="errorPage.goToPortalHome"></label>\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("loginPage.html",[]).run(["$templateCache",function(a){a.put("loginPage.html",'<div global-msg></div>\n<div class="loginPage">\n    <div class="logo"></div>\n    <login></login>\n</div>\n\n')}]),angular.module("portalPage.html",[]).run(["$templateCache",function(a){a.put("portalPage.html",'<div global-msg></div>\n<admin-panel ux-show="isAdmin()"></admin-panel>\n<pages></pages>')}]),angular.module("listActions.html",[]).run(["$templateCache",function(a){a.put("listActions.html",'<div class="cf">\n    <div class="leftActions floatLeft onSelectActions" ng-show="isMultiSelectable() && items.length">\n        <button class="okIcon" ng-click="toggleSelectAll()">\n            <label i18n="list.selectItems"></label>\n        </button>\n        <button class="removeIcon" ng-click="deleteSelected()" ng-show="selectedIds.length && isDeletable()">\n            <label i18n="list.deleteSelected"></label>\n        </button>\n    </div>\n    <div class="leftActions floatLeft createActions" ng-show="isCreatable()">\n        <button create-item-button class="addIcon" ng-click="createItem()" collection="collection"\n                on-create="createItem($item)" on-create-panels="onCreatePanels">\n            <label i18n="list.createItem"></label>\n        </button>\n    </div>\n    <div class="rightActions floatRight getPageActions" ng-show="showPrevPageLink()||showNextPageLink()">\n        <button class="getPrevPage" ng-click="getPrevPage()" ng-show="showPrevPageLink()">&lt;</button>\n        <button class="getNextPage" ng-click="getNextPage()" ng-show="showNextPageLink()">&gt;</button>\n    </div>\n    <div class="selectedItems">\n        <label ng-class="{show: selectedIds.length}">{{selectedIds.length}} <label i18n="list.selectedItems"></label></label>\n    </div>\n</div>')}]),angular.module("listEdit.html",[]).run(["$templateCache",function(a){a.put("listEdit.html",'<div>\n\n    <div class="columns large-12">\n        <div class="columns large-25"><input checkbox ng-model="model.searchable" label="Enable search"/></div>\n    </div>\n\n    <div class="columns large-12">\n        <div class="columns large-13 textAlignRight">Page size:</div>\n        <div class="columns large-12"><input type="text" ng-model="model.pageSize" /></div>\n    </div>\n\n    <div class="columns large-12">\n        <div class="columns large-13 textAlignRight">Skip:</div>\n        <div class="columns large-12"><input type="text" ng-model="model.skip" /></div>\n    </div>\n\n    <div class="columns large-12">\n        <div class="columns large-13 textAlignRight">Sort field:</div>\n        <div class="columns large-12">\n            <select ng-model="model.sort.field" ng-options="obj.id as obj.text for obj in sortTypes.field"></select>\n        </div>\n    </div>\n\n    <div class="columns large-12">\n        <div class="columns large-13 textAlignRight">Sort order:</div>\n        <div class="columns large-12">\n            <select ng-model="model.sort.order" ng-options="obj.id as obj.text for obj in sortTypes.order"></select>\n        </div>\n    </div>\n\n    <label>\n        Pagination position:\n        <select ng-model="model.pageActionPos" >\n            <option value="0">Top</option>\n            <option value="1">bottom</option>\n            <option value="2">topAndBottom</option>\n        </select>\n    </label>\n\n    Filter:\n    <auto-complete ng-model="model.tags" ng-options="availableTags" label-key="text"\n                   placeholder="Select tags to filter" multiple="true"></auto-complete>\n\n    <div class="columns large-12">\n        <div class="columns large-13 textAlignRight">Columns:</div>\n        <div class="columns large-12">\n            <select ng-model="model.columns" ng-options="obj.value as obj.text for obj in columnOptions"></select>\n        </div>\n    </div>\n</div>')}]);